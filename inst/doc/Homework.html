<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="SA24204158" />

<meta name="date" content="2024-11-29" />

<title>Homework Organization</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework Organization</h1>
<h4 class="author">SA24204158</h4>
<h4 class="date">2024-11-29</h4>



<div id="文档简介" class="section level2">
<h2>文档简介</h2>
<p>这个文档是2024秋季USTC统计算法课程作业的整理，包含<strong>Homework1-Homework9</strong>。</p>
<div id="homework-1" class="section level3">
<h3>Homework-1</h3>
<div id="任务说明" class="section level4">
<h4>任务说明</h4>
<p>本次作业让我们用R markdown文件展示三个图文(图表)结合的例子</p>
<div id="例一" class="section level5">
<h5>例一</h5>
<p>例一我们以R语言自带的数据集”mtcars”为例，生成了一副<strong>箱线图</strong>（boxplot），展示了不同气缸数量（<code>cyl</code>）对应的每加仑行驶英里数（<code>mpg</code>）的分布情况。</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.3.3</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="do">### 数据集预览</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>mtcars</span></code></pre></div>
<pre><code>##                      mpg cyl  disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
## Valiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
## Duster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
## Merc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
## Merc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
## Merc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
## Merc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
## Merc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
## Merc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
## Merc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
## Cadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
## Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
## Chrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
## Fiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
## Honda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
## Toyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
## Toyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
## Dodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
## AMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
## Camaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
## Pontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
## Fiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
## Porsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
## Lotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
## Ford Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
## Ferrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
## Maserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8
## Volvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">summary</span>(mtcars)</span></code></pre></div>
<pre><code>##       mpg             cyl             disp             hp       
##  Min.   :10.40   Min.   :4.000   Min.   : 71.1   Min.   : 52.0  
##  1st Qu.:15.43   1st Qu.:4.000   1st Qu.:120.8   1st Qu.: 96.5  
##  Median :19.20   Median :6.000   Median :196.3   Median :123.0  
##  Mean   :20.09   Mean   :6.188   Mean   :230.7   Mean   :146.7  
##  3rd Qu.:22.80   3rd Qu.:8.000   3rd Qu.:326.0   3rd Qu.:180.0  
##  Max.   :33.90   Max.   :8.000   Max.   :472.0   Max.   :335.0  
##       drat             wt             qsec             vs        
##  Min.   :2.760   Min.   :1.513   Min.   :14.50   Min.   :0.0000  
##  1st Qu.:3.080   1st Qu.:2.581   1st Qu.:16.89   1st Qu.:0.0000  
##  Median :3.695   Median :3.325   Median :17.71   Median :0.0000  
##  Mean   :3.597   Mean   :3.217   Mean   :17.85   Mean   :0.4375  
##  3rd Qu.:3.920   3rd Qu.:3.610   3rd Qu.:18.90   3rd Qu.:1.0000  
##  Max.   :4.930   Max.   :5.424   Max.   :22.90   Max.   :1.0000  
##        am              gear            carb      
##  Min.   :0.0000   Min.   :3.000   Min.   :1.000  
##  1st Qu.:0.0000   1st Qu.:3.000   1st Qu.:2.000  
##  Median :0.0000   Median :4.000   Median :2.000  
##  Mean   :0.4062   Mean   :3.688   Mean   :2.812  
##  3rd Qu.:1.0000   3rd Qu.:4.000   3rd Qu.:4.000  
##  Max.   :1.0000   Max.   :5.000   Max.   :8.000</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="do">### 生成箱线图</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cyl), <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Miles per Gallon by Number of Cylinders&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>从上述箱线图可以看出，气缸数量（<code>cyl</code>）越高的车，每加仑油行驶英里数（<code>mpg</code>）更少，即每公里耗油量更大。</p>
</div>
<div id="例二" class="section level5">
<h5>例二</h5>
<p>R markdown支持展示latex表格和公式，使用起来十分方便。</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>xtable<span class="sc">::</span><span class="fu">xtable</span>(<span class="fu">head</span>(iris))</span></code></pre></div>
<pre><code>## % latex table generated in R 4.3.1 by xtable 1.8-4 package
## % Sun Dec  8 10:34:09 2024
## \begin{table}[ht]
## \centering
## \begin{tabular}{rrrrrl}
##   \hline
##  &amp; Sepal.Length &amp; Sepal.Width &amp; Petal.Length &amp; Petal.Width &amp; Species \\ 
##   \hline
## 1 &amp; 5.10 &amp; 3.50 &amp; 1.40 &amp; 0.20 &amp; setosa \\ 
##   2 &amp; 4.90 &amp; 3.00 &amp; 1.40 &amp; 0.20 &amp; setosa \\ 
##   3 &amp; 4.70 &amp; 3.20 &amp; 1.30 &amp; 0.20 &amp; setosa \\ 
##   4 &amp; 4.60 &amp; 3.10 &amp; 1.50 &amp; 0.20 &amp; setosa \\ 
##   5 &amp; 5.00 &amp; 3.60 &amp; 1.40 &amp; 0.20 &amp; setosa \\ 
##   6 &amp; 5.40 &amp; 3.90 &amp; 1.70 &amp; 0.40 &amp; setosa \\ 
##    \hline
## \end{tabular}
## \end{table}</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># 加载knitr包</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  <span class="at">Sepal.Length =</span> <span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">4.9</span>, <span class="fl">4.7</span>, <span class="fl">4.6</span>, <span class="fl">5.0</span>, <span class="fl">5.4</span>),</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  <span class="at">Sepal.Width =</span> <span class="fu">c</span>(<span class="fl">3.5</span>, <span class="fl">3.0</span>, <span class="fl">3.2</span>, <span class="fl">3.1</span>, <span class="fl">3.6</span>, <span class="fl">3.9</span>),</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>  <span class="at">Petal.Length =</span> <span class="fu">c</span>(<span class="fl">1.4</span>, <span class="fl">1.4</span>, <span class="fl">1.3</span>, <span class="fl">1.5</span>, <span class="fl">1.4</span>, <span class="fl">1.7</span>),</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>  <span class="at">Petal.Width =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>),</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>  <span class="at">Species =</span> <span class="fu">c</span>(<span class="st">&quot;setosa&quot;</span>, <span class="st">&quot;setosa&quot;</span>, <span class="st">&quot;setosa&quot;</span>, <span class="st">&quot;setosa&quot;</span>, <span class="st">&quot;setosa&quot;</span>, <span class="st">&quot;setosa&quot;</span>)</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>)</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co"># 使用kable生成表格</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;Iris数据集的部分内容&quot;</span>)</span></code></pre></div>
<table>
<caption>Iris数据集的部分内容</caption>
<thead>
<tr class="header">
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.7</td>
<td align="right">3.2</td>
<td align="right">1.3</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.6</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.0</td>
<td align="right">3.6</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.4</td>
<td align="right">3.9</td>
<td align="right">1.7</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
</tbody>
</table>
<p>下面展示一些统计中常见的公式，包括均值、方差、全概率公式以及贝叶斯公式。</p>
<div id="均值公式" class="section level6">
<h6>均值公式：</h6>
<p><span class="math display">\[ \bar{x} = \frac{1}{n}\sum_{i=1}^{n}x_i
\]</span></p>
</div>
<div id="方差公式" class="section level6">
<h6>方差公式：</h6>
<p><span class="math display">\[ \sigma^2 =
\frac{1}{n}\sum_{i=1}^{n}(x_i - \bar{x})^2 \]</span></p>
</div>
<div id="全概率公式" class="section level6">
<h6>全概率公式：</h6>
<p><span class="math display">\[ P(A) = \sum_{i} P(A \mid B_i) P(B_i)
\]</span></p>
</div>
<div id="贝叶斯公式" class="section level6">
<h6>贝叶斯公式：</h6>
<p><span class="math display">\[ P(A \mid B) = \frac{P(B \mid A)
P(A)}{P(B)} \]</span></p>
</div>
<div id="条件熵公式" class="section level6">
<h6>条件熵公式：</h6>
<p><span class="math display">\[ H(Y|X) = \sum_{x \in \mathcal{X}, y \in
\mathcal{Y}} p(x, y) \log \left( \frac{p(x)}{p(x, y)} \right)\]</span>
这个条件熵公式也是老师ppt上的例子。</p>
</div>
</div>
<div id="例三" class="section level5">
<h5>例三</h5>
<p>在这个例子我们展示R语言适用于统计的便利性。</p>
<p>R语言可以生成多种服从不同分布的样本，我们以标准正态分布为例：</p>
<p><span class="math display">\[f(x) = \frac{1}{\sqrt{2\pi}}
e^{-\frac{x^2}{2}}\]</span></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># 设置图形布局为1行2列</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))  </span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co"># 生成100个标准正态分布的随机点</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>data_100 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co"># 绘制100个样本点的直方图</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="fu">hist</span>(data_100, <span class="at">breaks =</span> <span class="dv">10</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>, </span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;标准正态分布的直方图</span><span class="sc">\n</span><span class="st">(样本点数 = 100)&quot;</span>, </span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>, </span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>)</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co"># 生成1000个标准正态分布的随机点</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>data_1000 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co"># 绘制1000个样本点的直方图</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="fu">hist</span>(data_1000, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>, </span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;标准正态分布的直方图</span><span class="sc">\n</span><span class="st">(样本点数 = 1000)&quot;</span>, </span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>, </span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>)</span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># 恢复默认的图形布局</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p>可以看到，随着样本点个数n的增大，生成的随机样本分布与给定的分布越来越近似。</p>
<p>除此之外，R语言强大的统计工具不仅限于生成随机样本，还可以进行多种统计分析，如回归分析、假设检验、方差分析等。</p>
<ol style="list-style-type: decimal">
<li><p><strong>线性回归</strong>：R语言可以通过<code>lm()</code>函数进行线性回归分析，并轻松提取回归系数和模型诊断信息。</p></li>
<li><p><strong>假设检验</strong>：如<code>t检验</code>、<code>卡方检验</code>、<code>F检验</code>等，R语言提供了丰富的检验函数，如<code>t.test()</code>、<code>chisq.test()</code>等。</p></li>
<li><p><strong>方差分析（ANOVA）</strong>：R语言可以通过<code>aov()</code>函数进行方差分析，用于比较多个组之间的均值差异是否显著。</p></li>
</ol>
<div id="线性回归示例" class="section level6">
<h6>线性回归示例</h6>
<p>我们可以通过一组模拟数据来展示线性回归分析的功能：</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># 生成模拟数据</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co"># 线性回归模型</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co"># 输出回归结果</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.9073 -0.6835 -0.0875  0.5806  3.2904 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.10280    0.09755  -1.054    0.295    
## x            1.94753    0.10688  18.222   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.9707 on 98 degrees of freedom
## Multiple R-squared:  0.7721, Adjusted R-squared:  0.7698 
## F-statistic:   332 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># 绘制回归图</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">main =</span> <span class="st">&quot;线性回归图&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="fu">abline</span>(model, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>从回归结果中，我们可以轻松得到回归系数、残差分析等信息，并且可以通过图形展示回归结果与数据的拟合情况。</p>
</div>
</div>
</div>
<div id="总结" class="section level4">
<h4>总结</h4>
<p>我们展示了R
markdown的强大功能与便利性。R语言作为统计中最常用的语言，R
markdown为R语言创造了一个良好的表示环境，使数据分析、可视化和报告生成可以在一个统一的框架中无缝集成，这使得其成为现代统计分析和数据科学的重要工具。</p>
</div>
</div>
<div id="homework-2" class="section level3">
<h3>Homework-2</h3>
<div id="练习一-rayleigh分布随机数生成" class="section level4">
<h4>练习一 ：Rayleigh分布随机数生成</h4>
<p>Rayleigh分布的概率密度函数如下：</p>
<p><span class="math display">\[
f(x) = \frac{x}{\sigma^2} e^{-x^2/(2\sigma^2)}, \quad x \geq 0, \,
\sigma &gt; 0.
\]</span></p>
<p>写出一个算法来生成服从Rayleigh<span class="math inline">\((\sigma)\)</span>分布的随机样本，并通过直方图来验证。</p>
<p>这里我采用的是逆变换法，因为Rayleigh分布的累计分布函数比较好求出：</p>
<p><span class="math display">\[
F(x) = 1 - \exp\left(-\frac{x^2}{2\sigma^2}\right)
\]</span></p>
<p>其中，<span class="math inline">\(\sigma\)</span> 是尺度参数，<span class="math inline">\(x \geq 0\)</span>。</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co"># 设定参数</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>sigma_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>)  <span class="co"># 不同的尺度参数</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 生成随机数的数量</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co"># 循环遍历每个sigma值</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="cf">for</span> (sigma <span class="cf">in</span> sigma_values) {</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>  <span class="co"># 生成均匀分布的随机数</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>  </span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>  <span class="co"># 使用逆变换法生成Rayleigh分布的随机数</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>  X <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>U))</span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>  </span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>  <span class="co"># 绘制直方图</span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>  <span class="fu">hist</span>(X, <span class="at">breaks=</span><span class="dv">30</span>, <span class="at">probability=</span><span class="cn">TRUE</span>,</span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>       <span class="at">main=</span><span class="fu">paste</span>(<span class="st">&quot;Rayleigh Distribution (sigma =&quot;</span>, sigma, <span class="st">&quot;)&quot;</span>),</span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;Value&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Density&quot;</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>))</span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a>  </span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a>  <span class="co"># 添加理论密度曲线</span></span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a>  <span class="fu">curve</span>((x<span class="sc">/</span>(sigma<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)), <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a>}</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>在这里，我选取了逆变换法生成随机数，并展示了样本数为10000，<span class="math inline">\(\sigma\)</span>=(1,3,5,7)时的直方图(密度曲线)。可以看到，由逆变换法生成Rayleigh分布随机数较好的服从了Rayleigh分布。</p>
</div>
<div id="练习二正态位置混合分布随机样本生成" class="section level4">
<h4>练习二：正态位置混合分布随机样本生成</h4>
<p>生成大小为1000的正态混合分布随机样本。该混合的组成部分分别为 <span class="math inline">\(N(0, 1)\)</span> 和 <span class="math inline">\(N(3, 1)\)</span> 分布，它们的混合概率分别为 <span class="math inline">\(p_1\)</span> 和 <span class="math inline">\(p_2 =
1 - p_1\)</span>。绘制样本的直方图，并叠加密度曲线，首先选择 <span class="math inline">\(p_1 = 0.75\)</span>。随后，用不同的 <span class="math inline">\(p_1\)</span>
值重复实验，并观察经验分布是否呈现双峰。对于会产生双峰混合分布的 <span class="math inline">\(p_1\)</span> 值给出预测。</p>
<p>首先绘制<span class="math inline">\(p_1\)</span>=0.75时的图像：</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># 样本容量</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fl">0.75</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(p1, <span class="dv">1</span><span class="sc">-</span>p1)</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co"># 生成混合分布</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">size =</span> N, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> p)</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N)</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> <span class="dv">3</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>x <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> k) <span class="sc">*</span> y1 <span class="sc">+</span> k <span class="sc">*</span> y2</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co"># 绘制直方图和核密度估计曲线</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;p1 =&quot;</span>, p1), <span class="at">col =</span> <span class="dv">4</span>, <span class="at">breaks =</span> <span class="dv">100</span>)</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(x), <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>可以看到<span class="math inline">\(p_1\)</span>取0.75时，双峰已经不太明显了。</p>
<p>选择不同的 <span class="math inline">\(p_1\)</span> 值重复实验：</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># 样本容量</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co"># 定义不同的p1值</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>p1_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.1</span>, <span class="at">to =</span> <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co"># 生成图形</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="cf">for</span> (p1 <span class="cf">in</span> p1_vals) {</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">c</span>(p1, <span class="dv">1</span> <span class="sc">-</span> p1)</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">size =</span> N, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> p)</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>  </span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>  <span class="co"># 生成两个正态分布</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N)</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>  y2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> <span class="dv">3</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>  </span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>  <span class="co"># 混合分布</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>  x <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> k) <span class="sc">*</span> y1 <span class="sc">+</span> k <span class="sc">*</span> y2</span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>  </span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a>  <span class="co"># 绘制直方图和核密度估计曲线</span></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a>  <span class="fu">hist</span>(x, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;p1 =&quot;</span>, p1), <span class="at">col =</span> <span class="dv">4</span>, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">border =</span> <span class="st">&quot;white&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">density</span>(x), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a>}</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>从不同得到<span class="math inline">\(p\)</span>的表现可以推测，当<span class="math inline">\(p_1\in[0.3,07]\)</span>时，混合分布呈现较明显的双峰。</p>
<p><strong>一些小问题</strong>：观察<span class="math inline">\(p_1=0.75\)</span>时的直方图，可以发现其直方图与真实密度曲线拟合的并不是十分完美，这应该是样本数量较小导致的，在样本量增加到10000时会发现拟合的很好，所以在练习一和练习三中，我都设置的生成样本量为10000。</p>
</div>
<div id="练习三复合泊松过程模拟" class="section level4">
<h4>练习三：复合泊松过程模拟</h4>
<p>复合泊松过程是一个随机过程 <span class="math inline">\(\{X(t), t \geq
0\}\)</span>，可以表示为随机和： <span class="math display">\[
X(t) = \sum_{i=1}^{N(t)} Y_i, \quad t \geq 0,
\]</span> 其中 <span class="math inline">\(\{N(t), t \geq 0\}\)</span>
是一个泊松过程，且 <span class="math inline">\(Y_1, Y_2, \dots\)</span>
是独立同分布的随机变量，并且独立于 <span class="math inline">\(\{N(t), t
\geq 0\}\)</span>。</p>
<p>编写程序模拟一个复合泊松<span class="math inline">\((\lambda)\)</span>-Gamma过程（其中 <span class="math inline">\(Y\)</span> 服从Gamma分布）。估计 <span class="math inline">\(X(10)\)</span>
的均值和方差，针对多个参数组合进行模拟，并与理论值进行比较。</p>
<p>在这里我给出<strong>两种</strong>不同模拟 <span class="math inline">\(N(t)\)</span> 的方法：</p>
</div>
<div id="练习三-法一" class="section level4">
<h4>练习三 法一</h4>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 设置随机种子保证结果可重复</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="co"># 参数设置</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">4</span>    <span class="co"># 泊松过程的λ参数</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>shape <span class="ot">&lt;-</span> <span class="dv">5</span>     <span class="co"># Gamma分布的形状参数 (shape)</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>scale <span class="ot">&lt;-</span> <span class="dv">6</span>     <span class="co"># Gamma分布的尺度参数 (scale)</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span>        <span class="co"># 时间t</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co"># 模拟次数</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="co"># 到达间隔时间随速率λ呈指数分布</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>pp.exp <span class="ot">&lt;-</span> <span class="cf">function</span>(t0) {</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>  Tn <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">1000</span>, lambda)  <span class="co"># 生成间隔时间的指数分布</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>  Sn <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(Tn)          <span class="co"># 累积和计算事件发生的时间</span></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">min</span>(<span class="fu">which</span>(Sn <span class="sc">&gt;</span> t0)) <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># 返回第一个超过时间t的索引</span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a>}</span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a><span class="co"># 生成服从泊松分布的N(t)</span></span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a>N_t <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n_sim, <span class="fu">pp.exp</span>(t))</span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a><span class="co"># 生成复合泊松过程的X(t)</span></span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a>X_t <span class="ot">&lt;-</span> <span class="fu">sapply</span>(N_t, <span class="cf">function</span>(n) {</span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n =</span> n, <span class="at">shape =</span> shape, <span class="at">scale =</span> scale)  <span class="co"># Gamma分布</span></span>
<span id="cb19-23"><a href="#cb19-23" tabindex="-1"></a>  <span class="fu">sum</span>(Y[<span class="dv">1</span><span class="sc">:</span>n])  <span class="co"># 求和得到X(t)</span></span>
<span id="cb19-24"><a href="#cb19-24" tabindex="-1"></a>})</span>
<span id="cb19-25"><a href="#cb19-25" tabindex="-1"></a></span>
<span id="cb19-26"><a href="#cb19-26" tabindex="-1"></a><span class="co"># 估计均值和方差</span></span>
<span id="cb19-27"><a href="#cb19-27" tabindex="-1"></a>mean_X_t <span class="ot">&lt;-</span> <span class="fu">mean</span>(X_t)</span>
<span id="cb19-28"><a href="#cb19-28" tabindex="-1"></a>var_X_t <span class="ot">&lt;-</span> <span class="fu">var</span>(X_t)</span>
<span id="cb19-29"><a href="#cb19-29" tabindex="-1"></a></span>
<span id="cb19-30"><a href="#cb19-30" tabindex="-1"></a><span class="co"># 理论均值和方差</span></span>
<span id="cb19-31"><a href="#cb19-31" tabindex="-1"></a>theoretical_mean <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> shape <span class="sc">*</span> scale</span>
<span id="cb19-32"><a href="#cb19-32" tabindex="-1"></a>theoretical_var <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> (shape <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> shape <span class="sc">*</span> scale<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb19-33"><a href="#cb19-33" tabindex="-1"></a></span>
<span id="cb19-34"><a href="#cb19-34" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb19-35"><a href="#cb19-35" tabindex="-1"></a><span class="fu">matrix</span>(<span class="fu">c</span>(mean_X_t, theoretical_mean, var_X_t, theoretical_var), </span>
<span id="cb19-36"><a href="#cb19-36" tabindex="-1"></a>       <span class="at">ncol =</span> <span class="dv">4</span>, </span>
<span id="cb19-37"><a href="#cb19-37" tabindex="-1"></a>       <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;value&quot;</span>), <span class="fu">c</span>(<span class="st">&quot;Estimated Mean&quot;</span>, <span class="st">&quot;Theoretical Mean&quot;</span>, <span class="st">&quot;Estimated Variance&quot;</span>, <span class="st">&quot;Theoretical Variance&quot;</span>)))</span></code></pre></div>
<pre><code>##       Estimated Mean Theoretical Mean Estimated Variance Theoretical Variance
## value        1198.15             1200           42763.47                43200</code></pre>
</div>
<div id="练习三-法二" class="section level4">
<h4>练习三 法二</h4>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 设置随机种子保证结果可重复</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="co"># 参数设置</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">4</span>    <span class="co"># 泊松过程的λ参数</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span>        <span class="co"># 时间t</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>shape <span class="ot">&lt;-</span> <span class="dv">5</span>     <span class="co"># Gamma分布的形状参数 (shape)</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>scale <span class="ot">&lt;-</span> <span class="dv">6</span>     <span class="co"># Gamma分布的尺度参数 (scale)</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co"># 模拟次数</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="co"># 模拟复合泊松过程</span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>X_t <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_sim)  <span class="co"># 存储X(t)的结果</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sim) {</span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>  N_t <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>, lambda <span class="sc">*</span> t)  <span class="co"># 生成N(t)，泊松分布</span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>  <span class="cf">if</span> (N_t <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N_t, <span class="at">shape=</span>shape, <span class="at">scale=</span>scale)  <span class="co"># 生成Y_i，Gamma分布 (使用shape和scale)</span></span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a>    X_t[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y)  <span class="co"># 求和得到X(t)</span></span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a>    X_t[i] <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># 当N(t)=0时，X(t)=0</span></span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a>  }</span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a>}</span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a></span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a><span class="co"># 估计均值和方差</span></span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a>mean_X_t <span class="ot">&lt;-</span> <span class="fu">mean</span>(X_t)</span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a>var_X_t <span class="ot">&lt;-</span> <span class="fu">var</span>(X_t)</span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a></span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a><span class="co"># 理论均值和方差</span></span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a>theoretical_mean <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> shape <span class="sc">*</span> scale</span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a>theoretical_var <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> shape<span class="sc">*</span>(shape<span class="sc">+</span><span class="dv">1</span>) <span class="sc">*</span> (scale<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb21-30"><a href="#cb21-30" tabindex="-1"></a></span>
<span id="cb21-31"><a href="#cb21-31" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb21-32"><a href="#cb21-32" tabindex="-1"></a><span class="fu">matrix</span>(<span class="fu">c</span>(mean_X_t,theoretical_mean,var_X_t,theoretical_var),<span class="at">ncol =</span> <span class="dv">4</span>,</span>
<span id="cb21-33"><a href="#cb21-33" tabindex="-1"></a>          <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;value&quot;</span>),<span class="fu">c</span>(<span class="st">&quot;Estimated Mean&quot;</span>,<span class="st">&quot;Theoretical Mean&quot;</span>,<span class="st">&quot;Estimated Variance&quot;</span>, <span class="st">&quot;Theoretical Variance&quot;</span>)))</span></code></pre></div>
<pre><code>##       Estimated Mean Theoretical Mean Estimated Variance Theoretical Variance
## value       1201.103             1200           42606.11                43200</code></pre>
<p>无论是<strong>法一</strong>与<strong>法二</strong>，二者给出的拟合结果都很好，很接近真实值。</p>
<p><strong>法一</strong>与<strong>法二</strong>的主要区别在于泊松过程
<span class="math inline">\(N(t)\)</span> 的生成方式：</p>
<ol style="list-style-type: decimal">
<li><strong>法一</strong>：
<ul>
<li>通过生成指数分布的间隔时间来模拟泊松过程。这种方法更接近于泊松过程的定义，即时间间隔服从指数分布，然后通过累积和来确定事件发生的数量。</li>
<li>使用了 <code>rexp()</code> 函数生成事件间隔，并用累积和找到超过
<span class="math inline">\(t\)</span>
的最小时间点。这是一种基于间隔时间的模拟。</li>
</ul></li>
<li><strong>法二</strong>：
<ul>
<li>直接使用 <code>rpois()</code> 函数生成在时间 <span class="math inline">\(t\)</span>
内的事件数量。这是通过泊松分布的性质直接生成事件数量的一种方法。</li>
<li><code>rpois(1, lambda * t)</code>
直接根据泊松过程的公式生成在给定时间 <span class="math inline">\(t\)</span> 内的事件总数。</li>
</ul></li>
</ol>
<ul>
<li><strong>法一</strong>更适用于需要基于间隔时间来研究事件发生的时间点的情形，它模拟了泊松过程的“本质”——间隔时间服从指数分布。</li>
<li><strong>法二</strong>使用了更简便的 <code>rpois()</code>
函数，直接生成了事件数量，是一种更加高效的实现方法，适合快速生成泊松事件的场合。</li>
</ul>
<p>两种方法在估计复合泊松过程的 <span class="math inline">\(X(t)\)</span>
的均值和方差时，得出了较为接近的结果，但法二的实现更加简洁，适合大规模模拟。</p>
</div>
</div>
<div id="homework-3" class="section level3">
<h3>Homework-3</h3>
<div id="练习一" class="section level4">
<h4>练习一：</h4>
<p><strong>5.4 编写一个函数来计算 Beta(3, 3)
分布的CDF的蒙特卡罗估计，并使用该函数估计 F(x)，其中 x = 0.1, 0.2, …,
0.9。将估计值与 R 中 <code>pbeta</code>
函数的返回值进行比较。</strong></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="co"># Monte Carlo方法估计Beta分布的CDF</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>mc_beta_cdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">n =</span> <span class="dv">10000</span>) {</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>  <span class="co"># 从Beta(3, 3)分布中生成n个随机样本</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n, alpha, beta)</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>  <span class="co"># 计算P(X &lt;= x)的比例</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(samples <span class="sc">&lt;=</span> x))</span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>}</span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a><span class="co"># 估计不同x值下的CDF</span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a>mc_estimates <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x_values, mc_beta_cdf)</span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a></span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a><span class="co"># 使用pbeta函数计算真实值</span></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a>pbeta_values <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(x_values, alpha, beta)</span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a><span class="co"># 打印结果</span></span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_values, <span class="at">MonteCarlo_Estimate =</span> mc_estimates, <span class="at">pbeta_Value =</span> pbeta_values)</span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>##     x MonteCarlo_Estimate pbeta_Value
## 1 0.1              0.0095     0.00856
## 2 0.2              0.0535     0.05792
## 3 0.3              0.1544     0.16308
## 4 0.4              0.3198     0.31744
## 5 0.5              0.5029     0.50000
## 6 0.6              0.6789     0.68256
## 7 0.7              0.8385     0.83692
## 8 0.8              0.9456     0.94208
## 9 0.9              0.9922     0.99144</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co"># 比较两个结果</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="fu">plot</span>(x_values, mc_estimates, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">ylim =</span> <span class="fu">range</span>(<span class="fu">c</span>(mc_estimates, pbeta_values)),</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;F(x)&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Comparison of Monte Carlo and pbeta&quot;</span>)</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="fu">lines</span>(x_values, pbeta_values, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">pch =</span> <span class="dv">17</span>)</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Monte Carlo Estimate&quot;</span>, <span class="st">&quot;pbeta Value&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">17</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>从结果可以看出，用蒙特卡罗估计得到的值与真实值十分接近。</p>
</div>
<div id="练习二" class="section level4">
<h4>练习二</h4>
<p><strong>5.9 Rayleigh 分布的概率密度函数为：</strong></p>
<p><span class="math display">\[
f(x) = \frac{x}{\sigma^2} e^{-x^2 / (2\sigma^2)}, \quad x \geq 0, \sigma
&gt; 0.
\]</span></p>
<p><strong>实现一个函数，使用对偶变量（antithetic variables）从
Rayleigh(σ) 分布中生成样本。比较</strong></p>
<p><span class="math display">\[
\frac{X + X&#39;}{2}
\]</span></p>
<p><strong>的方差相对于独立的</strong> <span class="math inline">\(X_1,
X_2\)</span> 的方差减少了多少百分比？</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># 设置Rayleigh分布的参数</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 样本数量</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="co"># 定义生成Rayleigh分布的函数，这里采用逆变换法</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>rayleigh_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(n, sigma) {</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>  X <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(U))</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>}</span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a><span class="co"># 生成对偶变量样本</span></span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a>rayleigh_antithetic <span class="ot">&lt;-</span> <span class="cf">function</span>(n, sigma) {</span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(U))</span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a>  X2 <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> U))</span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(X1, X2))</span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a>}</span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a></span>
<span id="cb26-20"><a href="#cb26-20" tabindex="-1"></a><span class="co"># 计算独立样本的均值和方差</span></span>
<span id="cb26-21"><a href="#cb26-21" tabindex="-1"></a>X_ind <span class="ot">&lt;-</span> <span class="fu">rayleigh_sample</span>(n, sigma)</span>
<span id="cb26-22"><a href="#cb26-22" tabindex="-1"></a>mean_ind <span class="ot">&lt;-</span> <span class="fu">mean</span>(X_ind)</span>
<span id="cb26-23"><a href="#cb26-23" tabindex="-1"></a>var_ind <span class="ot">&lt;-</span> <span class="fu">var</span>(X_ind)</span>
<span id="cb26-24"><a href="#cb26-24" tabindex="-1"></a></span>
<span id="cb26-25"><a href="#cb26-25" tabindex="-1"></a><span class="co"># 计算对偶变量样本的均值和方差</span></span>
<span id="cb26-26"><a href="#cb26-26" tabindex="-1"></a>X_antithetic <span class="ot">&lt;-</span> <span class="fu">rayleigh_antithetic</span>(n, sigma)</span>
<span id="cb26-27"><a href="#cb26-27" tabindex="-1"></a>X_combined <span class="ot">&lt;-</span> (X_antithetic[<span class="dv">1</span><span class="sc">:</span>(n<span class="sc">/</span><span class="dv">2</span>)] <span class="sc">+</span> X_antithetic[(n<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n]) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb26-28"><a href="#cb26-28" tabindex="-1"></a>mean_combined <span class="ot">&lt;-</span> <span class="fu">mean</span>(X_combined)</span>
<span id="cb26-29"><a href="#cb26-29" tabindex="-1"></a>var_combined <span class="ot">&lt;-</span> <span class="fu">var</span>(X_combined)</span>
<span id="cb26-30"><a href="#cb26-30" tabindex="-1"></a></span>
<span id="cb26-31"><a href="#cb26-31" tabindex="-1"></a><span class="co"># 计算方差减少百分比</span></span>
<span id="cb26-32"><a href="#cb26-32" tabindex="-1"></a>percent_reduction <span class="ot">&lt;-</span> (var_ind <span class="sc">-</span> var_combined) <span class="sc">/</span> var_ind <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb26-33"><a href="#cb26-33" tabindex="-1"></a></span>
<span id="cb26-34"><a href="#cb26-34" tabindex="-1"></a><span class="co"># 打印结果</span></span>
<span id="cb26-35"><a href="#cb26-35" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;独立样本的均值:&quot;</span>, mean_ind, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 独立样本的均值: 1.246902</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;对偶变量样本的均值:&quot;</span>, mean_combined, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 对偶变量样本的均值: 1.253113</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;独立样本的方差:&quot;</span>, var_ind, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 独立样本的方差: 0.4390263</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;对偶变量样本的方差:&quot;</span>, var_combined, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 对偶变量样本的方差: 0.01067633</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;方差减少百分比:&quot;</span>, percent_reduction, <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 方差减少百分比: 97.56818 %</code></pre>
<p>可以发现，采用对偶变量法可有效缩减方差。</p>
</div>
<div id="练习三" class="section level4">
<h4>练习三</h4>
<p><strong>5.13：找到两个重要性函数</strong> <span class="math inline">\(f_1\)</span> 和 <span class="math inline">\(f_2\)</span>，它们定义在区间 <span class="math inline">\((1, \infty)\)</span> 上，并且与</p>
<p><span class="math display">\[
g(x) = \frac{x^2}{\sqrt{2\pi}} e^{-x^2 / 2}, \quad x &gt; 1
\]</span></p>
<p><strong>接近。在使用重要性采样估计</strong></p>
<p><span class="math display">\[
\int_1^{\infty} \frac{x^2}{\sqrt{2\pi}} e^{-x^2 / 2} \, dx
\]</span></p>
<p><strong>的过程中，哪个重要性函数应该产生较小的方差？并进行解释。</strong></p>
<div id="解答过程" class="section level5">
<h5>解答过程</h5>
<p>首先我们用数值积分计算积分真实值</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>  (x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>}</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">integrate</span>(f, <span class="at">lower =</span> <span class="dv">1</span>, <span class="at">upper =</span> <span class="cn">Inf</span>)</span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;积分结果: &quot;</span>, result<span class="sc">$</span>value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 积分结果:  0.400626</code></pre>
<p>为了对比明显，我选择了三个重要性函数，分别是：</p>
<p><span class="math display">\[
g(x) = \frac{x^2}{\sqrt{2\pi}} e^{-x^2 / 2}
\]</span></p>
<ol style="list-style-type: decimal">
<li><p>截断的正态分布 <span class="math inline">\(f_1(x)\)</span>：
<span class="math display">\[
f_1(x) = \frac{\phi(x)}{1 - \Phi(1)}, \quad x &gt; 1
\]</span> 其中，<span class="math inline">\(\phi(x)\)</span>
为标准正态分布的概率密度函数，<span class="math inline">\(\Phi(x)\)</span>
为标准正态分布的累积分布函数。</p></li>
<li><p>指数分布 <span class="math inline">\(f_2(x)\)</span>，<span class="math inline">\(\lambda = 1\)</span>： <span class="math display">\[
f_2(x) = e^{-(x - 1)}, \quad x &gt; 1
\]</span></p></li>
<li><p>Rayleigh 分布 <span class="math inline">\(f_3(x)\)</span>，<span class="math inline">\(\sigma = 1\)</span>： <span class="math display">\[
f_3(x) = \frac{x \cdot e^{-x^2 / 2}}{1 - \left(1 - e^{-1/2}\right)},
\quad x &gt; 1
\]</span></p></li>
</ol>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a><span class="co"># 定义 g(x) 函数</span></span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>  (x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a>}</span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a><span class="co"># 截断的正态分布 (f_1) 密度函数</span></span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb38-9"><a href="#cb38-9" tabindex="-1"></a>  <span class="fu">dnorm</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="dv">1</span>))  <span class="co"># 截断的标准正态分布（x &gt; 1）</span></span>
<span id="cb38-10"><a href="#cb38-10" tabindex="-1"></a>}</span>
<span id="cb38-11"><a href="#cb38-11" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" tabindex="-1"></a><span class="co"># 指数分布 (f_2) 密度函数，lambda = 1</span></span>
<span id="cb38-13"><a href="#cb38-13" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb38-14"><a href="#cb38-14" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span>(x <span class="sc">-</span> <span class="dv">1</span>))  <span class="co"># 指数分布的 PDF (x &gt; 1)</span></span>
<span id="cb38-15"><a href="#cb38-15" tabindex="-1"></a>}</span>
<span id="cb38-16"><a href="#cb38-16" tabindex="-1"></a></span>
<span id="cb38-17"><a href="#cb38-17" tabindex="-1"></a><span class="co"># Rayleigh 分布 (f_3) 密度函数，sigma = 1</span></span>
<span id="cb38-18"><a href="#cb38-18" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb38-19"><a href="#cb38-19" tabindex="-1"></a>  <span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">1</span>, (x <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>))), <span class="dv">0</span>)  <span class="co"># 归一化的 PDF</span></span>
<span id="cb38-20"><a href="#cb38-20" tabindex="-1"></a>}</span>
<span id="cb38-21"><a href="#cb38-21" tabindex="-1"></a></span>
<span id="cb38-22"><a href="#cb38-22" tabindex="-1"></a><span class="co"># 生成 f_1 和 f_2 下的样本</span></span>
<span id="cb38-23"><a href="#cb38-23" tabindex="-1"></a>sample_f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb38-24"><a href="#cb38-24" tabindex="-1"></a>  <span class="co"># 初始化一个空的向量，用来存储大于1的随机数</span></span>
<span id="cb38-25"><a href="#cb38-25" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb38-26"><a href="#cb38-26" tabindex="-1"></a>  </span>
<span id="cb38-27"><a href="#cb38-27" tabindex="-1"></a>  <span class="co"># 继续生成随机数，直到我们收集到n个大于1的数</span></span>
<span id="cb38-28"><a href="#cb38-28" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">length</span>(result) <span class="sc">&lt;</span> n) {</span>
<span id="cb38-29"><a href="#cb38-29" tabindex="-1"></a>    <span class="co"># 从标准正态分布中生成随机数</span></span>
<span id="cb38-30"><a href="#cb38-30" tabindex="-1"></a>    random_numbers <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb38-31"><a href="#cb38-31" tabindex="-1"></a>    </span>
<span id="cb38-32"><a href="#cb38-32" tabindex="-1"></a>    <span class="co"># 选择大于1的随机数</span></span>
<span id="cb38-33"><a href="#cb38-33" tabindex="-1"></a>    valid_numbers <span class="ot">&lt;-</span> random_numbers[random_numbers <span class="sc">&gt;</span> <span class="dv">1</span>]</span>
<span id="cb38-34"><a href="#cb38-34" tabindex="-1"></a>    </span>
<span id="cb38-35"><a href="#cb38-35" tabindex="-1"></a>    <span class="co"># 将这些大于1的数添加到结果中</span></span>
<span id="cb38-36"><a href="#cb38-36" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">c</span>(result, valid_numbers)</span>
<span id="cb38-37"><a href="#cb38-37" tabindex="-1"></a>  }</span>
<span id="cb38-38"><a href="#cb38-38" tabindex="-1"></a>  </span>
<span id="cb38-39"><a href="#cb38-39" tabindex="-1"></a>  <span class="co"># 返回前n个大于1的数</span></span>
<span id="cb38-40"><a href="#cb38-40" tabindex="-1"></a>  <span class="fu">return</span>(result[<span class="dv">1</span><span class="sc">:</span>n])</span>
<span id="cb38-41"><a href="#cb38-41" tabindex="-1"></a>}</span>
<span id="cb38-42"><a href="#cb38-42" tabindex="-1"></a></span>
<span id="cb38-43"><a href="#cb38-43" tabindex="-1"></a>sample_f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb38-44"><a href="#cb38-44" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb38-45"><a href="#cb38-45" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">length</span>(result) <span class="sc">&lt;</span> n) {</span>
<span id="cb38-46"><a href="#cb38-46" tabindex="-1"></a>    random_numbers <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n)</span>
<span id="cb38-47"><a href="#cb38-47" tabindex="-1"></a>    valid_numbers <span class="ot">&lt;-</span> random_numbers[random_numbers <span class="sc">&gt;</span> <span class="dv">1</span>]</span>
<span id="cb38-48"><a href="#cb38-48" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">c</span>(result, valid_numbers)</span>
<span id="cb38-49"><a href="#cb38-49" tabindex="-1"></a>  }</span>
<span id="cb38-50"><a href="#cb38-50" tabindex="-1"></a>  <span class="fu">return</span>(result[<span class="dv">1</span><span class="sc">:</span>n])</span>
<span id="cb38-51"><a href="#cb38-51" tabindex="-1"></a>}</span>
<span id="cb38-52"><a href="#cb38-52" tabindex="-1"></a></span>
<span id="cb38-53"><a href="#cb38-53" tabindex="-1"></a><span class="co"># 从 Rayleigh 分布中生成样本，确保归一化</span></span>
<span id="cb38-54"><a href="#cb38-54" tabindex="-1"></a>sample_f3 <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb38-55"><a href="#cb38-55" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb38-56"><a href="#cb38-56" tabindex="-1"></a>  </span>
<span id="cb38-57"><a href="#cb38-57" tabindex="-1"></a>  <span class="co"># 继续生成随机数，直到我们收集到n个大于1的数</span></span>
<span id="cb38-58"><a href="#cb38-58" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">length</span>(result) <span class="sc">&lt;</span> n) {</span>
<span id="cb38-59"><a href="#cb38-59" tabindex="-1"></a>    <span class="co"># 生成 Rayleigh 分布的随机数，使用 sqrt(-2 * log(U))</span></span>
<span id="cb38-60"><a href="#cb38-60" tabindex="-1"></a>    random_numbers <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">runif</span>(n)))</span>
<span id="cb38-61"><a href="#cb38-61" tabindex="-1"></a>    valid_numbers <span class="ot">&lt;-</span> random_numbers[random_numbers <span class="sc">&gt;</span> <span class="dv">1</span>]</span>
<span id="cb38-62"><a href="#cb38-62" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">c</span>(result, valid_numbers)</span>
<span id="cb38-63"><a href="#cb38-63" tabindex="-1"></a>  }</span>
<span id="cb38-64"><a href="#cb38-64" tabindex="-1"></a>  </span>
<span id="cb38-65"><a href="#cb38-65" tabindex="-1"></a>  <span class="co"># 返回前n个大于1的数</span></span>
<span id="cb38-66"><a href="#cb38-66" tabindex="-1"></a>  <span class="fu">return</span>(result[<span class="dv">1</span><span class="sc">:</span>n])</span>
<span id="cb38-67"><a href="#cb38-67" tabindex="-1"></a>}</span>
<span id="cb38-68"><a href="#cb38-68" tabindex="-1"></a></span>
<span id="cb38-69"><a href="#cb38-69" tabindex="-1"></a><span class="co"># 重要性采样估计积分</span></span>
<span id="cb38-70"><a href="#cb38-70" tabindex="-1"></a>importance_sampling <span class="ot">&lt;-</span> <span class="cf">function</span>(f_sample, f_density, g, n) {</span>
<span id="cb38-71"><a href="#cb38-71" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">f_sample</span>(n)</span>
<span id="cb38-72"><a href="#cb38-72" tabindex="-1"></a>  weights <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">f_density</span>(x)</span>
<span id="cb38-73"><a href="#cb38-73" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(weights))</span>
<span id="cb38-74"><a href="#cb38-74" tabindex="-1"></a>}</span>
<span id="cb38-75"><a href="#cb38-75" tabindex="-1"></a></span>
<span id="cb38-76"><a href="#cb38-76" tabindex="-1"></a><span class="co"># 设置样本数</span></span>
<span id="cb38-77"><a href="#cb38-77" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb38-78"><a href="#cb38-78" tabindex="-1"></a></span>
<span id="cb38-79"><a href="#cb38-79" tabindex="-1"></a><span class="co"># 使用 f_1 进行重要性采样</span></span>
<span id="cb38-80"><a href="#cb38-80" tabindex="-1"></a>estimate_f1 <span class="ot">&lt;-</span> <span class="fu">importance_sampling</span>(sample_f1, f1, g, n)</span>
<span id="cb38-81"><a href="#cb38-81" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;使用 f_1 的重要性采样估计值:&quot;</span>, estimate_f1, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb38-82"><a href="#cb38-82" tabindex="-1"></a></span>
<span id="cb38-83"><a href="#cb38-83" tabindex="-1"></a><span class="co"># 使用 f_2 进行重要性采样</span></span>
<span id="cb38-84"><a href="#cb38-84" tabindex="-1"></a>estimate_f2 <span class="ot">&lt;-</span> <span class="fu">importance_sampling</span>(sample_f2, f2, g, n)</span>
<span id="cb38-85"><a href="#cb38-85" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;使用 f_2 的重要性采样估计值:&quot;</span>, estimate_f2, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb38-86"><a href="#cb38-86" tabindex="-1"></a></span>
<span id="cb38-87"><a href="#cb38-87" tabindex="-1"></a><span class="co"># 使用 f_3 进行重要性采样</span></span>
<span id="cb38-88"><a href="#cb38-88" tabindex="-1"></a>estimate_f3 <span class="ot">&lt;-</span> <span class="fu">importance_sampling</span>(sample_f3, f3, g, n)</span>
<span id="cb38-89"><a href="#cb38-89" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;使用 f_3 的重要性采样估计值:&quot;</span>, estimate_f3, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb38-90"><a href="#cb38-90" tabindex="-1"></a></span>
<span id="cb38-91"><a href="#cb38-91" tabindex="-1"></a><span class="co"># 计算方差比较</span></span>
<span id="cb38-92"><a href="#cb38-92" tabindex="-1"></a>samples_f1 <span class="ot">&lt;-</span> <span class="fu">sample_f1</span>(n)</span>
<span id="cb38-93"><a href="#cb38-93" tabindex="-1"></a>samples_f2 <span class="ot">&lt;-</span> <span class="fu">sample_f2</span>(n)</span>
<span id="cb38-94"><a href="#cb38-94" tabindex="-1"></a>samples_f3 <span class="ot">&lt;-</span> <span class="fu">sample_f3</span>(n)</span>
<span id="cb38-95"><a href="#cb38-95" tabindex="-1"></a></span>
<span id="cb38-96"><a href="#cb38-96" tabindex="-1"></a>variance_f1 <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">g</span>(samples_f1) <span class="sc">/</span> <span class="fu">f1</span>(samples_f1))</span>
<span id="cb38-97"><a href="#cb38-97" tabindex="-1"></a>variance_f2 <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">g</span>(samples_f2) <span class="sc">/</span> <span class="fu">f2</span>(samples_f2))</span>
<span id="cb38-98"><a href="#cb38-98" tabindex="-1"></a>variance_f3 <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">g</span>(samples_f3) <span class="sc">/</span> <span class="fu">f3</span>(samples_f3))</span>
<span id="cb38-99"><a href="#cb38-99" tabindex="-1"></a></span>
<span id="cb38-100"><a href="#cb38-100" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;f_1 的重要性采样方差:&quot;</span>, variance_f1, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb38-101"><a href="#cb38-101" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;f_2 的重要性采样方差:&quot;</span>, variance_f2, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb38-102"><a href="#cb38-102" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;f_3 的重要性采样方差:&quot;</span>, variance_f3, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb38-103"><a href="#cb38-103" tabindex="-1"></a></span>
<span id="cb38-104"><a href="#cb38-104" tabindex="-1"></a><span class="co"># 计算方差减少百分比</span></span>
<span id="cb38-105"><a href="#cb38-105" tabindex="-1"></a>percent_reduction_f1_f2 <span class="ot">&lt;-</span> (variance_f1 <span class="sc">-</span> variance_f2) <span class="sc">/</span> variance_f1 <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb38-106"><a href="#cb38-106" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;f_2 相对于 f_1 的方差减少百分比:&quot;</span>, percent_reduction_f1_f2, <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb38-107"><a href="#cb38-107" tabindex="-1"></a></span>
<span id="cb38-108"><a href="#cb38-108" tabindex="-1"></a>percent_reduction_f1_f3 <span class="ot">&lt;-</span> (variance_f1 <span class="sc">-</span> variance_f3) <span class="sc">/</span> variance_f3 <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb38-109"><a href="#cb38-109" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;f_3 相对于 f_1 的方差减少百分比:&quot;</span>, percent_reduction_f1_f3, <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>对比结果我们发现方差表现：<span class="math inline">\(f_3&gt;f_2&gt;f_1\)</span>，其实这有点违反直觉，因为直觉上，我们感觉<span class="math inline">\(e^{-x^2}\)</span>相比于<span class="math inline">\(e^{-x}\)</span>与<span class="math inline">\(x^2e^{-x^2}\)</span>更接近(见下图)，但<span class="math inline">\(f_2\)</span>表现优于<span class="math inline">\(f_1\)</span>。</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="co"># 设置图形设备</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a><span class="co"># 定义 g(x) 函数</span></span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>  (x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>}</span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a><span class="co"># 计算各个分布的概率密度函数</span></span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a>g_values <span class="ot">&lt;-</span> <span class="fu">g</span>(x)</span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a>normal_values <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x)  <span class="co"># 正态分布</span></span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a>exponential_values <span class="ot">&lt;-</span> <span class="fu">dexp</span>(x <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># 指数分布，偏移至 x &gt; 1</span></span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a>rayleigh_values <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>, (x <span class="sc">/</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>), <span class="dv">0</span>)  <span class="co"># Rayleigh 分布，sigma = 1</span></span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a><span class="co"># 绘图</span></span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a><span class="fu">plot</span>(x, g_values, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb39-18"><a href="#cb39-18" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Comparison of g(x) and Various Distributions&quot;</span>)</span>
<span id="cb39-19"><a href="#cb39-19" tabindex="-1"></a><span class="fu">lines</span>(x, normal_values, <span class="at">col =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb39-20"><a href="#cb39-20" tabindex="-1"></a><span class="fu">lines</span>(x, exponential_values, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb39-21"><a href="#cb39-21" tabindex="-1"></a><span class="fu">lines</span>(x, rayleigh_values, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb39-22"><a href="#cb39-22" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;g(x)&quot;</span>, <span class="st">&quot;Normal Distribution (f1)&quot;</span>, <span class="st">&quot;Exponential Distribution (f2)&quot;</span>, <span class="st">&quot;Rayleigh Distribution (f3)&quot;</span>),</span>
<span id="cb39-23"><a href="#cb39-23" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb39-24"><a href="#cb39-24" tabindex="-1"></a><span class="fu">grid</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>在发现这个问题后，我去翻阅了课本，发现我们实际应比较的是<span class="math inline">\(g(x)/f(x)\)</span>，应选择使这个比值更接近常数的f(x)，做出<span class="math inline">\(g(x)/f_i(x)\)</span>，<span class="math inline">\(i=1,2,3\)</span>的图后我们可以发现：</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>  (x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>}</span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a><span class="co"># 截断的正态分布 (f_1) 密度函数</span></span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a>  <span class="fu">dnorm</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="dv">1</span>))  <span class="co"># 截断的标准正态分布（x &gt; 1）</span></span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a>}</span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" tabindex="-1"></a><span class="co"># 指数分布 (f_2) 密度函数，lambda = 1</span></span>
<span id="cb40-11"><a href="#cb40-11" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb40-12"><a href="#cb40-12" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span>(x <span class="sc">-</span> <span class="dv">1</span>))  <span class="co"># 指数分布的 PDF (x &gt; 1)</span></span>
<span id="cb40-13"><a href="#cb40-13" tabindex="-1"></a>}</span>
<span id="cb40-14"><a href="#cb40-14" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" tabindex="-1"></a><span class="co"># Rayleigh 分布 (f_3) 密度函数，sigma = 1</span></span>
<span id="cb40-16"><a href="#cb40-16" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb40-17"><a href="#cb40-17" tabindex="-1"></a>(x <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>))  <span class="co"># 归一化的 Rayleigh 分布</span></span>
<span id="cb40-18"><a href="#cb40-18" tabindex="-1"></a>}</span>
<span id="cb40-19"><a href="#cb40-19" tabindex="-1"></a></span>
<span id="cb40-20"><a href="#cb40-20" tabindex="-1"></a><span class="co"># 设置 x 的取值范围</span></span>
<span id="cb40-21"><a href="#cb40-21" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb40-22"><a href="#cb40-22" tabindex="-1"></a></span>
<span id="cb40-23"><a href="#cb40-23" tabindex="-1"></a><span class="co"># 计算 g(x) / f1(x), g(x) / f2(x), g(x) / f3(x)</span></span>
<span id="cb40-24"><a href="#cb40-24" tabindex="-1"></a>y_f1 <span class="ot">&lt;-</span> <span class="fu">g</span>(x_values) <span class="sc">/</span> <span class="fu">f1</span>(x_values)</span>
<span id="cb40-25"><a href="#cb40-25" tabindex="-1"></a>y_f2 <span class="ot">&lt;-</span> <span class="fu">g</span>(x_values) <span class="sc">/</span> <span class="fu">f2</span>(x_values)</span>
<span id="cb40-26"><a href="#cb40-26" tabindex="-1"></a>y_f3 <span class="ot">&lt;-</span> <span class="fu">g</span>(x_values) <span class="sc">/</span> <span class="fu">f3</span>(x_values)</span>
<span id="cb40-27"><a href="#cb40-27" tabindex="-1"></a></span>
<span id="cb40-28"><a href="#cb40-28" tabindex="-1"></a><span class="co"># 绘图</span></span>
<span id="cb40-29"><a href="#cb40-29" tabindex="-1"></a><span class="fu">plot</span>(x_values, y_f1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>),<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(<span class="fu">c</span>(y_f1, y_f2, y_f3))),</span>
<span id="cb40-30"><a href="#cb40-30" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;g(x) / f(x)&quot;</span>, <span class="at">main =</span> <span class="st">&quot;g(x) / f(x) for f1, f2, f3 Distributions&quot;</span>)</span>
<span id="cb40-31"><a href="#cb40-31" tabindex="-1"></a><span class="fu">lines</span>(x_values, y_f2, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb40-32"><a href="#cb40-32" tabindex="-1"></a><span class="fu">lines</span>(x_values, y_f3, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb40-33"><a href="#cb40-33" tabindex="-1"></a></span>
<span id="cb40-34"><a href="#cb40-34" tabindex="-1"></a><span class="co"># 添加图例</span></span>
<span id="cb40-35"><a href="#cb40-35" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Normal Distribution g(x) / f1(x)&quot;</span>, <span class="st">&quot; Exponential Distribution g(x) / f2(x)&quot;</span>, <span class="st">&quot; Rayleigh Distribution g(x) / f3(x)&quot;</span>),</span>
<span id="cb40-36"><a href="#cb40-36" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>接近常数的程度：<span class="math inline">\(g(x)/f_3(x)&gt;g(x)/f_2(x)&gt;g(x)/f_1(x)\)</span>，所以表现：<span class="math inline">\(f_3&gt;f_2&gt;f_1\)</span>。</p>
</div>
</div>
<div id="ppt上练习" class="section level4">
<h4>ppt上练习</h4>
<p><strong>Monte Carlo 实验</strong></p>
<p><strong>对于</strong> <span class="math inline">\(n = 10^4, 2 \times
10^4, 4 \times 10^4, 6 \times 10^4, 8 \times
10^4\)</span>，对随机排列的数字 <span class="math inline">\(1, \dots,
n\)</span> 应用快速排序算法。<br />
计算 100 次模拟的平均计算时间，记为 <span class="math inline">\(a_n\)</span>。<br />
对 <span class="math inline">\(t_n := n \log(n)\)</span> 回归 <span class="math inline">\(a_n\)</span>，并以图形显示结果（散点图和回归线）。</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a><span class="co"># 定义要测试的n值</span></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>n_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">2</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">4</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">6</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">8</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)</span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a><span class="co"># 存储每个n的平均计算时间</span></span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a>avg_times <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n_values))</span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a><span class="co"># 进行模拟，测试每个n的排序时间</span></span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(n_values)) {</span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a>  n <span class="ot">&lt;-</span> n_values[i]</span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a>  times <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)  <span class="co"># 存储100次模拟的时间</span></span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a>  </span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a>  <span class="co"># 对每个n进行100次排序模拟</span></span>
<span id="cb41-15"><a href="#cb41-15" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb41-16"><a href="#cb41-16" tabindex="-1"></a>    vec <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, n)  <span class="co"># 生成1到n的随机排列</span></span>
<span id="cb41-17"><a href="#cb41-17" tabindex="-1"></a>    times[j] <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="fu">sort</span>(vec, <span class="at">method =</span> <span class="st">&quot;quick&quot;</span>))[<span class="dv">3</span>]  <span class="co"># 记录排序时间</span></span>
<span id="cb41-18"><a href="#cb41-18" tabindex="-1"></a>  }</span>
<span id="cb41-19"><a href="#cb41-19" tabindex="-1"></a>  </span>
<span id="cb41-20"><a href="#cb41-20" tabindex="-1"></a>  avg_times[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(times)  <span class="co"># 计算平均时间</span></span>
<span id="cb41-21"><a href="#cb41-21" tabindex="-1"></a>}</span>
<span id="cb41-22"><a href="#cb41-22" tabindex="-1"></a></span>
<span id="cb41-23"><a href="#cb41-23" tabindex="-1"></a><span class="co"># 计算 t_n = n * log(n)</span></span>
<span id="cb41-24"><a href="#cb41-24" tabindex="-1"></a>log_n_values <span class="ot">&lt;-</span> n_values <span class="sc">*</span> <span class="fu">log</span>(n_values)</span>
<span id="cb41-25"><a href="#cb41-25" tabindex="-1"></a></span>
<span id="cb41-26"><a href="#cb41-26" tabindex="-1"></a><span class="co"># 回归分析: avg_times 作为因变量，log_n_values 作为自变量</span></span>
<span id="cb41-27"><a href="#cb41-27" tabindex="-1"></a>regression <span class="ot">&lt;-</span> <span class="fu">lm</span>(avg_times <span class="sc">~</span> log_n_values)</span>
<span id="cb41-28"><a href="#cb41-28" tabindex="-1"></a></span>
<span id="cb41-29"><a href="#cb41-29" tabindex="-1"></a><span class="co"># 打印回归结果</span></span>
<span id="cb41-30"><a href="#cb41-30" tabindex="-1"></a><span class="fu">summary</span>(regression)</span>
<span id="cb41-31"><a href="#cb41-31" tabindex="-1"></a></span>
<span id="cb41-32"><a href="#cb41-32" tabindex="-1"></a><span class="co"># 绘图：散点图和回归线</span></span>
<span id="cb41-33"><a href="#cb41-33" tabindex="-1"></a><span class="fu">plot</span>(log_n_values, avg_times, <span class="at">main =</span> <span class="st">&quot;Sorting Time vs n * log(n)&quot;</span>,</span>
<span id="cb41-34"><a href="#cb41-34" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;n * log(n)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Average Sorting Time (seconds)&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb41-35"><a href="#cb41-35" tabindex="-1"></a><span class="fu">abline</span>(regression, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)  <span class="co"># 添加回归线</span></span></code></pre></div>
<p>从结果来看，如果直接采用sort()函数中自带的快速排序法，得到的拟合并不能直观的看出是线性的，于是我决定改为自己编写快速排序函数，结果如下：</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a><span class="co"># 定义要测试的n值</span></span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a>n_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">2</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">4</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">6</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">8</span> <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)</span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a><span class="co"># 存储每个n的平均计算时间</span></span>
<span id="cb42-7"><a href="#cb42-7" tabindex="-1"></a>avg_times <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n_values))</span>
<span id="cb42-8"><a href="#cb42-8" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" tabindex="-1"></a><span class="co"># 定义快速排序算法</span></span>
<span id="cb42-10"><a href="#cb42-10" tabindex="-1"></a>quick_sort <span class="ot">&lt;-</span> <span class="cf">function</span>(vec) {</span>
<span id="cb42-11"><a href="#cb42-11" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(vec) <span class="sc">&lt;=</span> <span class="dv">1</span>) {</span>
<span id="cb42-12"><a href="#cb42-12" tabindex="-1"></a>    <span class="fu">return</span>(vec)  <span class="co"># 如果只有一个元素或空，直接返回</span></span>
<span id="cb42-13"><a href="#cb42-13" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb42-14"><a href="#cb42-14" tabindex="-1"></a>    pivot <span class="ot">&lt;-</span> vec[<span class="dv">1</span>]  <span class="co"># 选择第一个元素作为主元</span></span>
<span id="cb42-15"><a href="#cb42-15" tabindex="-1"></a>    left <span class="ot">&lt;-</span> <span class="fu">quick_sort</span>(vec[vec <span class="sc">&lt;</span> pivot])  <span class="co"># 小于主元的部分递归排序</span></span>
<span id="cb42-16"><a href="#cb42-16" tabindex="-1"></a>    right <span class="ot">&lt;-</span> <span class="fu">quick_sort</span>(vec[vec <span class="sc">&gt;</span> pivot])  <span class="co"># 大于主元的部分递归排序</span></span>
<span id="cb42-17"><a href="#cb42-17" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(left, vec[vec <span class="sc">==</span> pivot], right))  <span class="co"># 连接结果</span></span>
<span id="cb42-18"><a href="#cb42-18" tabindex="-1"></a>  }</span>
<span id="cb42-19"><a href="#cb42-19" tabindex="-1"></a>}</span>
<span id="cb42-20"><a href="#cb42-20" tabindex="-1"></a></span>
<span id="cb42-21"><a href="#cb42-21" tabindex="-1"></a><span class="co"># 进行模拟，测试每个n的排序时间</span></span>
<span id="cb42-22"><a href="#cb42-22" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(n_values)) {</span>
<span id="cb42-23"><a href="#cb42-23" tabindex="-1"></a>  n <span class="ot">&lt;-</span> n_values[i]</span>
<span id="cb42-24"><a href="#cb42-24" tabindex="-1"></a>  times <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)  <span class="co"># 存储100次模拟的时间</span></span>
<span id="cb42-25"><a href="#cb42-25" tabindex="-1"></a>  </span>
<span id="cb42-26"><a href="#cb42-26" tabindex="-1"></a>  <span class="co"># 对每个n进行100次排序模拟</span></span>
<span id="cb42-27"><a href="#cb42-27" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb42-28"><a href="#cb42-28" tabindex="-1"></a>    vec <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, n)  <span class="co"># 生成1到n的随机排列</span></span>
<span id="cb42-29"><a href="#cb42-29" tabindex="-1"></a>    times[j] <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="fu">quick_sort</span>(vec))[<span class="dv">3</span>]  <span class="co"># 使用手写快速排序，并记录排序时间</span></span>
<span id="cb42-30"><a href="#cb42-30" tabindex="-1"></a>  }</span>
<span id="cb42-31"><a href="#cb42-31" tabindex="-1"></a>  </span>
<span id="cb42-32"><a href="#cb42-32" tabindex="-1"></a>  avg_times[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(times)  <span class="co"># 计算平均时间</span></span>
<span id="cb42-33"><a href="#cb42-33" tabindex="-1"></a>}</span>
<span id="cb42-34"><a href="#cb42-34" tabindex="-1"></a></span>
<span id="cb42-35"><a href="#cb42-35" tabindex="-1"></a><span class="co"># 计算 t_n = n * log(n)</span></span>
<span id="cb42-36"><a href="#cb42-36" tabindex="-1"></a>log_n_values <span class="ot">&lt;-</span> n_values <span class="sc">*</span> <span class="fu">log</span>(n_values)</span>
<span id="cb42-37"><a href="#cb42-37" tabindex="-1"></a></span>
<span id="cb42-38"><a href="#cb42-38" tabindex="-1"></a><span class="co"># 回归分析: avg_times 作为因变量，log_n_values 作为自变量</span></span>
<span id="cb42-39"><a href="#cb42-39" tabindex="-1"></a>regression <span class="ot">&lt;-</span> <span class="fu">lm</span>(avg_times <span class="sc">~</span> log_n_values)</span>
<span id="cb42-40"><a href="#cb42-40" tabindex="-1"></a></span>
<span id="cb42-41"><a href="#cb42-41" tabindex="-1"></a><span class="co"># 打印回归结果</span></span>
<span id="cb42-42"><a href="#cb42-42" tabindex="-1"></a><span class="fu">summary</span>(regression)</span>
<span id="cb42-43"><a href="#cb42-43" tabindex="-1"></a></span>
<span id="cb42-44"><a href="#cb42-44" tabindex="-1"></a><span class="co"># 绘图：散点图和回归线</span></span>
<span id="cb42-45"><a href="#cb42-45" tabindex="-1"></a><span class="fu">plot</span>(log_n_values, avg_times, <span class="at">main =</span> <span class="st">&quot;Sorting Time vs n * log(n)&quot;</span>,</span>
<span id="cb42-46"><a href="#cb42-46" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;n * log(n)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Average Sorting Time (seconds)&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb42-47"><a href="#cb42-47" tabindex="-1"></a><span class="fu">abline</span>(regression, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)  <span class="co"># 添加回归线</span></span></code></pre></div>
<p>从这个结果就能看出很好的线性关系，推测可能是sort()函数中的快速排序法在运算复杂度方面进行了某些优化（从运算时间上可以看出sort()函数中的快速排序法比自己编写的快速排序函数运行时间更快），采用自己编写的快速排序函数就能很好的看出快排的平均时间复杂度是<span class="math inline">\(O(nlogn)\)</span>。</p>
</div>
</div>
<div id="homework-4" class="section level3">
<h3>Homework-4</h3>
<div id="作业说明" class="section level4">
<h4>作业说明</h4>
<p>在课堂上，老师对这次作业提出了一些要求，具体如下：</p>
<p><strong>复杂模拟研究的建议：</strong><br />
- 在复杂的模拟研究中，至少使用三个独立的函数： -
<strong>数据生成</strong>； -
<strong>统计推断（准备用于真实数据分析）</strong>； -
<strong>结果报告</strong>。</p>
<p><strong>作业评分标准（针对助教）：</strong> -
检查是否有至少三个独立的函数（否则扣 1 分）。 -
检查是否在调用每个函数之前清理了内存（否则再扣 1 分）。</p>
<p>在这里，我采用</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>来清除所有变量。</p>
</div>
<div id="练习6.6" class="section level4">
<h4>练习6.6</h4>
<p><strong>题目：</strong>通过蒙特卡洛实验估计在正态分布下偏度 <span class="math inline">\(\sqrt{b_1}\)</span> 的 0.025、0.05、0.95 和 0.975
分位数。使用密度的正态近似（带有精确方差公式），根据公式 (2.14)
计算这些估计值的标准误差。将估计的分位数与大样本近似 <span class="math inline">\(\sqrt{b_1} \approx N(0, 6/n)\)</span>
的分位数进行比较。</p>
<p>这里我们给出公式(2.14) <span class="math display">\[
\text{Var}(\hat{x}_q) = \frac{q(1-q)}{n f(x_q)^2},
\]</span> 由此公式可以计算分位数标准误差，具体代码如下：</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="co"># 第一个函数：数据生成</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>generate_data <span class="ot">&lt;-</span> <span class="cf">function</span>(m, n) {</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>  <span class="co"># 偏度函数</span></span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>  sk <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>    x_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">mean</span>((x <span class="sc">-</span> x_bar)<span class="sc">^</span><span class="dv">3</span>) <span class="sc">/</span> (<span class="fu">mean</span>((x <span class="sc">-</span> x_bar)<span class="sc">^</span><span class="dv">2</span>))<span class="sc">^</span><span class="fl">1.5</span></span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>    <span class="fu">return</span>(b)</span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a>  }</span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a>  </span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb44-13"><a href="#cb44-13" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb44-14"><a href="#cb44-14" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb44-15"><a href="#cb44-15" tabindex="-1"></a>    b[i] <span class="ot">&lt;-</span> <span class="fu">sk</span>(X)</span>
<span id="cb44-16"><a href="#cb44-16" tabindex="-1"></a>  }</span>
<span id="cb44-17"><a href="#cb44-17" tabindex="-1"></a></span>
<span id="cb44-18"><a href="#cb44-18" tabindex="-1"></a>  <span class="co"># 返回排序后的b值</span></span>
<span id="cb44-19"><a href="#cb44-19" tabindex="-1"></a>  b_order <span class="ot">&lt;-</span> <span class="fu">sort</span>(b)</span>
<span id="cb44-20"><a href="#cb44-20" tabindex="-1"></a>  </span>
<span id="cb44-21"><a href="#cb44-21" tabindex="-1"></a>  <span class="co"># 内存清理（确保返回的数据不会丢失）</span></span>
<span id="cb44-22"><a href="#cb44-22" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">setdiff</span>(<span class="fu">ls</span>(), <span class="st">&quot;b_order&quot;</span>))</span>
<span id="cb44-23"><a href="#cb44-23" tabindex="-1"></a>  </span>
<span id="cb44-24"><a href="#cb44-24" tabindex="-1"></a>  <span class="fu">return</span>(b_order)</span>
<span id="cb44-25"><a href="#cb44-25" tabindex="-1"></a>}</span>
<span id="cb44-26"><a href="#cb44-26" tabindex="-1"></a></span>
<span id="cb44-27"><a href="#cb44-27" tabindex="-1"></a><span class="co"># 第二个函数：统计推断</span></span>
<span id="cb44-28"><a href="#cb44-28" tabindex="-1"></a>statistical_inference <span class="ot">&lt;-</span> <span class="cf">function</span>(b_order, n) {</span>
<span id="cb44-29"><a href="#cb44-29" tabindex="-1"></a>  </span>
<span id="cb44-30"><a href="#cb44-30" tabindex="-1"></a>  <span class="co"># 分位数计算</span></span>
<span id="cb44-31"><a href="#cb44-31" tabindex="-1"></a>  qutile <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb44-32"><a href="#cb44-32" tabindex="-1"></a>  qutile[<span class="dv">1</span>] <span class="ot">&lt;-</span> b_order[<span class="dv">25</span>]   <span class="co"># 0.025 分位数</span></span>
<span id="cb44-33"><a href="#cb44-33" tabindex="-1"></a>  qutile[<span class="dv">2</span>] <span class="ot">&lt;-</span> b_order[<span class="dv">50</span>]   <span class="co"># 0.05 分位数</span></span>
<span id="cb44-34"><a href="#cb44-34" tabindex="-1"></a>  qutile[<span class="dv">3</span>] <span class="ot">&lt;-</span> b_order[<span class="dv">950</span>]  <span class="co"># 0.95 分位数</span></span>
<span id="cb44-35"><a href="#cb44-35" tabindex="-1"></a>  qutile[<span class="dv">4</span>] <span class="ot">&lt;-</span> b_order[<span class="dv">975</span>]  <span class="co"># 0.975 分位数</span></span>
<span id="cb44-36"><a href="#cb44-36" tabindex="-1"></a></span>
<span id="cb44-37"><a href="#cb44-37" tabindex="-1"></a>  <span class="co"># 渐进分布密度函数</span></span>
<span id="cb44-38"><a href="#cb44-38" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, n) {</span>
<span id="cb44-39"><a href="#cb44-39" tabindex="-1"></a>    <span class="fu">return</span>((<span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="dv">6</span> <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">/</span> ((n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> (n <span class="sc">+</span> <span class="dv">3</span>)))) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="dv">6</span> <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">/</span> ((n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> (n <span class="sc">+</span> <span class="dv">3</span>)))))</span>
<span id="cb44-40"><a href="#cb44-40" tabindex="-1"></a>  }</span>
<span id="cb44-41"><a href="#cb44-41" tabindex="-1"></a></span>
<span id="cb44-42"><a href="#cb44-42" tabindex="-1"></a>  <span class="co"># 分位数标准误差计算</span></span>
<span id="cb44-43"><a href="#cb44-43" tabindex="-1"></a>  sd_qutile <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb44-44"><a href="#cb44-44" tabindex="-1"></a>  sd_qutile[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.025</span> <span class="sc">*</span> <span class="fl">0.975</span> <span class="sc">/</span> (n <span class="sc">*</span> (<span class="fu">f</span>(qutile[<span class="dv">1</span>], n))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb44-45"><a href="#cb44-45" tabindex="-1"></a>  sd_qutile[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span> <span class="sc">*</span> <span class="fl">0.95</span> <span class="sc">/</span> (n <span class="sc">*</span> (<span class="fu">f</span>(qutile[<span class="dv">2</span>], n))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb44-46"><a href="#cb44-46" tabindex="-1"></a>  sd_qutile[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fl">0.05</span> <span class="sc">*</span> <span class="fl">0.95</span> <span class="sc">/</span> (n <span class="sc">*</span> (<span class="fu">f</span>(qutile[<span class="dv">3</span>], n))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb44-47"><a href="#cb44-47" tabindex="-1"></a>  sd_qutile[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fl">0.025</span> <span class="sc">*</span> <span class="fl">0.975</span> <span class="sc">/</span> (n <span class="sc">*</span> (<span class="fu">f</span>(qutile[<span class="dv">4</span>], n))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb44-48"><a href="#cb44-48" tabindex="-1"></a></span>
<span id="cb44-49"><a href="#cb44-49" tabindex="-1"></a>  <span class="co"># 渐近分位数计算</span></span>
<span id="cb44-50"><a href="#cb44-50" tabindex="-1"></a>  cv <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb44-51"><a href="#cb44-51" tabindex="-1"></a>  cv[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.025</span>, <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="dv">6</span> <span class="sc">/</span> n))</span>
<span id="cb44-52"><a href="#cb44-52" tabindex="-1"></a>  cv[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.05</span>, <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="dv">6</span> <span class="sc">/</span> n))</span>
<span id="cb44-53"><a href="#cb44-53" tabindex="-1"></a>  cv[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.95</span>, <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="dv">6</span> <span class="sc">/</span> n))</span>
<span id="cb44-54"><a href="#cb44-54" tabindex="-1"></a>  cv[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>, <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="dv">6</span> <span class="sc">/</span> n))</span>
<span id="cb44-55"><a href="#cb44-55" tabindex="-1"></a></span>
<span id="cb44-56"><a href="#cb44-56" tabindex="-1"></a>  <span class="co"># 返回所有计算结果</span></span>
<span id="cb44-57"><a href="#cb44-57" tabindex="-1"></a>  inference_results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">qutile =</span> qutile, <span class="at">sd_qutile =</span> sd_qutile, <span class="at">cv =</span> cv)</span>
<span id="cb44-58"><a href="#cb44-58" tabindex="-1"></a>  </span>
<span id="cb44-59"><a href="#cb44-59" tabindex="-1"></a>  <span class="co"># 内存清理（保留 inference_results）</span></span>
<span id="cb44-60"><a href="#cb44-60" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">setdiff</span>(<span class="fu">ls</span>(), <span class="st">&quot;inference_results&quot;</span>))</span>
<span id="cb44-61"><a href="#cb44-61" tabindex="-1"></a>  </span>
<span id="cb44-62"><a href="#cb44-62" tabindex="-1"></a>  <span class="fu">return</span>(inference_results)</span>
<span id="cb44-63"><a href="#cb44-63" tabindex="-1"></a>}</span>
<span id="cb44-64"><a href="#cb44-64" tabindex="-1"></a></span>
<span id="cb44-65"><a href="#cb44-65" tabindex="-1"></a><span class="co"># 第三个函数：结果报告</span></span>
<span id="cb44-66"><a href="#cb44-66" tabindex="-1"></a>report_results <span class="ot">&lt;-</span> <span class="cf">function</span>(inference_results) {</span>
<span id="cb44-67"><a href="#cb44-67" tabindex="-1"></a></span>
<span id="cb44-68"><a href="#cb44-68" tabindex="-1"></a>  <span class="co"># 生成结果数据框</span></span>
<span id="cb44-69"><a href="#cb44-69" tabindex="-1"></a>  outcome <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb44-70"><a href="#cb44-70" tabindex="-1"></a>    <span class="at">Estimate =</span> <span class="fu">c</span>(<span class="st">&quot;0.025 分位数&quot;</span>, <span class="st">&quot;0.05 分位数&quot;</span>, <span class="st">&quot;0.95 分位数&quot;</span>, <span class="st">&quot;0.975 分位数&quot;</span>),</span>
<span id="cb44-71"><a href="#cb44-71" tabindex="-1"></a>    <span class="at">MC_es =</span> inference_results<span class="sc">$</span>qutile,</span>
<span id="cb44-72"><a href="#cb44-72" tabindex="-1"></a>    <span class="at">asymptotic =</span> inference_results<span class="sc">$</span>cv,</span>
<span id="cb44-73"><a href="#cb44-73" tabindex="-1"></a>    <span class="at">MC_es_sd =</span> inference_results<span class="sc">$</span>sd_qutile</span>
<span id="cb44-74"><a href="#cb44-74" tabindex="-1"></a>  )</span>
<span id="cb44-75"><a href="#cb44-75" tabindex="-1"></a></span>
<span id="cb44-76"><a href="#cb44-76" tabindex="-1"></a>  <span class="co"># 展示结果</span></span>
<span id="cb44-77"><a href="#cb44-77" tabindex="-1"></a>  <span class="fu">print</span>(outcome)</span>
<span id="cb44-78"><a href="#cb44-78" tabindex="-1"></a>  </span>
<span id="cb44-79"><a href="#cb44-79" tabindex="-1"></a>  <span class="co"># 内存清理</span></span>
<span id="cb44-80"><a href="#cb44-80" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb44-81"><a href="#cb44-81" tabindex="-1"></a>}</span>
<span id="cb44-82"><a href="#cb44-82" tabindex="-1"></a></span>
<span id="cb44-83"><a href="#cb44-83" tabindex="-1"></a><span class="co"># 主程序：依次调用三个函数</span></span>
<span id="cb44-84"><a href="#cb44-84" tabindex="-1"></a>main <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb44-85"><a href="#cb44-85" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb44-86"><a href="#cb44-86" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb44-87"><a href="#cb44-87" tabindex="-1"></a></span>
<span id="cb44-88"><a href="#cb44-88" tabindex="-1"></a>  <span class="co"># 1. 数据生成</span></span>
<span id="cb44-89"><a href="#cb44-89" tabindex="-1"></a>  b_order <span class="ot">&lt;-</span> <span class="fu">generate_data</span>(m, n)</span>
<span id="cb44-90"><a href="#cb44-90" tabindex="-1"></a>  </span>
<span id="cb44-91"><a href="#cb44-91" tabindex="-1"></a>  <span class="co"># 2. 统计推断</span></span>
<span id="cb44-92"><a href="#cb44-92" tabindex="-1"></a>  inference_results <span class="ot">&lt;-</span> <span class="fu">statistical_inference</span>(b_order, n)</span>
<span id="cb44-93"><a href="#cb44-93" tabindex="-1"></a>  </span>
<span id="cb44-94"><a href="#cb44-94" tabindex="-1"></a>  <span class="co"># 3. 结果报告</span></span>
<span id="cb44-95"><a href="#cb44-95" tabindex="-1"></a>  <span class="fu">report_results</span>(inference_results)</span>
<span id="cb44-96"><a href="#cb44-96" tabindex="-1"></a>}</span>
<span id="cb44-97"><a href="#cb44-97" tabindex="-1"></a></span>
<span id="cb44-98"><a href="#cb44-98" tabindex="-1"></a><span class="co"># 执行主程序</span></span>
<span id="cb44-99"><a href="#cb44-99" tabindex="-1"></a><span class="fu">main</span>()</span></code></pre></div>
<pre><code>##       Estimate      MC_es asymptotic     MC_es_sd
## 1 0.025 分位数 -0.1521795 -0.1518182 4.436388e-05
## 2  0.05 分位数 -0.1317545 -0.1274098 3.269513e-05
## 3  0.95 分位数  0.1391543  0.1274098 4.575709e-05
## 4 0.975 分位数  0.1651270  0.1518182 8.834638e-05</code></pre>
<p>可以看到，估计结果与渐进表现的结果十分相近，且蒙特卡洛估计分位数的标准误差也很小。</p>
</div>
<div id="练习6.b" class="section level4">
<h4>练习6.B</h4>
<p><strong>题目：</strong> 基于皮尔逊积矩相关系数 <span class="math inline">\(\rho\)</span>、斯皮尔曼等级相关系数 <span class="math inline">\(\rho_s\)</span> 或肯德尔系数 <span class="math inline">\(\tau\)</span> 的关联检验已在 cor.test
函数中实现。通过实证展示，当样本分布为双变量正态分布时，基于 <span class="math inline">\(\rho_s\)</span> 或 <span class="math inline">\(\tau\)</span>
的非参数检验比相关性检验的统计功效更低。找到一个备选方案（一个 <span class="math inline">\((X, Y)\)</span> 的双变量分布，使得 <span class="math inline">\(X\)</span> 和 <span class="math inline">\(Y\)</span>
是相依的），该方案下至少有一个非参数检验在与该备选方案的比较中表现出比相关性检验更高的功效。</p>
<p><strong>想法：</strong>相较于另外两个相关系数，皮尔逊相关系数对数据条件的要求更为严格，一般来说，皮尔逊相关系数对数据条件要求如下：</p>
<p>(1)、两个变量之间是线性关系，都是连续数据。</p>
<p>(2)、两个变量的总体是正态分布，或接近正态的单峰分布。</p>
<p>(3)、两个变量的观测值是成对的，每对观测值之间相互独立。</p>
<p>因此，我思考选择一个分布，使得 <span class="math inline">\(X\)</span>
和 <span class="math inline">\(Y\)</span>
之间的关系不再是简单的线性关系，而是可以通过非线性或其他复杂的关系进行关联。</p>
<p>这里我选择了： <span class="math inline">\(X \sim N(\mu_X,
\sigma_X^2)\)</span>， <span class="math inline">\(Y = e^x-3x +
\epsilon\)</span>，而 <span class="math inline">\(\epsilon \sim N(0,
\sigma_\epsilon^2)\)</span> 是一个独立的随机误差项。</p>
<p>这种构造的好处在于，即使 <span class="math inline">\(X\)</span> 和
<span class="math inline">\(Y\)</span>
之间存在非线性关系，斯皮尔曼和肯德尔的非参数检验仍能有效捕捉到这种依赖关系，而皮尔逊相关系数则可能低估或完全忽略这种关系。</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="co"># 定义 x 的范围</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">400</span>)</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a><span class="co"># 计算 y = exp(x) - 3*x</span></span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">exp</span>(x) <span class="sc">-</span> <span class="dv">3</span><span class="sc">*</span>x</span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a><span class="co"># 绘制图像</span></span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb46-9"><a href="#cb46-9" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Plot of &quot;</span>, e<span class="sc">^</span>x <span class="sc">-</span> <span class="dv">3</span><span class="sc">*</span>x)),</span>
<span id="cb46-10"><a href="#cb46-10" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>)</span>
<span id="cb46-11"><a href="#cb46-11" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">v =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)  <span class="co"># 添加 x 和 y 轴</span></span>
<span id="cb46-12"><a href="#cb46-12" tabindex="-1"></a><span class="fu">grid</span>()  <span class="co"># 显示网格</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a><span class="co"># 定义功效计算函数</span></span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>calculate_power <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">cor_method =</span> <span class="st">&quot;pearson&quot;</span>, <span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>) {</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a>  reject_null <span class="ot">&lt;-</span> <span class="fu">numeric</span>(reps)  <span class="co"># 存储是否拒绝原假设的结果</span></span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a>  </span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>reps) {</span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a>    <span class="co"># 生成非线性相关数据（作为备择假设）</span></span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a>    sigma <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">exp</span>(x)<span class="sc">-</span><span class="dv">3</span><span class="sc">*</span>x<span class="sc">+</span>sigma</span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a>    </span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a>    <span class="co"># 根据选择的检验方法计算相关性</span></span>
<span id="cb47-14"><a href="#cb47-14" tabindex="-1"></a>    <span class="cf">if</span> (cor_method <span class="sc">==</span> <span class="st">&quot;pearson&quot;</span>) {</span>
<span id="cb47-15"><a href="#cb47-15" tabindex="-1"></a>      test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb47-16"><a href="#cb47-16" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (cor_method <span class="sc">==</span> <span class="st">&quot;kendall&quot;</span>) {</span>
<span id="cb47-17"><a href="#cb47-17" tabindex="-1"></a>      test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span>
<span id="cb47-18"><a href="#cb47-18" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (cor_method <span class="sc">==</span> <span class="st">&quot;spearman&quot;</span>) {</span>
<span id="cb47-19"><a href="#cb47-19" tabindex="-1"></a>      test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb47-20"><a href="#cb47-20" tabindex="-1"></a>    }</span>
<span id="cb47-21"><a href="#cb47-21" tabindex="-1"></a>    </span>
<span id="cb47-22"><a href="#cb47-22" tabindex="-1"></a>    <span class="co"># 如果 p 值小于显著性水平 alpha，拒绝原假设</span></span>
<span id="cb47-23"><a href="#cb47-23" tabindex="-1"></a>    reject_null[i] <span class="ot">&lt;-</span> test<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha</span>
<span id="cb47-24"><a href="#cb47-24" tabindex="-1"></a>  }</span>
<span id="cb47-25"><a href="#cb47-25" tabindex="-1"></a>  </span>
<span id="cb47-26"><a href="#cb47-26" tabindex="-1"></a>  <span class="co"># 计算功效，即拒绝原假设的频率</span></span>
<span id="cb47-27"><a href="#cb47-27" tabindex="-1"></a>  power <span class="ot">&lt;-</span> <span class="fu">mean</span>(reject_null)</span>
<span id="cb47-28"><a href="#cb47-28" tabindex="-1"></a>  <span class="fu">return</span>(power)</span>
<span id="cb47-29"><a href="#cb47-29" tabindex="-1"></a>}</span>
<span id="cb47-30"><a href="#cb47-30" tabindex="-1"></a></span>
<span id="cb47-31"><a href="#cb47-31" tabindex="-1"></a><span class="co"># 计算不同检验方法的功效</span></span>
<span id="cb47-32"><a href="#cb47-32" tabindex="-1"></a>pearson_power <span class="ot">&lt;-</span> <span class="fu">calculate_power</span>(<span class="at">cor_method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb47-33"><a href="#cb47-33" tabindex="-1"></a>kendall_power <span class="ot">&lt;-</span> <span class="fu">calculate_power</span>(<span class="at">cor_method =</span> <span class="st">&quot;kendall&quot;</span>)</span>
<span id="cb47-34"><a href="#cb47-34" tabindex="-1"></a>spearman_power <span class="ot">&lt;-</span> <span class="fu">calculate_power</span>(<span class="at">cor_method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb47-35"><a href="#cb47-35" tabindex="-1"></a></span>
<span id="cb47-36"><a href="#cb47-36" tabindex="-1"></a><span class="co"># 打印功效</span></span>
<span id="cb47-37"><a href="#cb47-37" tabindex="-1"></a>pearson_power  <span class="co"># Pearson 的功效</span></span></code></pre></div>
<pre><code>## [1] 0.906</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a>kendall_power  <span class="co"># Kendall 的功效</span></span></code></pre></div>
<pre><code>## [1] 0.992</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a>spearman_power  <span class="co"># Spearman 的功效</span></span></code></pre></div>
<pre><code>## [1] 0.979</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span></code></pre></div>
<p>可以看到kendall功效和Spearman 功效均大于Pearson 功效</p>
</div>
<div id="ppt上作业" class="section level4">
<h4>ppt上作业</h4>
<p><strong>题目：</strong> 如果我们在特定的模拟设置下进行 10,000
次实验，得到两种方法的功效分别为 0.651 和
0.676。我们想知道这两种方法的功效在 0.05
的显著性水平下是否存在差异。</p>
<div id="对应的假设检验问题是什么" class="section level5">
<h5>1. <strong>对应的假设检验问题是什么？</strong></h5>
<p>在比较两种方法的功效时，我们可以提出以下假设：</p>
<p><strong>原假设（</strong><span class="math inline">\(H_0\)</span>）：两种方法的功效是相同的，即 <span class="math inline">\(p_1 = p_2\)</span>，其中 <span class="math inline">\(p_1\)</span> 和 <span class="math inline">\(p_2\)</span> 分别代表两种方法的功效。</p>
<p><strong>备择假设（</strong><span class="math inline">\(H_A\)</span>）：两种方法的功效是不同的，即 <span class="math inline">\(p_1 \neq
p_2\)</span>。这意味着至少有一种方法的功效显著优于另一种方法，或者两者的效果有显著差异。</p>
</div>
<div id="应该使用什么检验z-检验两样本-t-检验配对-t-检验还是-mcnemar-检验为什么" class="section level5">
<h5>2. <strong>应该使用什么检验？Z 检验、两样本 t 检验、配对 t 检验还是
McNemar 检验？为什么？</strong></h5>
<p>在这个问题中，我们关注的是两种方法在相同实验条件下的功效。由于这两个样本是通过相同实验模型生成的，因此它们之间存在关联性。针对这一情况，配对
t 检验是更为合适的选择。原因如下：</p>
<ul>
<li><p><strong>配对 t
检验</strong>：适用于比较来自同一组实验的配对数据。由于我们是在相同条件下测量两种方法的功效，因此样本间的观测值是相关的。使用配对
t
检验可以有效控制由于样本间差异引入的误差，使得功效的比较更具准确性。</p></li>
<li><p><strong>其他检验方法</strong>：</p>
<ul>
<li><strong>Z
检验</strong>：通常用于大样本情况下的独立样本比较，但由于我们的样本是配对的，因此不适用。</li>
<li><strong>两样本 t
检验</strong>：适合于比较两个独立样本的均值，但在这里样本是成对的。</li>
<li><strong>McNemar
检验</strong>：通常用于比较配对数据中两个类别的变化，不适用于功效的比较。</li>
</ul></li>
</ul>
</div>
<div id="假设检验所需的最少信息是什么" class="section level5">
<h5>3. <strong>假设检验所需的最少信息是什么？</strong></h5>
<p>进行假设检验时，我们至少需要以下信息：</p>
<ul>
<li><p><strong>样本大小（n）</strong>：样本的重复次数，即进行蒙特卡洛模拟的次数。</p></li>
<li><p><strong>两个方法的功效（p1 和
p2）</strong>：通过蒙特卡洛试验得到的功效数据，记作 <span class="math inline">\(\{p_{1i}, p_{2i}\}\)</span> 其中 <span class="math inline">\(i = 1, 2, \ldots, n\)</span>，分别代表第 <span class="math inline">\(i\)</span> 次试验中两种方法的功效值。</p></li>
<li><p><strong>显著性水平（</strong><span class="math inline">\(\alpha\)</span>）：设定的显著性水平，用于判断原假设是否被拒绝。在这个例子中，显著性水平设定为
0.05。</p></li>
</ul>
</div>
</div>
</div>
<div id="homework-5" class="section level3">
<h3>Homework-5</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span></code></pre></div>
<div id="练习一-1" class="section level4">
<h4><strong>练习一</strong></h4>
<p>在 <span class="math inline">\(N = 1000\)</span> 个假设中，950
个为原假设，50 个为备择假设。任一原假设下的 p 值服从均匀分布（使用
<code>runif</code>），任一备择假设下的 p 值服从参数为 0.1 和 1
的贝塔分布（使用 <code>rbeta</code>）。计算 Bonferroni 校正 p 值和 B-H
校正 p 值。在名义显著水平 <span class="math inline">\(\alpha =
0.1\)</span> 下，基于两种调整方法，计算 FWER、FDR 和 TPR，并基于 <span class="math inline">\(m = 10000\)</span> 次模拟重复输出这 6 个值（即
FWER、FDR 和 TPR，分别对于 Bonferroni 校正和 B-H 校正）。</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span>           <span class="co"># 假设总数</span></span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span>          <span class="co"># 模拟次数</span></span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>        <span class="co"># 显著性水平</span></span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a><span class="co"># 初始化结果存储</span></span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a>fwer_bon <span class="ot">&lt;-</span> fdr_bon <span class="ot">&lt;-</span> tpr_bon <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a>fwer_bh <span class="ot">&lt;-</span> fdr_bh <span class="ot">&lt;-</span> tpr_bh <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb55-11"><a href="#cb55-11" tabindex="-1"></a>  <span class="co"># 原假设下的p值（950个）</span></span>
<span id="cb55-12"><a href="#cb55-12" tabindex="-1"></a>  p_null <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">950</span>)</span>
<span id="cb55-13"><a href="#cb55-13" tabindex="-1"></a>  </span>
<span id="cb55-14"><a href="#cb55-14" tabindex="-1"></a>  <span class="co"># 备择假设下的p值（50个）</span></span>
<span id="cb55-15"><a href="#cb55-15" tabindex="-1"></a>  p_alt <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">50</span>, <span class="fl">0.1</span>, <span class="dv">1</span>)</span>
<span id="cb55-16"><a href="#cb55-16" tabindex="-1"></a>  </span>
<span id="cb55-17"><a href="#cb55-17" tabindex="-1"></a>  <span class="co"># 所有假设的p值</span></span>
<span id="cb55-18"><a href="#cb55-18" tabindex="-1"></a>  p_values <span class="ot">&lt;-</span> <span class="fu">c</span>(p_null, p_alt)</span>
<span id="cb55-19"><a href="#cb55-19" tabindex="-1"></a>  </span>
<span id="cb55-20"><a href="#cb55-20" tabindex="-1"></a>  <span class="co"># Bonferroni校正</span></span>
<span id="cb55-21"><a href="#cb55-21" tabindex="-1"></a>  bon_p <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb55-22"><a href="#cb55-22" tabindex="-1"></a>  reject_bon <span class="ot">&lt;-</span> bon_p <span class="sc">&lt;</span> alpha</span>
<span id="cb55-23"><a href="#cb55-23" tabindex="-1"></a>  fwer_bon[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject_bon[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]) <span class="sc">&gt;</span> <span class="dv">0</span>  <span class="co"># FWER</span></span>
<span id="cb55-24"><a href="#cb55-24" tabindex="-1"></a>  fdr_bon[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject_bon[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">sum</span>(reject_bon), <span class="dv">1</span>)  <span class="co"># FDR</span></span>
<span id="cb55-25"><a href="#cb55-25" tabindex="-1"></a>  tpr_bon[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject_bon[<span class="dv">951</span><span class="sc">:</span><span class="dv">1000</span>]) <span class="sc">/</span> <span class="dv">50</span>  <span class="co"># TPR</span></span>
<span id="cb55-26"><a href="#cb55-26" tabindex="-1"></a>  </span>
<span id="cb55-27"><a href="#cb55-27" tabindex="-1"></a>  <span class="co"># B-H校正</span></span>
<span id="cb55-28"><a href="#cb55-28" tabindex="-1"></a>  bh_p <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb55-29"><a href="#cb55-29" tabindex="-1"></a>  reject_bh <span class="ot">&lt;-</span> bh_p <span class="sc">&lt;</span> alpha</span>
<span id="cb55-30"><a href="#cb55-30" tabindex="-1"></a>  fwer_bh[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject_bh[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]) <span class="sc">&gt;</span> <span class="dv">0</span>  <span class="co"># FWER</span></span>
<span id="cb55-31"><a href="#cb55-31" tabindex="-1"></a>  fdr_bh[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject_bh[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]) <span class="sc">/</span> <span class="fu">max</span>(<span class="fu">sum</span>(reject_bh), <span class="dv">1</span>)  <span class="co"># FDR</span></span>
<span id="cb55-32"><a href="#cb55-32" tabindex="-1"></a>  tpr_bh[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(reject_bh[<span class="dv">951</span><span class="sc">:</span><span class="dv">1000</span>]) <span class="sc">/</span> <span class="dv">50</span>  <span class="co"># TPR</span></span>
<span id="cb55-33"><a href="#cb55-33" tabindex="-1"></a>}</span>
<span id="cb55-34"><a href="#cb55-34" tabindex="-1"></a></span>
<span id="cb55-35"><a href="#cb55-35" tabindex="-1"></a><span class="co"># 平均结果</span></span>
<span id="cb55-36"><a href="#cb55-36" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">mean</span>(fwer_bon), <span class="fu">mean</span>(fdr_bon), <span class="fu">mean</span>(tpr_bon),</span>
<span id="cb55-37"><a href="#cb55-37" tabindex="-1"></a>                   <span class="fu">mean</span>(fwer_bh), <span class="fu">mean</span>(fdr_bh), <span class="fu">mean</span>(tpr_bh)), </span>
<span id="cb55-38"><a href="#cb55-38" tabindex="-1"></a>                 <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>,</span>
<span id="cb55-39"><a href="#cb55-39" tabindex="-1"></a>                 <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>), </span>
<span id="cb55-40"><a href="#cb55-40" tabindex="-1"></a>                                 <span class="fu">c</span>(<span class="st">&quot;Bonferroni&quot;</span>, <span class="st">&quot;B-H&quot;</span>)))</span>
<span id="cb55-41"><a href="#cb55-41" tabindex="-1"></a><span class="fu">print</span>(result)</span>
<span id="cb55-42"><a href="#cb55-42" tabindex="-1"></a></span>
<span id="cb55-43"><a href="#cb55-43" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span></code></pre></div>
<div id="结果分析" class="section level5">
<h5>结果分析</h5>
<p><strong>Bonferroni方法</strong>是一个严格的方法，能够很好地控制假阳性（FWER），但可能会牺牲一些真正的发现（TPR），导致漏检的情况较多。</p>
<p><strong>B-H方法</strong>则更注重在多个假设检验中发现真实的效应，能够在一定程度上控制假发现率，同时提供更高的真正率。然而，这也意味着可能有较高的FWER。</p>
<p>根据研究目标，选择适合的方法。如果目标是尽量找到真正的效应，而能接受一定比例的假发现，B-H方法可能是更好的选择。如果需要严格控制假阳性率，则Bonferroni方法会更为合适。</p>
</div>
</div>
<div id="题目-7.4" class="section level4">
<h4><strong>题目 7.4：</strong></h4>
<p>参考 <strong>boot</strong> 包中的空调数据集
<strong>aircondit</strong>。12
个观测值是空调设备之间的故障间隔时间（以小时为单位）。这些观测值为：</p>
<p>3, 5, 7, 18, 43, 85, 91, 98, 100, 130, 230, 487。</p>
<p>假设故障间隔时间遵循指数分布模型 <span class="math inline">\(\text{Exp}(\lambda)\)</span>。求解故障率 <span class="math inline">\(\lambda\)</span> 的最大似然估计（MLE），并使用
bootstrap 方法估计该估计的偏差和标准误差。</p>
<p>首先我们计算<span class="math inline">\(\lambda\)</span>的极大似然估计：</p>
<p>似然函数<span class="math inline">\(l(\lambda)=\sum_{i=1}^{n}p(X=x_i|\lambda)=nln(\lambda)-\lambda\sum_{i=1}^{n}x_i\)</span></p>
<p>求导令导数等于0可得，该模型下<span class="math inline">\(\lambda\)</span>的极大似然估计为：</p>
<p><span class="math display">\[\hat{\lambda}=\frac{1}{\bar{x}},\bar{x}=\frac{1}{n}\sum_{i=1}^{n}x_i\]</span>
在求出极大似然后，我们用bootstrap方法来给出偏差和标准误差的估计：</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="co"># 载入所需包</span></span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a><span class="co"># 故障间隔时间数据</span></span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a>failure_times <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a><span class="co"># 对于指数分布 Exp(λ)，λ 的最大似然估计为 1/样本均值</span></span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a>lambda_hat <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(failure_times)</span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a><span class="co"># 定义用于 bootstrap 的统计函数</span></span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a>mle_function <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a>  <span class="co"># 使用索引 indices 进行抽样</span></span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a>  sample_data <span class="ot">&lt;-</span> data[indices]</span>
<span id="cb56-14"><a href="#cb56-14" tabindex="-1"></a>  <span class="co"># 返回 λ 的 MLE</span></span>
<span id="cb56-15"><a href="#cb56-15" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(sample_data))</span>
<span id="cb56-16"><a href="#cb56-16" tabindex="-1"></a>}</span>
<span id="cb56-17"><a href="#cb56-17" tabindex="-1"></a></span>
<span id="cb56-18"><a href="#cb56-18" tabindex="-1"></a><span class="co"># 使用 bootstrap 估计偏差和标准误差</span></span>
<span id="cb56-19"><a href="#cb56-19" tabindex="-1"></a>bootstrap_result <span class="ot">&lt;-</span> <span class="fu">boot</span>(failure_times, mle_function, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb56-20"><a href="#cb56-20" tabindex="-1"></a></span>
<span id="cb56-21"><a href="#cb56-21" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb56-22"><a href="#cb56-22" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MLE of λ:&quot;</span>, lambda_hat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb56-23"><a href="#cb56-23" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bootstrap Bias:&quot;</span>, <span class="fu">mean</span>(bootstrap_result<span class="sc">$</span>t) <span class="sc">-</span> lambda_hat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb56-24"><a href="#cb56-24" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bootstrap Standard Error:&quot;</span>, <span class="fu">sd</span>(bootstrap_result<span class="sc">$</span>t), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
</div>
<div id="题目-7.5" class="section level4">
<h4><strong>题目 7.5：</strong></h4>
<p>参考习题 7.4。通过标准正态法、基础法、百分位法和 BCa
法计算故障间隔时间均值 <span class="math inline">\(1/\lambda\)</span> 的
95% bootstrap 置信区间。比较这些区间，并解释为什么它们可能会不同。</p>
<p>在这里，我们采用<code>boot.ci</code>函数，可以很简便的算出采用不同方法的置信区间。</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a><span class="co"># 定义用于 bootstrap 的统计函数（1/λ）</span></span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a>mean_time_function <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a>  sample_data <span class="ot">&lt;-</span> data[indices]</span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(sample_data))</span>
<span id="cb57-6"><a href="#cb57-6" tabindex="-1"></a>}</span>
<span id="cb57-7"><a href="#cb57-7" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" tabindex="-1"></a><span class="co"># 计算不同方法的 95% 置信区间</span></span>
<span id="cb57-9"><a href="#cb57-9" tabindex="-1"></a>ci_norm <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootstrap_result, <span class="at">type =</span> <span class="st">&quot;norm&quot;</span>)</span>
<span id="cb57-10"><a href="#cb57-10" tabindex="-1"></a>ci_basic <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootstrap_result, <span class="at">type =</span> <span class="st">&quot;basic&quot;</span>)</span>
<span id="cb57-11"><a href="#cb57-11" tabindex="-1"></a>ci_percentile <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootstrap_result, <span class="at">type =</span> <span class="st">&quot;perc&quot;</span>)</span>
<span id="cb57-12"><a href="#cb57-12" tabindex="-1"></a>ci_bca <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootstrap_result, <span class="at">type =</span> <span class="st">&quot;bca&quot;</span>)</span>
<span id="cb57-13"><a href="#cb57-13" tabindex="-1"></a></span>
<span id="cb57-14"><a href="#cb57-14" tabindex="-1"></a><span class="co"># 输出置信区间</span></span>
<span id="cb57-15"><a href="#cb57-15" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;95% Confidence Intervals for 1/λ:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb57-16"><a href="#cb57-16" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Normal:&quot;</span>, ci_norm<span class="sc">$</span>normal[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb57-17"><a href="#cb57-17" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Basic:&quot;</span>, ci_basic<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb57-18"><a href="#cb57-18" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Percentile:&quot;</span>, ci_percentile<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb57-19"><a href="#cb57-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;BCa:&quot;</span>, ci_bca<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb57-20"><a href="#cb57-20" tabindex="-1"></a></span>
<span id="cb57-21"><a href="#cb57-21" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span></code></pre></div>
<div id="置信区间结果分析" class="section level5">
<h5>置信区间结果分析：</h5>
<p>在这四个置信区间中，表现最好的是BCa置信区间，具体分析如下：</p>
<p><strong>1. 正态法</strong></p>
<p>正态法依赖于正态分布的近似，即假设估计量的分布近似为正态分布。由于正态法不考虑样本分布的偏斜，如果数据存在明显的非对称性或偏斜，它可能会给出不准确的结果。而这里的分布显然不符合正态分布，所以可以看到，正太法给出的置信区间下限甚至可能是负的(而指数分布参数要求为正数)，这说明正态法表现较差。</p>
<p><strong>2. 基础法</strong></p>
<p>基础法使用了原始 bootstrap
分布中的样本对估计值进行调整，考虑到偏差。这意味着，它会将原始估计值与样本估计值的差异反向应用到
bootstrap
分布上，从而校正偏差。不过，基础法的区间可能会跨越零（如这个结果显示的负值），表明它可能不适合这个场景，尤其是当估计值不能为负（例如这里
<span class="math inline">\(1/\lambda\)</span>
是正数）。这是基础法的一个潜在缺点，尤其是对偏斜数据的表现。</p>
<p><strong>3. 百分位法</strong></p>
<p>百分位法是从 bootstrap
样本的分布中直接提取百分位数，而不进行任何偏差校正。由于它直接从数据中获得信息，因此它对偏斜的数据更敏感。它的结果与标准正态法和基础法有些不同，表明数据可能存在偏斜或异质性。百分位法对于偏斜数据通常比标准正态法更稳健，因为它没有假设正态性。</p>
<p><strong>4. BCa 法</strong></p>
<p>BCa
方法是最复杂的一种，它不仅考虑了偏差修正，还考虑了偏度修正（即加速因子，用于调整
bootstrap 分布的偏斜程度）。因此，它对偏斜数据具有更好的校正效果。BCa
法的置信区间通常被认为比其他方法更为准确，特别是在数据具有偏斜时。从结果可以看到，BCa
法的区间比其他三种方法更加集中，且不像正态、基础法那样给出了负值。</p>
</div>
</div>
<div id="练习4" class="section level4">
<h4><strong>练习4</strong></h4>
<p>假设总体服从参数为λ的指数分布，则λ的最大似然估计MLE为<span class="math inline">\(\hat{\lambda}\)</span> = <span class="math inline">\(\frac{1}{\bar{X}}\)</span>，其中<span class="math inline">\(\bar{X}\)</span>是样本均值。可以推导出<span class="math inline">\(\hat{\lambda}\)</span>的期望为<span class="math inline">\(\lambda n/(n - 1)\)</span>，因此估计偏差为<span class="math inline">\(\lambda/(n - 1)\)</span>。<span class="math inline">\(\hat{\lambda}\)</span>的标准误为<span class="math inline">\(λn/[(n - 1)\sqrt{(n -
2)}]\)</span>。通过模拟研究验证Bootstrap方法的性能，对比Bootstrap方法和理论结果差距。</p>
<p>(这个题目我看作业里面没写，但ppt上有，所以还是做了)</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a><span class="co"># 参数设定</span></span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>lambda_true <span class="ot">&lt;-</span> <span class="dv">2</span>    <span class="co"># 真正的lambda值</span></span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>n_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>)  <span class="co"># 样本量</span></span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># Bootstrap重复次数</span></span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># 模拟次数</span></span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a><span class="co"># 存储结果的矩阵</span></span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n =</span> <span class="fu">integer</span>(<span class="dv">0</span>), </span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a>                      <span class="at">mean_bootstrap =</span> <span class="fu">numeric</span>(<span class="dv">0</span>),</span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a>                      <span class="at">mean_bias_bootstrap =</span> <span class="fu">numeric</span>(<span class="dv">0</span>), </span>
<span id="cb58-13"><a href="#cb58-13" tabindex="-1"></a>                      <span class="at">mean_bias_theoretical =</span> <span class="fu">numeric</span>(<span class="dv">0</span>), </span>
<span id="cb58-14"><a href="#cb58-14" tabindex="-1"></a>                      <span class="at">se_bootstrap =</span> <span class="fu">numeric</span>(<span class="dv">0</span>), </span>
<span id="cb58-15"><a href="#cb58-15" tabindex="-1"></a>                      <span class="at">se_theoretical =</span> <span class="fu">numeric</span>(<span class="dv">0</span>))</span>
<span id="cb58-16"><a href="#cb58-16" tabindex="-1"></a></span>
<span id="cb58-17"><a href="#cb58-17" tabindex="-1"></a><span class="co"># 循环遍历不同的样本量n</span></span>
<span id="cb58-18"><a href="#cb58-18" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> n_values) {</span>
<span id="cb58-19"><a href="#cb58-19" tabindex="-1"></a>  </span>
<span id="cb58-20"><a href="#cb58-20" tabindex="-1"></a>  <span class="co"># 初始化存储偏差和标准误的向量</span></span>
<span id="cb58-21"><a href="#cb58-21" tabindex="-1"></a>  bootstrap <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb58-22"><a href="#cb58-22" tabindex="-1"></a>  bias_bootstrap <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb58-23"><a href="#cb58-23" tabindex="-1"></a>  se_bootstrap <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb58-24"><a href="#cb58-24" tabindex="-1"></a>  </span>
<span id="cb58-25"><a href="#cb58-25" tabindex="-1"></a>  <span class="co"># 模拟过程</span></span>
<span id="cb58-26"><a href="#cb58-26" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb58-27"><a href="#cb58-27" tabindex="-1"></a>    <span class="co"># 生成样本数据，来自指数分布，参数lambda_true</span></span>
<span id="cb58-28"><a href="#cb58-28" tabindex="-1"></a>    sample_data <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="at">rate =</span> lambda_true)</span>
<span id="cb58-29"><a href="#cb58-29" tabindex="-1"></a>    </span>
<span id="cb58-30"><a href="#cb58-30" tabindex="-1"></a>    <span class="co"># 计算MLE的lambda估计值</span></span>
<span id="cb58-31"><a href="#cb58-31" tabindex="-1"></a>    lambda_hat <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(sample_data)</span>
<span id="cb58-32"><a href="#cb58-32" tabindex="-1"></a>    </span>
<span id="cb58-33"><a href="#cb58-33" tabindex="-1"></a>    <span class="co"># 进行B次Bootstrap抽样</span></span>
<span id="cb58-34"><a href="#cb58-34" tabindex="-1"></a>    bootstrap_estimates <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb58-35"><a href="#cb58-35" tabindex="-1"></a>    <span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb58-36"><a href="#cb58-36" tabindex="-1"></a>      bootstrap_sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(sample_data, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb58-37"><a href="#cb58-37" tabindex="-1"></a>      bootstrap_estimates[b] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(bootstrap_sample)</span>
<span id="cb58-38"><a href="#cb58-38" tabindex="-1"></a>    }</span>
<span id="cb58-39"><a href="#cb58-39" tabindex="-1"></a>    </span>
<span id="cb58-40"><a href="#cb58-40" tabindex="-1"></a>    <span class="co"># 计算Bootstrap偏差和标准误</span></span>
<span id="cb58-41"><a href="#cb58-41" tabindex="-1"></a>    bootstrap[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(bootstrap_estimates)</span>
<span id="cb58-42"><a href="#cb58-42" tabindex="-1"></a>    bias_bootstrap[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(bootstrap_estimates) <span class="sc">-</span> lambda_hat</span>
<span id="cb58-43"><a href="#cb58-43" tabindex="-1"></a>    se_bootstrap[i] <span class="ot">&lt;-</span> <span class="fu">sd</span>(bootstrap_estimates)</span>
<span id="cb58-44"><a href="#cb58-44" tabindex="-1"></a>  }</span>
<span id="cb58-45"><a href="#cb58-45" tabindex="-1"></a>  </span>
<span id="cb58-46"><a href="#cb58-46" tabindex="-1"></a>  <span class="co"># 理论偏差和标准误</span></span>
<span id="cb58-47"><a href="#cb58-47" tabindex="-1"></a>  theoretical_bias <span class="ot">&lt;-</span> lambda_true <span class="sc">/</span> (n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb58-48"><a href="#cb58-48" tabindex="-1"></a>  theoretical_se <span class="ot">&lt;-</span> lambda_true <span class="sc">*</span> n <span class="sc">/</span> ((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(n <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb58-49"><a href="#cb58-49" tabindex="-1"></a>  </span>
<span id="cb58-50"><a href="#cb58-50" tabindex="-1"></a>  <span class="co"># 计算平均Bootstrap偏差和标准误</span></span>
<span id="cb58-51"><a href="#cb58-51" tabindex="-1"></a>  mean_bootstrap <span class="ot">&lt;-</span> <span class="fu">mean</span>(bootstrap)</span>
<span id="cb58-52"><a href="#cb58-52" tabindex="-1"></a>  mean_bias_bootstrap <span class="ot">&lt;-</span> <span class="fu">mean</span>(bias_bootstrap)</span>
<span id="cb58-53"><a href="#cb58-53" tabindex="-1"></a>  mean_se_bootstrap <span class="ot">&lt;-</span> <span class="fu">mean</span>(se_bootstrap)</span>
<span id="cb58-54"><a href="#cb58-54" tabindex="-1"></a>  </span>
<span id="cb58-55"><a href="#cb58-55" tabindex="-1"></a>  <span class="co"># 将结果存储到数据框中</span></span>
<span id="cb58-56"><a href="#cb58-56" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, <span class="fu">data.frame</span>(</span>
<span id="cb58-57"><a href="#cb58-57" tabindex="-1"></a>    <span class="at">n =</span> n,</span>
<span id="cb58-58"><a href="#cb58-58" tabindex="-1"></a>    <span class="at">mean_bootstrap =</span> mean_bootstrap,</span>
<span id="cb58-59"><a href="#cb58-59" tabindex="-1"></a>    <span class="at">mean_bias_bootstrap =</span> mean_bias_bootstrap,</span>
<span id="cb58-60"><a href="#cb58-60" tabindex="-1"></a>    <span class="at">mean_bias_theoretical =</span> theoretical_bias,</span>
<span id="cb58-61"><a href="#cb58-61" tabindex="-1"></a>    <span class="at">se_bootstrap =</span> mean_se_bootstrap,</span>
<span id="cb58-62"><a href="#cb58-62" tabindex="-1"></a>    <span class="at">se_theoretical =</span> theoretical_se</span>
<span id="cb58-63"><a href="#cb58-63" tabindex="-1"></a>  ))</span>
<span id="cb58-64"><a href="#cb58-64" tabindex="-1"></a>}</span>
<span id="cb58-65"><a href="#cb58-65" tabindex="-1"></a></span>
<span id="cb58-66"><a href="#cb58-66" tabindex="-1"></a><span class="co"># 打印结果</span></span>
<span id="cb58-67"><a href="#cb58-67" tabindex="-1"></a><span class="fu">print</span>(results)</span>
<span id="cb58-68"><a href="#cb58-68" tabindex="-1"></a></span>
<span id="cb58-69"><a href="#cb58-69" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span></code></pre></div>
<p>从结果可以看出，随着样本量<span class="math inline">\(n\)</span>的增加，Bootstrap方法的表现逐渐改善。这说明Bootstrap方法本身并不能完全解决小样本量带来的问题。因此，在使用Bootstrap方法时，仍然需要确保原始样本量足够大，否则样本过少可能导致估计结果偏离总体特征。即使通过Bootstrap进行重抽样，也难以获得准确的估计。</p>
</div>
</div>
<div id="homework-6" class="section level3">
<h3>Homework-6</h3>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span></code></pre></div>
<div id="练习9.3" class="section level4">
<h4>练习9.3</h4>
<p><strong>题目：</strong> 使用 Metropolis-Hastings
采样器从标准柯西分布生成随机变量。丢弃链中前 1000
个值，并将生成的观测值的分位数与标准柯西分布的分位数进行比较（参见
<code>qcauchy</code> 或 <code>qt</code>，自由度
<code>df=1</code>）。回忆一下，柯西分布 <span class="math inline">\(\text{Cauchy}(\theta, \eta)\)</span>
的概率密度函数为： <span class="math display">\[
f(x) = \frac{1}{\theta \pi (1 + \left(\frac{x -
\eta}{\theta}\right)^2)}, \quad -\infty &lt; x &lt; \infty, \quad \theta
&gt; 0。
\]</span> 标准柯西分布是指参数为 <span class="math inline">\(\text{Cauchy}(\theta = 1, \eta = 0)\)</span>
的分布。</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a>Metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(m, f, g_sd, sigm) {</span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb60-8"><a href="#cb60-8" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigm)  <span class="co"># 初始化采样起点</span></span>
<span id="cb60-9"><a href="#cb60-9" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)  <span class="co"># 接受-拒绝随机数</span></span>
<span id="cb60-10"><a href="#cb60-10" tabindex="-1"></a></span>
<span id="cb60-11"><a href="#cb60-11" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb60-12"><a href="#cb60-12" tabindex="-1"></a>    xt <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb60-13"><a href="#cb60-13" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> xt, <span class="at">sd =</span> sigm)  <span class="co"># 候选样本</span></span>
<span id="cb60-14"><a href="#cb60-14" tabindex="-1"></a>    num <span class="ot">&lt;-</span> <span class="fu">f</span>(y) <span class="sc">*</span> <span class="fu">dnorm</span>(xt, <span class="at">mean =</span> y, <span class="at">sd =</span> sigm)</span>
<span id="cb60-15"><a href="#cb60-15" tabindex="-1"></a>    den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt) <span class="sc">*</span> <span class="fu">dnorm</span>(y, <span class="at">mean =</span> xt, <span class="at">sd =</span> sigm)</span>
<span id="cb60-16"><a href="#cb60-16" tabindex="-1"></a>    </span>
<span id="cb60-17"><a href="#cb60-17" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num <span class="sc">/</span> den) {</span>
<span id="cb60-18"><a href="#cb60-18" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb60-19"><a href="#cb60-19" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb60-20"><a href="#cb60-20" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb60-21"><a href="#cb60-21" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb60-22"><a href="#cb60-22" tabindex="-1"></a>    }</span>
<span id="cb60-23"><a href="#cb60-23" tabindex="-1"></a>  }</span>
<span id="cb60-24"><a href="#cb60-24" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Reject probability:&quot;</span>, k <span class="sc">/</span> m, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb60-25"><a href="#cb60-25" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb60-26"><a href="#cb60-26" tabindex="-1"></a>}</span>
<span id="cb60-27"><a href="#cb60-27" tabindex="-1"></a></span>
<span id="cb60-28"><a href="#cb60-28" tabindex="-1"></a><span class="co"># 参数设置</span></span>
<span id="cb60-29"><a href="#cb60-29" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb60-30"><a href="#cb60-30" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb60-31"><a href="#cb60-31" tabindex="-1"></a>sigm <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb60-32"><a href="#cb60-32" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) { <span class="fu">dcauchy</span>(x) }  <span class="co"># 标准柯西分布</span></span>
<span id="cb60-33"><a href="#cb60-33" tabindex="-1"></a>g_sd <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># 正态分布标准差</span></span>
<span id="cb60-34"><a href="#cb60-34" tabindex="-1"></a></span>
<span id="cb60-35"><a href="#cb60-35" tabindex="-1"></a><span class="co"># 运行 Metropolis-Hastings 采样</span></span>
<span id="cb60-36"><a href="#cb60-36" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">Metropolis</span>(m, f, g_sd, sigm[<span class="dv">4</span>])</span></code></pre></div>
<pre><code>## Reject probability: 0.37934</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>DrawQQPlot <span class="ot">&lt;-</span> <span class="cf">function</span>(x, burn, scale) {</span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>  <span class="co"># 去除烧入期的样本</span></span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sort</span>(x[(burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(x)])</span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>  </span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>  <span class="co"># 生成与样本数相同的标准柯西分布样本，并排序</span></span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">rcauchy</span>(<span class="fu">length</span>(x)))</span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>  </span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a>  <span class="co"># 计算分位数</span></span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a>  quantileX <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>))</span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a>  quantileY <span class="ot">&lt;-</span> <span class="fu">quantile</span>(y, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>))</span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a>  </span>
<span id="cb62-12"><a href="#cb62-12" tabindex="-1"></a>  <span class="co"># 绘制 Q-Q 图</span></span>
<span id="cb62-13"><a href="#cb62-13" tabindex="-1"></a>  <span class="fu">plot</span>(quantileY, quantileX, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb62-14"><a href="#cb62-14" tabindex="-1"></a>       <span class="at">xlim =</span> scale, <span class="at">ylim =</span> scale,</span>
<span id="cb62-15"><a href="#cb62-15" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;Theoretical Quantiles&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Sample Quantiles&quot;</span>)</span>
<span id="cb62-16"><a href="#cb62-16" tabindex="-1"></a>  </span>
<span id="cb62-17"><a href="#cb62-17" tabindex="-1"></a>  <span class="co"># 添加参考线</span></span>
<span id="cb62-18"><a href="#cb62-18" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb62-19"><a href="#cb62-19" tabindex="-1"></a>}</span>
<span id="cb62-20"><a href="#cb62-20" tabindex="-1"></a></span>
<span id="cb62-21"><a href="#cb62-21" tabindex="-1"></a><span class="co"># 设置参数并调用函数</span></span>
<span id="cb62-22"><a href="#cb62-22" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb62-23"><a href="#cb62-23" tabindex="-1"></a>scale <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>)  <span class="co"># 可根据需求调整</span></span>
<span id="cb62-24"><a href="#cb62-24" tabindex="-1"></a><span class="fu">DrawQQPlot</span>(x, burn, scale)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="co"># 去除烧入期样本</span></span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>samples <span class="ot">&lt;-</span> x[(burn <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>m]</span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a><span class="co"># 计算生成样本和标准柯西分布的分位数</span></span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a>sample_deciles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samples, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a>cauchy_deciles <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a><span class="co"># 比较生成样本的分位数和理论分位数</span></span>
<span id="cb63-9"><a href="#cb63-9" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb63-10"><a href="#cb63-10" tabindex="-1"></a>  <span class="at">Decile =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>),</span>
<span id="cb63-11"><a href="#cb63-11" tabindex="-1"></a>  <span class="at">Sample_Deciles =</span> sample_deciles,</span>
<span id="cb63-12"><a href="#cb63-12" tabindex="-1"></a>  <span class="at">Cauchy_Deciles =</span> cauchy_deciles</span>
<span id="cb63-13"><a href="#cb63-13" tabindex="-1"></a>)</span>
<span id="cb63-14"><a href="#cb63-14" tabindex="-1"></a></span>
<span id="cb63-15"><a href="#cb63-15" tabindex="-1"></a><span class="fu">print</span>(comparison)</span></code></pre></div>
<pre><code>##     Decile Sample_Deciles Cauchy_Deciles
## 10%    0.1   -2.744687590     -3.0776835
## 20%    0.2   -1.309595153     -1.3763819
## 30%    0.3   -0.699004088     -0.7265425
## 40%    0.4   -0.303975681     -0.3249197
## 50%    0.5    0.002489167      0.0000000
## 60%    0.6    0.319320078      0.3249197
## 70%    0.7    0.711071459      0.7265425
## 80%    0.8    1.337261175      1.3763819
## 90%    0.9    2.819634821      3.0776835</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="co"># 绘制直方图与密度图</span></span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">samples =</span> samples), <span class="fu">aes</span>(<span class="at">x =</span> samples)) <span class="sc">+</span></span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">bins =</span> <span class="dv">100</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb65-5"><a href="#cb65-5" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Histogram of Samples from Cauchy Distribution (after burn-in)&quot;</span>) <span class="sc">+</span></span>
<span id="cb65-6"><a href="#cb65-6" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Value&quot;</span>) <span class="sc">+</span></span>
<span id="cb65-7"><a href="#cb65-7" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Density&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.
## ℹ Please use `after_stat(density)` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>从十分位数对比结果和QQ图可以看出来，MH算法在靠近中心的
(0,0)附近，拟合状况较好，分布的拟合状况像两侧逐渐偏移。整体来看，分布拟合状况良好，这从我们画的直方图也可以看出来。</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span></code></pre></div>
</div>
<div id="练习9.8" class="section level4">
<h4>练习9.8</h4>
<p><strong>题目：</strong> 考虑一个二元密度函数：</p>
<p><span class="math display">\[
f(x, y) \propto \binom{n}{x} y^{x + a - 1} (1 - y)^{n - x + b - 1},
\quad x = 0, 1, \dots, n, \quad 0 \leq y \leq 1.
\]</span></p>
<p>可以证明，对于固定的 <span class="math inline">\(a\)</span>、<span class="math inline">\(b\)</span>、<span class="math inline">\(n\)</span>，其条件分布分别为二项分布 <span class="math inline">\(\text{Binomial}(n, y)\)</span> 和贝塔分布 <span class="math inline">\(\text{Beta}(x + a, n - x +
b)\)</span>。使用吉布斯采样器生成以目标联合密度 <span class="math inline">\(f(x, y)\)</span> 为目标的链。</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span>     <span class="co"># 参数 a</span></span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span>     <span class="co"># 参数 b</span></span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>    <span class="co"># 二项分布的样本数</span></span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a><span class="co"># 设置 Gibbs 采样的初始值和迭代次数</span></span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a>num_iterations <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb68-8"><a href="#cb68-8" tabindex="-1"></a>samples_x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_iterations)</span>
<span id="cb68-9"><a href="#cb68-9" tabindex="-1"></a>samples_y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_iterations)</span>
<span id="cb68-10"><a href="#cb68-10" tabindex="-1"></a>samples_x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">5</span>   <span class="co"># 初始 x 值</span></span>
<span id="cb68-11"><a href="#cb68-11" tabindex="-1"></a>samples_y[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="co"># 初始 y 值</span></span>
<span id="cb68-12"><a href="#cb68-12" tabindex="-1"></a></span>
<span id="cb68-13"><a href="#cb68-13" tabindex="-1"></a><span class="co"># Gibbs 采样过程</span></span>
<span id="cb68-14"><a href="#cb68-14" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>num_iterations) {</span>
<span id="cb68-15"><a href="#cb68-15" tabindex="-1"></a>  <span class="co"># 给定 y 条件下，从二项分布采样 x</span></span>
<span id="cb68-16"><a href="#cb68-16" tabindex="-1"></a>  samples_x[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, samples_y[i <span class="sc">-</span> <span class="dv">1</span>])</span>
<span id="cb68-17"><a href="#cb68-17" tabindex="-1"></a>  </span>
<span id="cb68-18"><a href="#cb68-18" tabindex="-1"></a>  <span class="co"># 给定 x 条件下，从 Beta 分布采样 y</span></span>
<span id="cb68-19"><a href="#cb68-19" tabindex="-1"></a>  samples_y[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, samples_x[i] <span class="sc">+</span> a, n <span class="sc">-</span> samples_x[i] <span class="sc">+</span> b)</span>
<span id="cb68-20"><a href="#cb68-20" tabindex="-1"></a>}</span>
<span id="cb68-21"><a href="#cb68-21" tabindex="-1"></a></span>
<span id="cb68-22"><a href="#cb68-22" tabindex="-1"></a><span class="co"># 绘制样本结果</span></span>
<span id="cb68-23"><a href="#cb68-23" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb68-24"><a href="#cb68-24" tabindex="-1"></a><span class="fu">plot</span>(samples_x, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">main =</span> <span class="st">&quot;样本 x 的轨迹&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;迭代次数&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;x 值&quot;</span>)</span>
<span id="cb68-25"><a href="#cb68-25" tabindex="-1"></a><span class="fu">plot</span>(samples_y, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">main =</span> <span class="st">&quot;样本 y 的轨迹&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;迭代次数&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;y 值&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA/FBMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6OgA6Ojo6OmY6OpA6Zjo6ZpA6ZrY6kJA6kLY6kNtmAABmOgBmOjpmOpBmZmZmZpBmkJBmkLZmkNtmtttmtv+QOgCQOjqQOmaQZjqQZmaQkDqQkGaQkJCQkNuQtpCQtraQttuQtv+Q27aQ29uQ2/+2ZgC2Zjq2Zma2kDq2kGa2kJC2tma2tpC2tra2ttu227a229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDbtrbb27bb29vb2//b/7bb/9vb////AAD/tmb/25D/27b/29v//7b//9v///8GrKQAAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKQklEQVR4nO2dj3/axh2Gj8xxBwtkyRrsOXVjt26bNfsRsqQJa72FrB3tAHtI////svshoZNAvAf6IqvR++aTGEvK6eG5050khKRiZmvUXQM0PRQEQkEgFARCQSAUBEJBIBQEQkEgFARCQSAUBEJBIBQEQkEgFARCQSAUBEJBIBQEQkEgFARCQSAUBEJBIBQEQkEgFARCQSAUBEJBIEGCFv3zWTT+h331zJv+of9shv/vY71M9NXZdTrlxk6JX+eK2il18oQJUt04nihdzkg99hAmZjrIRD0xEL3Oy6y045mdcZFMiN48tbS3p4+uN5RwtzzhgpZD9WQ5PParyK1sa3RVvS8smbzOgHTRnQu3nnvvm8YTLsgU9KH/0p+eFD39uRTnqt9/+rY/+H7YOR+/NbUWjd+ddM7fDdWFBxRP+udjnbf9h+Om8WBB0U/j10qpey/G43dnT79Wpm3ejm2u1CP97yuVNtebnmkC0eWqIUSXetZN7/i1Ib/p2cn6xw+62qcj9elVrsbNwhNJHg3SdT7T974HT1ALSrbt5TC/BegVd54VFtSrmKhsa3ZAn5w+nK2AJubdXf80vlRHDzp+AwgUtAPPxNXUqFhhu/AEAY02AukKUvc+yw0belLn255adQwJUGfwtxWQnvR7W9xIXYwsUGQq/eEvQ/32AgWF8ugWfWE7q+5qkZ15QoD0GmzbfdfrfHuiHqeTdYWpo/7nuUU1klJZPaRN+vuvns7Mz5mpsPvf9I705r8Cim3nMVG/DW1BwTxuG1ustehdeEKAzJrV8ftCjZkKU09eDfLjzshM9JbRneGbXtduFA4oGl/f6AmW1QP6wxeDf+rigwSF89htbJRr0bvyhADpN/3JmVZugf43Xa28q0W7tXjwPa8BpTXWtc15tagFMoV5QJ3+SzM/SFA4j9nGzO5ABZ4AoOVpT3VvXZN+oQdE16bN7tXEdsk+ka3GbMIKSO9ZvPSAjr85u1LH/73MgB79HLvSRHnMNjZZ3+R34QkA+nD2tW6Q01muSdvSTRGa4X62/6sLfKDWakwvOh6ne6zRd6fq/g/m/0Ye0JPY7vSFCNqNp/NgvcJ24cFAy+d/WayNGje9oxd2v+NNz3YI1+lkday7/1WVZUBxsktvmtgDXZyZkwOKrgb/mk5fyfK4QSPXJ+7Ks8OetAf0ox4spumeqztsdOs3bnQfWhhWUyAz+XY8M2184aD++vxPpriTzuDsXNMK8yRD/3vv15159gKKxm5nvnjss3C1NfL3XM2o4YBWS2sgW5Se++Lsc4PRjf/dG/x5GkfTaRyQUB6H5B3A7sGzX40lgUfPWY3950SttGmgvw/MRvDa9ujRd8/NcPvjaV/tWWFbeLydoP14As8HWdfLLx4WgPrg6Dl6o0djV7+aLd2HW/QHn4Wd16jMc3uSO0GwB89HfUbR7HLjMyDb87EL6nxasYyPWpBEKAiEgkAoCISCQCgIhIJAKAiEgkAoCISCQCgIhIJAKAiEgkAoCISCQCgIhIJAKAiEgkAoCISCQCgIhIJAKAiEgkCEBanSyK6nPh5pQTWtJzTVeSho3xL2CwWVlLLKb0pSr6CtXc3cLhFclBiUK64ZgjIe7WOeOJkn0yjI59F+nCD7M7Y/zW8UlPA4IXP7w7UjN4GCEp5E0DwvaE5BKc/cT7zyQ0EpDwUBnrygOQUVeeYloaCEh4IAT8sFjZTq2m+BXpQs0HJBk+OZ+w79cljylZV2C4outZaF/RrlJP/d64yn1YKWQ71lLez3wRYlt41ptyC2IJRVH2RVbeRpt6DmjWIYqF5BMDULChhWWy0opFO8I0GTRoxi5cNqc0/aswVtz131QeXDarsFNW4Usywqd/+SAk/NgnBxtQpa3Z5kUXZ/hXYL8jZ0Hmpsih1VXXiwuilsQSir26+yDyqJvf9N7r57RZ6WC8I8FAR4KAjwUBDgoSDAQ0GAh4IAzwEEVXorBxBUjUdIkFqbsi+QjCA5HjlBMt+qkBMkxCMoKPnTlBYkxNMQQdIn7eV4RAQlLbkxLUiSpyEtKCuuGS0oK4iCQEGCgjiKlaHE+VpqiCAhHqlOWgxIqJMW4xFqQfkvv1YBkmlBcjxSggxSBY6sOCFBYjxygmQO7CUPVkV4JAVJEIkezUvwiAoSyJ2cD7rpXZTytFpQ+qnYlus72i0o/UCVLag07jmrFLQlI/uwnjoERaVPb90l9XfS9rF9dQhaDt2TlaIvN3d3XrYBiQnyHv6JaI7q2cQW9sFyk/Lr/YJGDcEWZJ4QG/Lkouiy9JJJ2T7IXRG5DSlg1JDdxEIdlUa2kzaGSt+6TdmoIX1OOstk2zWs3mJ17AeNlHp2WX4tUrIQGDVEBS3sBcfRJWDagCF70t4meV4rfOQ7GDXkBJkeL3laY9hT6DfyCAr6o6smOIptHzXEBJlHxe76fzbwiPZBgdk6akj3QRBl25ja+j1pXmm/PbxOGoRX2oOwBaHwSnsUXmlfmYeCAA8FAR4KAjwUBHgoCPBQEOChIMBDQYCHggBPQwQd7qR9VZ6GCMqKa4agjIeCAA8FAR4KAjwUBHgoCPBQEOChIMBDQYCHggBPywXxs/nt4Wfz27P/J6stefjR/p/N7/C+f82CKrSgdgja/7P5gwnCo0atggI/m48Lcg4nKGDUqFcQjEoeCRXnnsJ2KEEh23xTBcVx4iidEVzCDmsrHzXu/Jz0lgvJs1+SrcvNCC1ZugVJrKd68FfKD9UHwVFDZD1yqVlQwKghsx6x1C1o/+Lu6mC1Mo+0oNLIrsclYLejMo80uEr/Ueu/SSdg0KjO82sWFHCw2m5BbEEoeLej5YLwbkfbBdXAQ0EhBTQJqGk8FBRSAFMeCgKhIBAKAqEgEAoCoSAQCgKhIBAKAqEgEAoCoSAQUUELpSRuGyUWCR5JQeZB4osGGRLhERTkPmQYhd0/s4bI8AgKcjfHK7sQpf7I8EgK+p1pzRXu6SccGR5BQW5zb04nJMNDQSDcxEDYSYNwmAfhjiKI6KHGpGGHGhI8PFgFoSAQCgKhIBAKAqEgEAoCoSAQCgKhIBAKAqEgEAoCoSAQCgKhIBAKAqEgEAoCoSAQCgKhIBAKAqEgEAoCoSAQIUEq90qVzEtfH75W5HiqsibrXwPy1qy8WaqwtHjEeSqzFlehvL/F+lP2z2FbkDSPiCDvjjyFL17bV+ns3Iuq662LRwA0VwcpULZK5c9Qa5uAfGR5hDtpvcLiDZ5yNakO3wsJ81QkVSsC11YL3WCcq8+EJd3yDxF5Hok+yC+mALRpbnxAQfI8MoKyNWwkSDnSxn5wQYI8UoJyfd8anvd7TYLEeEQEee04t3kXgZTKLXuQSPNICPJRsrrJzfBGFZG11sdTFbXYOrOtPV87Kp144E1MnKciqS3ev7llccDIbe5eB3ogQ/I8B2zsH0coCISCQCgIhIJAKAiEgkAoCISCQCgIhIJAKAiEgkAoCISCQCgIhIJAKAiEgkAoCISCQCgIhIJA/g9i9SJHatEGYgAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="co"># 计算和展示联合分布的样本</span></span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a><span class="fu">plot</span>(samples_x, samples_y, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>), </span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;联合分布样本 (x, y)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span></code></pre></div>
</div>
<div id="练习三-1" class="section level4">
<h4>练习三</h4>
<p><strong>题目：</strong>
利用Gelman-Rubin检验练习一和练习二得到的马氏链是否收敛。</p>
<p>这里我们分为3.1和3.2，3.1是练习一对应的Gelman-Rubin检验，3.2是练习二对应的Gelman-Rubin检验。</p>
<div id="section" class="section level5">
<h5>3.1</h5>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="co"># 定义目标分布的密度函数（标准柯西分布）</span></span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>target_density <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">/</span> (pi <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a>}</span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a><span class="co"># Metropolis-Hastings 采样函数</span></span>
<span id="cb71-7"><a href="#cb71-7" tabindex="-1"></a>metropolis_hastings <span class="ot">&lt;-</span> <span class="cf">function</span>(iter, <span class="at">proposal_sd =</span> <span class="dv">1</span>, <span class="at">init_val =</span> <span class="dv">0</span>) {</span>
<span id="cb71-8"><a href="#cb71-8" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(iter)</span>
<span id="cb71-9"><a href="#cb71-9" tabindex="-1"></a>  samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> init_val</span>
<span id="cb71-10"><a href="#cb71-10" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>iter) {</span>
<span id="cb71-11"><a href="#cb71-11" tabindex="-1"></a>    proposal <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> samples[i <span class="sc">-</span> <span class="dv">1</span>], <span class="at">sd =</span> proposal_sd)</span>
<span id="cb71-12"><a href="#cb71-12" tabindex="-1"></a>    accept_prob <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">1</span>, <span class="fu">target_density</span>(proposal) <span class="sc">/</span> <span class="fu">target_density</span>(samples[i <span class="sc">-</span> <span class="dv">1</span>]))</span>
<span id="cb71-13"><a href="#cb71-13" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> accept_prob) {</span>
<span id="cb71-14"><a href="#cb71-14" tabindex="-1"></a>      samples[i] <span class="ot">&lt;-</span> proposal</span>
<span id="cb71-15"><a href="#cb71-15" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb71-16"><a href="#cb71-16" tabindex="-1"></a>      samples[i] <span class="ot">&lt;-</span> samples[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb71-17"><a href="#cb71-17" tabindex="-1"></a>    }</span>
<span id="cb71-18"><a href="#cb71-18" tabindex="-1"></a>  }</span>
<span id="cb71-19"><a href="#cb71-19" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb71-20"><a href="#cb71-20" tabindex="-1"></a>}</span>
<span id="cb71-21"><a href="#cb71-21" tabindex="-1"></a></span>
<span id="cb71-22"><a href="#cb71-22" tabindex="-1"></a><span class="co"># Gelman-Rubin 检验函数</span></span>
<span id="cb71-23"><a href="#cb71-23" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb71-24"><a href="#cb71-24" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb71-25"><a href="#cb71-25" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb71-26"><a href="#cb71-26" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb71-27"><a href="#cb71-27" tabindex="-1"></a></span>
<span id="cb71-28"><a href="#cb71-28" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)     <span class="co"># 每条链的均值</span></span>
<span id="cb71-29"><a href="#cb71-29" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)        <span class="co"># 链间方差</span></span>
<span id="cb71-30"><a href="#cb71-30" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co"># 链内方差</span></span>
<span id="cb71-31"><a href="#cb71-31" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)               <span class="co"># 链内方差的平均值</span></span>
<span id="cb71-32"><a href="#cb71-32" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n <span class="sc">+</span> B <span class="sc">/</span> n  <span class="co"># 联合后验分布的估计方差</span></span>
<span id="cb71-33"><a href="#cb71-33" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W             <span class="co"># Gelman-Rubin 统计量</span></span>
<span id="cb71-34"><a href="#cb71-34" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb71-35"><a href="#cb71-35" tabindex="-1"></a>}</span>
<span id="cb71-36"><a href="#cb71-36" tabindex="-1"></a></span>
<span id="cb71-37"><a href="#cb71-37" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb71-38"><a href="#cb71-38" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">31000</span></span>
<span id="cb71-39"><a href="#cb71-39" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb71-40"><a href="#cb71-40" tabindex="-1"></a>num_chains <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb71-41"><a href="#cb71-41" tabindex="-1"></a>proposal_sd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb71-42"><a href="#cb71-42" tabindex="-1"></a>initial_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">10</span>)  <span class="co"># 不同的初始值</span></span>
<span id="cb71-43"><a href="#cb71-43" tabindex="-1"></a></span>
<span id="cb71-44"><a href="#cb71-44" tabindex="-1"></a><span class="co"># 生成多个链</span></span>
<span id="cb71-45"><a href="#cb71-45" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb71-46"><a href="#cb71-46" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> num_chains, <span class="at">ncol =</span> n_samples <span class="sc">-</span> burn_in)</span>
<span id="cb71-47"><a href="#cb71-47" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_chains) {</span>
<span id="cb71-48"><a href="#cb71-48" tabindex="-1"></a>  chain <span class="ot">&lt;-</span> <span class="fu">metropolis_hastings</span>(n_samples, proposal_sd, <span class="at">init_val =</span> initial_values[i])</span>
<span id="cb71-49"><a href="#cb71-49" tabindex="-1"></a>  chains[i, ] <span class="ot">&lt;-</span> chain[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n_samples]</span>
<span id="cb71-50"><a href="#cb71-50" tabindex="-1"></a>}</span>
<span id="cb71-51"><a href="#cb71-51" tabindex="-1"></a></span>
<span id="cb71-52"><a href="#cb71-52" tabindex="-1"></a><span class="co"># 计算每条链的累积均值</span></span>
<span id="cb71-53"><a href="#cb71-53" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(chains, <span class="dv">1</span>, cumsum))</span>
<span id="cb71-54"><a href="#cb71-54" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi)) {</span>
<span id="cb71-55"><a href="#cb71-55" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb71-56"><a href="#cb71-56" tabindex="-1"></a>}</span>
<span id="cb71-57"><a href="#cb71-57" tabindex="-1"></a></span>
<span id="cb71-58"><a href="#cb71-58" tabindex="-1"></a><span class="co"># 计算 Gelman-Rubin 统计量随采样点数量的变化</span></span>
<span id="cb71-59"><a href="#cb71-59" tabindex="-1"></a>R_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_samples <span class="sc">-</span> burn_in )</span>
<span id="cb71-60"><a href="#cb71-60" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n_samples <span class="sc">-</span>  burn_in)) {</span>
<span id="cb71-61"><a href="#cb71-61" tabindex="-1"></a>  R_values[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[, <span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb71-62"><a href="#cb71-62" tabindex="-1"></a>}</span>
<span id="cb71-63"><a href="#cb71-63" tabindex="-1"></a></span>
<span id="cb71-64"><a href="#cb71-64" tabindex="-1"></a><span class="co"># 绘制 Gelman-Rubin 统计量随采样点数量变化的图像</span></span>
<span id="cb71-65"><a href="#cb71-65" tabindex="-1"></a><span class="fu">plot</span>(R_values, <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">col =</span> <span class="st">&#39;purple&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;Number of Sampling Points (n)&#39;</span>,</span>
<span id="cb71-66"><a href="#cb71-66" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&#39;R Statistic&#39;</span>, <span class="at">main =</span> <span class="st">&#39;Gelman-Rubin Diagnostic R vs. Number of Sampling Points&#39;</span>)</span>
<span id="cb71-67"><a href="#cb71-67" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">1.2</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>, <span class="at">lty =</span> <span class="dv">2</span>)  <span class="co"># 添加 R = 1.2 的参考线</span></span>
<span id="cb71-68"><a href="#cb71-68" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;R Statistic&quot;</span>, <span class="st">&quot;R = 1.2&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;purple&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="co"># 绘制每条链的累积均值随采样点数量变化的图像</span></span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span>(n_samples <span class="sc">-</span> burn_in), psi[<span class="dv">1</span>, ], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">ylim =</span> <span class="fu">range</span>(psi),</span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Number of Sampling Points (n)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Cumulative Mean&quot;</span>,</span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Cumulative Mean of Each Chain&quot;</span>)</span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>num_chains) {</span>
<span id="cb72-6"><a href="#cb72-6" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span>(n_samples <span class="sc">-</span> burn_in), psi[i, ], <span class="at">col =</span> i)</span>
<span id="cb72-7"><a href="#cb72-7" tabindex="-1"></a>}</span>
<span id="cb72-8"><a href="#cb72-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">paste</span>(<span class="st">&quot;Chain&quot;</span>, <span class="dv">1</span><span class="sc">:</span>num_chains), <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span>num_chains, <span class="at">lty =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span></code></pre></div>
<p>观察结果我们可以看到，在生成样本数量为6000左右时，利用Gelman-Rubin检验方法得到的R小于1.2，但随着样本数量n的增大，不同链又呈现发散状态，得到的R大于1.2，而这与每条链的均值图表现也十分吻合，推测发生这种情况原因是在用MH算法生成cauchy分布样本时，选择的函数会影响结果(例如这里我们选择的就是标准正态分布)。</p>
</div>
<div id="section-1" class="section level5">
<h5>3.2</h5>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="co"># 设置 Gibbs 采样器函数</span></span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a>gibbs_sampler <span class="ot">&lt;-</span> <span class="cf">function</span>(num_iterations, n, a, b, init_x, init_y) {</span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a>  samples_x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_iterations)</span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a>  samples_y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_iterations)</span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a>  samples_x[<span class="dv">1</span>] <span class="ot">&lt;-</span> init_x</span>
<span id="cb74-6"><a href="#cb74-6" tabindex="-1"></a>  samples_y[<span class="dv">1</span>] <span class="ot">&lt;-</span> init_y</span>
<span id="cb74-7"><a href="#cb74-7" tabindex="-1"></a>  </span>
<span id="cb74-8"><a href="#cb74-8" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>num_iterations) {</span>
<span id="cb74-9"><a href="#cb74-9" tabindex="-1"></a>    <span class="co"># 给定 y 条件下，从二项分布采样 x</span></span>
<span id="cb74-10"><a href="#cb74-10" tabindex="-1"></a>    samples_x[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, samples_y[i <span class="sc">-</span> <span class="dv">1</span>])</span>
<span id="cb74-11"><a href="#cb74-11" tabindex="-1"></a>    </span>
<span id="cb74-12"><a href="#cb74-12" tabindex="-1"></a>    <span class="co"># 给定 x 条件下，从 Beta 分布采样 y</span></span>
<span id="cb74-13"><a href="#cb74-13" tabindex="-1"></a>    samples_y[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, samples_x[i] <span class="sc">+</span> a, n <span class="sc">-</span> samples_x[i] <span class="sc">+</span> b)</span>
<span id="cb74-14"><a href="#cb74-14" tabindex="-1"></a>  }</span>
<span id="cb74-15"><a href="#cb74-15" tabindex="-1"></a>  </span>
<span id="cb74-16"><a href="#cb74-16" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">samples_x =</span> samples_x, <span class="at">samples_y =</span> samples_y))</span>
<span id="cb74-17"><a href="#cb74-17" tabindex="-1"></a>}</span>
<span id="cb74-18"><a href="#cb74-18" tabindex="-1"></a></span>
<span id="cb74-19"><a href="#cb74-19" tabindex="-1"></a><span class="co"># Gelman-Rubin 检验函数</span></span>
<span id="cb74-20"><a href="#cb74-20" tabindex="-1"></a>gelman_rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(chains) {</span>
<span id="cb74-21"><a href="#cb74-21" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">ncol</span>(chains)  <span class="co"># 链的数量</span></span>
<span id="cb74-22"><a href="#cb74-22" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(chains)  <span class="co"># 每条链的采样点数量</span></span>
<span id="cb74-23"><a href="#cb74-23" tabindex="-1"></a>  </span>
<span id="cb74-24"><a href="#cb74-24" tabindex="-1"></a>  <span class="co"># Step 1: 计算每条链的均值</span></span>
<span id="cb74-25"><a href="#cb74-25" tabindex="-1"></a>  chain_means <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(chains)</span>
<span id="cb74-26"><a href="#cb74-26" tabindex="-1"></a>  </span>
<span id="cb74-27"><a href="#cb74-27" tabindex="-1"></a>  <span class="co"># Step 2: 计算链间方差 B</span></span>
<span id="cb74-28"><a href="#cb74-28" tabindex="-1"></a>  overall_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(chain_means)</span>
<span id="cb74-29"><a href="#cb74-29" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">sum</span>((chain_means <span class="sc">-</span> overall_mean)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (m <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb74-30"><a href="#cb74-30" tabindex="-1"></a>  </span>
<span id="cb74-31"><a href="#cb74-31" tabindex="-1"></a>  <span class="co"># Step 3: 计算每条链内的方差 W</span></span>
<span id="cb74-32"><a href="#cb74-32" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">apply</span>(chains, <span class="dv">2</span>, var)) <span class="sc">/</span> m</span>
<span id="cb74-33"><a href="#cb74-33" tabindex="-1"></a>  </span>
<span id="cb74-34"><a href="#cb74-34" tabindex="-1"></a>  <span class="co"># Step 4: 估计联合后验分布的方差 V_hat</span></span>
<span id="cb74-35"><a href="#cb74-35" tabindex="-1"></a>  V_hat <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span>n) <span class="sc">*</span> W <span class="sc">+</span> (<span class="dv">1</span><span class="sc">/</span>n) <span class="sc">*</span> B</span>
<span id="cb74-36"><a href="#cb74-36" tabindex="-1"></a>  </span>
<span id="cb74-37"><a href="#cb74-37" tabindex="-1"></a>  <span class="co"># Step 5: 计算 R 统计量</span></span>
<span id="cb74-38"><a href="#cb74-38" tabindex="-1"></a>  R_hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(V_hat <span class="sc">/</span> W)</span>
<span id="cb74-39"><a href="#cb74-39" tabindex="-1"></a>  </span>
<span id="cb74-40"><a href="#cb74-40" tabindex="-1"></a>  <span class="fu">return</span>(R_hat)</span>
<span id="cb74-41"><a href="#cb74-41" tabindex="-1"></a>}</span>
<span id="cb74-42"><a href="#cb74-42" tabindex="-1"></a></span>
<span id="cb74-43"><a href="#cb74-43" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb74-44"><a href="#cb74-44" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb74-45"><a href="#cb74-45" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb74-46"><a href="#cb74-46" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb74-47"><a href="#cb74-47" tabindex="-1"></a>num_iterations <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb74-48"><a href="#cb74-48" tabindex="-1"></a></span>
<span id="cb74-49"><a href="#cb74-49" tabindex="-1"></a><span class="co"># 生成 3 条链</span></span>
<span id="cb74-50"><a href="#cb74-50" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb74-51"><a href="#cb74-51" tabindex="-1"></a>chain1 <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(num_iterations, n, a, b, <span class="at">init_x =</span> <span class="dv">5</span>, <span class="at">init_y =</span> <span class="fl">0.5</span>)</span>
<span id="cb74-52"><a href="#cb74-52" tabindex="-1"></a>chain2 <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(num_iterations, n, a, b, <span class="at">init_x =</span> <span class="dv">6</span>, <span class="at">init_y =</span> <span class="fl">0.6</span>)</span>
<span id="cb74-53"><a href="#cb74-53" tabindex="-1"></a>chain3 <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(num_iterations, n, a, b, <span class="at">init_x =</span> <span class="dv">4</span>, <span class="at">init_y =</span> <span class="fl">0.4</span>)</span>
<span id="cb74-54"><a href="#cb74-54" tabindex="-1"></a></span>
<span id="cb74-55"><a href="#cb74-55" tabindex="-1"></a><span class="co"># 仅对 y 值进行 Gelman-Rubin 检验</span></span>
<span id="cb74-56"><a href="#cb74-56" tabindex="-1"></a>chains_y <span class="ot">&lt;-</span> <span class="fu">cbind</span>(chain1<span class="sc">$</span>samples_y, chain2<span class="sc">$</span>samples_y, chain3<span class="sc">$</span>samples_y)</span>
<span id="cb74-57"><a href="#cb74-57" tabindex="-1"></a></span>
<span id="cb74-58"><a href="#cb74-58" tabindex="-1"></a><span class="co"># 检验结果</span></span>
<span id="cb74-59"><a href="#cb74-59" tabindex="-1"></a>R_hat <span class="ot">&lt;-</span> <span class="fu">gelman_rubin</span>(chains_y)</span>
<span id="cb74-60"><a href="#cb74-60" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Gelman-Rubin 诊断的 R 统计量:&quot;</span>, R_hat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb74-61"><a href="#cb74-61" tabindex="-1"></a></span>
<span id="cb74-62"><a href="#cb74-62" tabindex="-1"></a><span class="co"># 检查 R 统计量是否小于 1.2</span></span>
<span id="cb74-63"><a href="#cb74-63" tabindex="-1"></a><span class="cf">if</span> (R_hat <span class="sc">&lt;</span> <span class="fl">1.2</span>) {</span>
<span id="cb74-64"><a href="#cb74-64" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;链已收敛。</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb74-65"><a href="#cb74-65" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb74-66"><a href="#cb74-66" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;链未收敛。</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb74-67"><a href="#cb74-67" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="co"># 设置 Gibbs 采样器函数</span></span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a>gibbs_sampler <span class="ot">&lt;-</span> <span class="cf">function</span>(num_iterations, n, a, b, init_x, init_y) {</span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a>  samples_x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_iterations)</span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a>  samples_y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_iterations)</span>
<span id="cb75-5"><a href="#cb75-5" tabindex="-1"></a>  samples_x[<span class="dv">1</span>] <span class="ot">&lt;-</span> init_x</span>
<span id="cb75-6"><a href="#cb75-6" tabindex="-1"></a>  samples_y[<span class="dv">1</span>] <span class="ot">&lt;-</span> init_y</span>
<span id="cb75-7"><a href="#cb75-7" tabindex="-1"></a>  </span>
<span id="cb75-8"><a href="#cb75-8" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>num_iterations) {</span>
<span id="cb75-9"><a href="#cb75-9" tabindex="-1"></a>    <span class="co"># 给定 y 条件下，从二项分布采样 x</span></span>
<span id="cb75-10"><a href="#cb75-10" tabindex="-1"></a>    samples_x[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, samples_y[i <span class="sc">-</span> <span class="dv">1</span>])</span>
<span id="cb75-11"><a href="#cb75-11" tabindex="-1"></a>    </span>
<span id="cb75-12"><a href="#cb75-12" tabindex="-1"></a>    <span class="co"># 给定 x 条件下，从 Beta 分布采样 y</span></span>
<span id="cb75-13"><a href="#cb75-13" tabindex="-1"></a>    samples_y[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, samples_x[i] <span class="sc">+</span> a, n <span class="sc">-</span> samples_x[i] <span class="sc">+</span> b)</span>
<span id="cb75-14"><a href="#cb75-14" tabindex="-1"></a>  }</span>
<span id="cb75-15"><a href="#cb75-15" tabindex="-1"></a>  </span>
<span id="cb75-16"><a href="#cb75-16" tabindex="-1"></a>  <span class="fu">return</span>(samples_y)</span>
<span id="cb75-17"><a href="#cb75-17" tabindex="-1"></a>}</span>
<span id="cb75-18"><a href="#cb75-18" tabindex="-1"></a></span>
<span id="cb75-19"><a href="#cb75-19" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb75-20"><a href="#cb75-20" tabindex="-1"></a>num_iterations <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb75-21"><a href="#cb75-21" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb75-22"><a href="#cb75-22" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb75-23"><a href="#cb75-23" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb75-24"><a href="#cb75-24" tabindex="-1"></a></span>
<span id="cb75-25"><a href="#cb75-25" tabindex="-1"></a><span class="co"># 生成 3 条链</span></span>
<span id="cb75-26"><a href="#cb75-26" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 设置随机种子以保持可重复性</span></span>
<span id="cb75-27"><a href="#cb75-27" tabindex="-1"></a>chain1_y <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(num_iterations, n, a, b, <span class="at">init_x =</span> <span class="dv">5</span>, <span class="at">init_y =</span> <span class="fl">0.5</span>)</span>
<span id="cb75-28"><a href="#cb75-28" tabindex="-1"></a>chain2_y <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(num_iterations, n, a, b, <span class="at">init_x =</span> <span class="dv">6</span>, <span class="at">init_y =</span> <span class="fl">0.6</span>)</span>
<span id="cb75-29"><a href="#cb75-29" tabindex="-1"></a>chain3_y <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(num_iterations, n, a, b, <span class="at">init_x =</span> <span class="dv">4</span>, <span class="at">init_y =</span> <span class="fl">0.4</span>)</span>
<span id="cb75-30"><a href="#cb75-30" tabindex="-1"></a></span>
<span id="cb75-31"><a href="#cb75-31" tabindex="-1"></a><span class="co"># 计算每条链的均值</span></span>
<span id="cb75-32"><a href="#cb75-32" tabindex="-1"></a>chain_means1 <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(chain1_y) <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span>num_iterations)</span>
<span id="cb75-33"><a href="#cb75-33" tabindex="-1"></a>chain_means2 <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(chain2_y) <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span>num_iterations)</span>
<span id="cb75-34"><a href="#cb75-34" tabindex="-1"></a>chain_means3 <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(chain3_y) <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span>num_iterations)</span>
<span id="cb75-35"><a href="#cb75-35" tabindex="-1"></a></span>
<span id="cb75-36"><a href="#cb75-36" tabindex="-1"></a><span class="co"># 绘图</span></span>
<span id="cb75-37"><a href="#cb75-37" tabindex="-1"></a><span class="fu">plot</span>(chain_means1, <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">col =</span> <span class="st">&#39;blue&#39;</span>, <span class="at">ylim =</span> <span class="fu">range</span>(<span class="fu">c</span>(chain_means1, chain_means2, chain_means3)),</span>
<span id="cb75-38"><a href="#cb75-38" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&#39;Number of Sampling Points (n)&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;Mean of Samples&#39;</span>, <span class="at">main =</span> <span class="st">&#39;Chain Means vs. Number of Sampling Points&#39;</span>)</span>
<span id="cb75-39"><a href="#cb75-39" tabindex="-1"></a><span class="fu">lines</span>(chain_means2, <span class="at">col =</span> <span class="st">&#39;orange&#39;</span>)</span>
<span id="cb75-40"><a href="#cb75-40" tabindex="-1"></a><span class="fu">lines</span>(chain_means3, <span class="at">col =</span> <span class="st">&#39;green&#39;</span>)</span>
<span id="cb75-41"><a href="#cb75-41" tabindex="-1"></a></span>
<span id="cb75-42"><a href="#cb75-42" tabindex="-1"></a><span class="co"># 添加最终均值的虚线</span></span>
<span id="cb75-43"><a href="#cb75-43" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(chain1_y), <span class="at">col =</span> <span class="st">&#39;blue&#39;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb75-44"><a href="#cb75-44" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(chain2_y), <span class="at">col =</span> <span class="st">&#39;orange&#39;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb75-45"><a href="#cb75-45" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(chain3_y), <span class="at">col =</span> <span class="st">&#39;green&#39;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb75-46"><a href="#cb75-46" tabindex="-1"></a></span>
<span id="cb75-47"><a href="#cb75-47" tabindex="-1"></a><span class="co"># 添加图例</span></span>
<span id="cb75-48"><a href="#cb75-48" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Chain 1 Mean&quot;</span>, <span class="st">&quot;Chain 2 Mean&quot;</span>, <span class="st">&quot;Chain 3 Mean&quot;</span>, <span class="st">&quot;Chain 1 Final Mean&quot;</span>, </span>
<span id="cb75-49"><a href="#cb75-49" tabindex="-1"></a>                               <span class="st">&quot;Chain 2 Final Mean&quot;</span>, <span class="st">&quot;Chain 3 Final Mean&quot;</span>),</span>
<span id="cb75-50"><a href="#cb75-50" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;green&quot;</span>), </span>
<span id="cb75-51"><a href="#cb75-51" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="co"># Gelman-Rubin 检验函数</span></span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)     <span class="co"># 每条链的均值</span></span>
<span id="cb76-8"><a href="#cb76-8" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)        <span class="co"># 链间方差</span></span>
<span id="cb76-9"><a href="#cb76-9" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co"># 每条链内的方差</span></span>
<span id="cb76-10"><a href="#cb76-10" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)               <span class="co"># 链内方差的平均值</span></span>
<span id="cb76-11"><a href="#cb76-11" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n <span class="sc">+</span> B <span class="sc">/</span> n  <span class="co"># 联合后验分布的估计方差</span></span>
<span id="cb76-12"><a href="#cb76-12" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W             <span class="co"># Gelman-Rubin 统计量</span></span>
<span id="cb76-13"><a href="#cb76-13" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb76-14"><a href="#cb76-14" tabindex="-1"></a>}</span>
<span id="cb76-15"><a href="#cb76-15" tabindex="-1"></a></span>
<span id="cb76-16"><a href="#cb76-16" tabindex="-1"></a><span class="co"># Gibbs 采样函数</span></span>
<span id="cb76-17"><a href="#cb76-17" tabindex="-1"></a>gibbs_sampler <span class="ot">&lt;-</span> <span class="cf">function</span>(num_iterations, n, a, b, init_x, init_y) {</span>
<span id="cb76-18"><a href="#cb76-18" tabindex="-1"></a>  samples_x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_iterations)</span>
<span id="cb76-19"><a href="#cb76-19" tabindex="-1"></a>  samples_y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_iterations)</span>
<span id="cb76-20"><a href="#cb76-20" tabindex="-1"></a>  samples_x[<span class="dv">1</span>] <span class="ot">&lt;-</span> init_x</span>
<span id="cb76-21"><a href="#cb76-21" tabindex="-1"></a>  samples_y[<span class="dv">1</span>] <span class="ot">&lt;-</span> init_y</span>
<span id="cb76-22"><a href="#cb76-22" tabindex="-1"></a>  </span>
<span id="cb76-23"><a href="#cb76-23" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>num_iterations) {</span>
<span id="cb76-24"><a href="#cb76-24" tabindex="-1"></a>    <span class="co"># 给定 y 条件下，从二项分布采样 x</span></span>
<span id="cb76-25"><a href="#cb76-25" tabindex="-1"></a>    samples_x[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, samples_y[i <span class="sc">-</span> <span class="dv">1</span>])</span>
<span id="cb76-26"><a href="#cb76-26" tabindex="-1"></a>    </span>
<span id="cb76-27"><a href="#cb76-27" tabindex="-1"></a>    <span class="co"># 给定 x 条件下，从 Beta 分布采样 y</span></span>
<span id="cb76-28"><a href="#cb76-28" tabindex="-1"></a>    samples_y[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, samples_x[i] <span class="sc">+</span> a, n <span class="sc">-</span> samples_x[i] <span class="sc">+</span> b)</span>
<span id="cb76-29"><a href="#cb76-29" tabindex="-1"></a>  }</span>
<span id="cb76-30"><a href="#cb76-30" tabindex="-1"></a>  </span>
<span id="cb76-31"><a href="#cb76-31" tabindex="-1"></a>  <span class="fu">return</span>(samples_y)</span>
<span id="cb76-32"><a href="#cb76-32" tabindex="-1"></a>}</span>
<span id="cb76-33"><a href="#cb76-33" tabindex="-1"></a></span>
<span id="cb76-34"><a href="#cb76-34" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb76-35"><a href="#cb76-35" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb76-36"><a href="#cb76-36" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb76-37"><a href="#cb76-37" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb76-38"><a href="#cb76-38" tabindex="-1"></a>num_iterations <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb76-39"><a href="#cb76-39" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span>  <span class="co"># 生成的链数</span></span>
<span id="cb76-40"><a href="#cb76-40" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># 烧入期</span></span>
<span id="cb76-41"><a href="#cb76-41" tabindex="-1"></a></span>
<span id="cb76-42"><a href="#cb76-42" tabindex="-1"></a><span class="co"># 设置不同链的初始值</span></span>
<span id="cb76-43"><a href="#cb76-43" tabindex="-1"></a>initial_values <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">5</span>, <span class="fl">0.5</span>), <span class="fu">c</span>(<span class="dv">6</span>, <span class="fl">0.6</span>), <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">0.4</span>), <span class="fu">c</span>(<span class="dv">7</span>, <span class="fl">0.3</span>))</span>
<span id="cb76-44"><a href="#cb76-44" tabindex="-1"></a></span>
<span id="cb76-45"><a href="#cb76-45" tabindex="-1"></a><span class="co"># 生成 k 条链</span></span>
<span id="cb76-46"><a href="#cb76-46" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb76-47"><a href="#cb76-47" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> k, <span class="at">ncol =</span> num_iterations)</span>
<span id="cb76-48"><a href="#cb76-48" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb76-49"><a href="#cb76-49" tabindex="-1"></a>  init_x <span class="ot">&lt;-</span> initial_values[[i]][<span class="dv">1</span>]</span>
<span id="cb76-50"><a href="#cb76-50" tabindex="-1"></a>  init_y <span class="ot">&lt;-</span> initial_values[[i]][<span class="dv">2</span>]</span>
<span id="cb76-51"><a href="#cb76-51" tabindex="-1"></a>  chains[i, ] <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(num_iterations, n, a, b, init_x, init_y)</span>
<span id="cb76-52"><a href="#cb76-52" tabindex="-1"></a>}</span>
<span id="cb76-53"><a href="#cb76-53" tabindex="-1"></a></span>
<span id="cb76-54"><a href="#cb76-54" tabindex="-1"></a><span class="co"># 计算每条链的累积均值</span></span>
<span id="cb76-55"><a href="#cb76-55" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(chains, <span class="dv">1</span>, cumsum))</span>
<span id="cb76-56"><a href="#cb76-56" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi)) {</span>
<span id="cb76-57"><a href="#cb76-57" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb76-58"><a href="#cb76-58" tabindex="-1"></a>}</span>
<span id="cb76-59"><a href="#cb76-59" tabindex="-1"></a></span>
<span id="cb76-60"><a href="#cb76-60" tabindex="-1"></a><span class="co"># Gelman-Rubin 检验</span></span>
<span id="cb76-61"><a href="#cb76-61" tabindex="-1"></a>R_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_iterations)</span>
<span id="cb76-62"><a href="#cb76-62" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>num_iterations) {</span>
<span id="cb76-63"><a href="#cb76-63" tabindex="-1"></a>  R_values[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[, <span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb76-64"><a href="#cb76-64" tabindex="-1"></a>}</span>
<span id="cb76-65"><a href="#cb76-65" tabindex="-1"></a></span>
<span id="cb76-66"><a href="#cb76-66" tabindex="-1"></a><span class="co"># 绘制 R 统计量随采样点数量变化的图像</span></span>
<span id="cb76-67"><a href="#cb76-67" tabindex="-1"></a><span class="fu">plot</span>(R_values[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>num_iterations], <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">col =</span> <span class="st">&#39;purple&#39;</span>,</span>
<span id="cb76-68"><a href="#cb76-68" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&#39;Number of Sampling Points (n)&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;R Statistic&#39;</span>,</span>
<span id="cb76-69"><a href="#cb76-69" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&#39;Gelman-Rubin Diagnostic R vs. Number of Sampling Points&#39;</span>)</span>
<span id="cb76-70"><a href="#cb76-70" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">1.2</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>, <span class="at">lty =</span> <span class="dv">2</span>)  <span class="co"># 添加 R = 1.2 的参考线</span></span>
<span id="cb76-71"><a href="#cb76-71" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;R Statistic&quot;</span>, <span class="st">&quot;R = 1.2&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;purple&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
<p>在利用Gelman-Rubin检验判断练习二的马氏链时，可以看到，当n大于2000时(1000+burn-in)，得到的R就已经小于1.2了，同时观察不同链的均值情况，我们发现练习二得到的马氏链收俩较快且效果较好，这体现了Gibbs抽样的优越性。</p>
</div>
</div>
<div id="练习4-1" class="section level4">
<h4>练习4</h4>
<p>证明MH算法的细致平稳条件</p>
<div id="metropolis-hastings采样算法的流程" class="section level5">
<h5>Metropolis-Hastings采样算法的流程</h5>
<ol style="list-style-type: decimal">
<li>初始化时间 <span class="math inline">\(t = 1\)</span><br />
</li>
<li>设置 <span class="math inline">\(u\)</span> 的值，并初始化初始状态
<span class="math inline">\(\theta^{(t)} = u\)</span><br />
</li>
<li>重复以下的过程：
<ul>
<li>令 <span class="math inline">\(t = t + 1\)</span><br />
</li>
<li>从已知分布 <span class="math inline">\(q\left(\theta \mid
\theta^{(t-1)}\right)\)</span> 中生成一个候选状态 <span class="math inline">\(\theta^{(*)}\)</span><br />
</li>
<li>计算接受的概率：<br />
<span class="math display">\[
\alpha = \min\left(1, \frac{p\left(\theta^{(*)}\right)
q\left(\theta^{(t-1)} \mid
\theta^{(*)}\right)}{p\left(\theta^{(t-1)}\right) q\left(\theta^{(*)}
\mid \theta^{(t-1)}\right)}\right)
\]</span></li>
<li>从均匀分布 <span class="math inline">\(U(0, 1)\)</span>
生成一个随机值 <span class="math inline">\(a\)</span><br />
</li>
<li>如果 <span class="math inline">\(a &lt;
\alpha\)</span>，接受更新生成的值：<span class="math inline">\(\theta^{(t)} = \theta^{(*)}\)</span>；否则：<span class="math inline">\(\theta^{(t)} = \theta^{(t-1)}\)</span><br />
</li>
</ul></li>
<li>直到 <span class="math inline">\(t = T\)</span></li>
</ol>
</div>
<div id="metropolis-hastings采样算法平稳性证明" class="section level5">
<h5>Metropolis-Hastings采样算法平稳性证明</h5>
<p>要证明Metropolis-Hastings采样算法的收敛性，最重要的是要证明构造的马尔可夫过程满足细致平稳条件，即：
<span class="math display">\[
\pi(i) P_{i,j} = \pi(j) P_{j,i}
\]</span></p>
<p>对于上面所述的过程，分布为 <span class="math inline">\(p(\theta)\)</span>，从状态 <span class="math inline">\(i\)</span> 转移到状态 <span class="math inline">\(j\)</span> 的转移概率为： <span class="math display">\[
P_{i,j} = \alpha_{i,j} \cdot Q_{i,j}
\]</span> 其中，<span class="math inline">\(Q_{i,j}\)</span>
为上述已知的分布，<span class="math inline">\(Q_{i,j}\)</span> 为：
<span class="math display">\[
Q_{i,j} = q\left(\theta^{(j)} \mid \theta^{(i)}\right)
\]</span></p>
<p>接下来，我们证明在Metropolis-Hastings采样算法中构造的马尔可夫链满足细致平稳条件。
<span class="math display">\[
p\left(\theta^{(i)}\right) P_{i,j} = p\left(\theta^{(i)}\right) \cdot
\alpha_{i,j} \cdot Q_{i,j}
\]</span> <span class="math display">\[
= p\left(\theta^{(i)}\right) \cdot \min\left(1,
\frac{p\left(\theta^{(j)}\right) \cdot q\left(\theta^{(i)} \mid
\theta^{(j)}\right)}{p\left(\theta^{(i)}\right) \cdot
q\left(\theta^{(j)} \mid \theta^{(i)}\right)}\right) \cdot
q\left(\theta^{(j)} \mid \theta^{(i)}\right)
\]</span> <span class="math display">\[
= \min\left(p\left(\theta^{(i)}\right) \cdot q\left(\theta^{(j)} \mid
\theta^{(i)}\right), p\left(\theta^{(j)}\right) \cdot
q\left(\theta^{(i)} \mid \theta^{(j)}\right)\right)
\]</span> <span class="math display">\[
= p\left(\theta^{(j)}\right) \cdot \min\left(1,
\frac{p\left(\theta^{(i)}\right) \cdot q\left(\theta^{(j)} \mid
\theta^{(i)}\right)}{p\left(\theta^{(j)}\right) \cdot
q\left(\theta^{(i)} \mid \theta^{(j)}\right)}\right) \cdot
q\left(\theta^{(i)} \mid \theta^{(j)}\right)
\]</span> <span class="math display">\[
= p\left(\theta^{(j)}\right) \cdot \alpha_{j,i} \cdot Q_{j,i}
\]</span> <span class="math display">\[
= p\left(\theta^{(j)}\right) P_{j,i}
\]</span></p>
<p>因此，通过以上的方法构造出来的马尔可夫链是满足细致平稳条件的。</p>
</div>
</div>
</div>
<div id="homework-7" class="section level3">
<h3>Homework-7</h3>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span></code></pre></div>
<div id="练习一-2" class="section level4">
<h4>练习一</h4>
<p><strong>题目:</strong>设计算法以计算以下和的第 <span class="math inline">\(k\)</span> 项：</p>
<p><span class="math display">\[
\sum_{k=0}^{\infty} \frac{(-1)^k \|a\|^{2k+2}}{k! \cdot 2^k \cdot
(2k+1)(2k+2)} \frac{\Gamma\left(\frac{d+1}{2}\right) \Gamma\left(k +
\frac{3}{2}\right)}{\Gamma\left(k + \frac{d}{2} + 1\right)}
\]</span></p>
<p>其中 <span class="math inline">\(d \geq 1\)</span> 是一个整数，<span class="math inline">\(a\)</span> 是 <span class="math inline">\(\mathbb{R}^d\)</span> 中的一个向量，<span class="math inline">\(\| \cdot \|\)</span> 表示欧几里得范数。</p>
<ol style="list-style-type: decimal">
<li><strong>(a)</strong> 编写一个函数以计算第 <span class="math inline">\(k\)</span> 项。</li>
<li><strong>(b)</strong> 修改函数，使其计算并返回整个和。</li>
<li><strong>(c)</strong> 当 <span class="math inline">\(a = (1,
2)^T\)</span> 时，计算该和的值。</li>
</ol>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="fu">library</span>(pracma)</span></code></pre></div>
<pre><code>## Warning: package &#39;pracma&#39; was built under R version 4.3.3</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="co"># 定义计算第 k 项的函数</span></span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a>compute_kth_term <span class="ot">&lt;-</span> <span class="cf">function</span>(k, d, a) {</span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a>  <span class="co"># 计算范数 ||a||</span></span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a>  norm_a <span class="ot">&lt;-</span> <span class="fu">norm</span>(a, <span class="at">type =</span> <span class="st">&quot;2&quot;</span>)</span>
<span id="cb80-5"><a href="#cb80-5" tabindex="-1"></a>  </span>
<span id="cb80-6"><a href="#cb80-6" tabindex="-1"></a>  <span class="co"># 计算第 k 项的分子和分母</span></span>
<span id="cb80-7"><a href="#cb80-7" tabindex="-1"></a>  numerator <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k <span class="sc">*</span> norm_a<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>k <span class="sc">+</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">gamma</span>((d <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">gamma</span>(k <span class="sc">+</span> <span class="dv">3</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb80-8"><a href="#cb80-8" tabindex="-1"></a>  denominator <span class="ot">&lt;-</span> <span class="fu">factorial</span>(k) <span class="sc">*</span> <span class="dv">2</span><span class="sc">^</span>k <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">gamma</span>(k <span class="sc">+</span> d <span class="sc">/</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb80-9"><a href="#cb80-9" tabindex="-1"></a>  </span>
<span id="cb80-10"><a href="#cb80-10" tabindex="-1"></a>  <span class="co"># 返回第 k 项的值</span></span>
<span id="cb80-11"><a href="#cb80-11" tabindex="-1"></a>  <span class="fu">return</span>(numerator <span class="sc">/</span> denominator)</span>
<span id="cb80-12"><a href="#cb80-12" tabindex="-1"></a>}</span>
<span id="cb80-13"><a href="#cb80-13" tabindex="-1"></a></span>
<span id="cb80-14"><a href="#cb80-14" tabindex="-1"></a><span class="co"># 计算整个和的函数</span></span>
<span id="cb80-15"><a href="#cb80-15" tabindex="-1"></a>compute_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(d, a, <span class="at">tol =</span> <span class="fl">1e-10</span>) {</span>
<span id="cb80-16"><a href="#cb80-16" tabindex="-1"></a>  sum_value <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb80-17"><a href="#cb80-17" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb80-18"><a href="#cb80-18" tabindex="-1"></a>  </span>
<span id="cb80-19"><a href="#cb80-19" tabindex="-1"></a>  <span class="co"># 迭代求和，直到第 k 项小于容差 tol</span></span>
<span id="cb80-20"><a href="#cb80-20" tabindex="-1"></a>  <span class="cf">repeat</span> {</span>
<span id="cb80-21"><a href="#cb80-21" tabindex="-1"></a>    term <span class="ot">&lt;-</span> <span class="fu">compute_kth_term</span>(k, d, a)</span>
<span id="cb80-22"><a href="#cb80-22" tabindex="-1"></a>    sum_value <span class="ot">&lt;-</span> sum_value <span class="sc">+</span> term</span>
<span id="cb80-23"><a href="#cb80-23" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(term) <span class="sc">&lt;</span> tol) <span class="cf">break</span></span>
<span id="cb80-24"><a href="#cb80-24" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb80-25"><a href="#cb80-25" tabindex="-1"></a>  }</span>
<span id="cb80-26"><a href="#cb80-26" tabindex="-1"></a>  </span>
<span id="cb80-27"><a href="#cb80-27" tabindex="-1"></a>  <span class="fu">return</span>(sum_value)</span>
<span id="cb80-28"><a href="#cb80-28" tabindex="-1"></a>}</span>
<span id="cb80-29"><a href="#cb80-29" tabindex="-1"></a></span>
<span id="cb80-30"><a href="#cb80-30" tabindex="-1"></a><span class="co"># 参数设置</span></span>
<span id="cb80-31"><a href="#cb80-31" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb80-32"><a href="#cb80-32" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb80-33"><a href="#cb80-33" tabindex="-1"></a></span>
<span id="cb80-34"><a href="#cb80-34" tabindex="-1"></a><span class="co"># 计算和的值</span></span>
<span id="cb80-35"><a href="#cb80-35" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">compute_sum</span>(d, a)</span>
<span id="cb80-36"><a href="#cb80-36" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;和的值为:&quot;</span>, result, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 和的值为: 1.532164</code></pre>
<p>本题中我们采用<code>compute_kth_term</code> 函数计算给定 <span class="math inline">\(k\)</span> 值时的第 <span class="math inline">\(k\)</span> 项， <code>compute_sum</code>
函数迭代地计算每一项的和，直到当前项小于给定的容差（默认值为 <span class="math inline">\(10^{-10}\)</span>）为止。</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span></code></pre></div>
</div>
<div id="练习二-1" class="section level4">
<h4>练习二</h4>
<p><strong>题目：</strong> 写一个函数来求解如下关于 <span class="math inline">\(a\)</span> 的方程：</p>
<p><span class="math display">\[
\frac{2\Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi
(k-1)}\Gamma\left(\frac{k-1}{2}\right)} \int_0^{c_k - 1} \left(1 +
\frac{u^2}{k-1}\right)^{-\frac{k}{2}} \,du =
\frac{2\Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi
k}\Gamma\left(\frac{k}{2}\right)} \int_0^{c_k} \left(1 +
\frac{u^2}{k}\right)^{-\frac{k+1}{2}} \,du,
\]</span></p>
<p>其中：</p>
<p><span class="math display">\[
c_k = \sqrt{\frac{a^2 k}{k + 1 - a^2}}.
\]</span></p>
<p>要求对比求解出的 <span class="math inline">\(a\)</span> 值与习题 11.4
中的 <span class="math inline">\(A(k)\)</span> 进行比较。</p>
<p>首先我们给出<strong>11.4</strong>的解答：</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="co"># 加载必要的库</span></span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a><span class="co">#if(!requireNamespace(&quot;stats&quot;, quietly = TRUE)) install.packages(&quot;stats&quot;)</span></span>
<span id="cb83-3"><a href="#cb83-3" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb83-4"><a href="#cb83-4" tabindex="-1"></a></span>
<span id="cb83-5"><a href="#cb83-5" tabindex="-1"></a><span class="co"># 定义概率函数</span></span>
<span id="cb83-6"><a href="#cb83-6" tabindex="-1"></a>Sk_minus_1 <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb83-7"><a href="#cb83-7" tabindex="-1"></a>  threshold <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (k <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb83-8"><a href="#cb83-8" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(threshold, <span class="at">df =</span> k <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb83-9"><a href="#cb83-9" tabindex="-1"></a>}</span>
<span id="cb83-10"><a href="#cb83-10" tabindex="-1"></a></span>
<span id="cb83-11"><a href="#cb83-11" tabindex="-1"></a>Sk <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb83-12"><a href="#cb83-12" tabindex="-1"></a>  threshold <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> k <span class="sc">/</span> (k <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb83-13"><a href="#cb83-13" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(threshold, <span class="at">df =</span> k)</span>
<span id="cb83-14"><a href="#cb83-14" tabindex="-1"></a>}</span>
<span id="cb83-15"><a href="#cb83-15" tabindex="-1"></a></span>
<span id="cb83-16"><a href="#cb83-16" tabindex="-1"></a><span class="co"># 定义找到交点的函数</span></span>
<span id="cb83-17"><a href="#cb83-17" tabindex="-1"></a>find_intersection <span class="ot">&lt;-</span> <span class="cf">function</span>(k, <span class="at">tol =</span> <span class="fl">1e-6</span>) {</span>
<span id="cb83-18"><a href="#cb83-18" tabindex="-1"></a>  <span class="co"># 定义目标函数，求解使 Sk_minus_1 和 Sk 接近的 a 值</span></span>
<span id="cb83-19"><a href="#cb83-19" tabindex="-1"></a>  target_function <span class="ot">&lt;-</span> <span class="cf">function</span>(a) <span class="fu">abs</span>(<span class="fu">Sk_minus_1</span>(a, k) <span class="sc">-</span> <span class="fu">Sk</span>(a, k))</span>
<span id="cb83-20"><a href="#cb83-20" tabindex="-1"></a>  </span>
<span id="cb83-21"><a href="#cb83-21" tabindex="-1"></a>  <span class="co"># 使用 optimize 函数在 (0, sqrt(k)) 区间内找到最小值</span></span>
<span id="cb83-22"><a href="#cb83-22" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">optimize</span>(target_function, <span class="at">interval =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">sqrt</span>(k)), <span class="at">tol =</span> tol)</span>
<span id="cb83-23"><a href="#cb83-23" tabindex="-1"></a>  a_opt <span class="ot">&lt;-</span> result<span class="sc">$</span>minimum</span>
<span id="cb83-24"><a href="#cb83-24" tabindex="-1"></a>  <span class="fu">return</span>(a_opt)</span>
<span id="cb83-25"><a href="#cb83-25" tabindex="-1"></a>}</span>
<span id="cb83-26"><a href="#cb83-26" tabindex="-1"></a></span>
<span id="cb83-27"><a href="#cb83-27" tabindex="-1"></a><span class="co"># 计算并打印 k = 100, 150, 200 对应的交点 A(k)</span></span>
<span id="cb83-28"><a href="#cb83-28" tabindex="-1"></a>k_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">150</span>,<span class="dv">200</span>)</span>
<span id="cb83-29"><a href="#cb83-29" tabindex="-1"></a>A_k <span class="ot">&lt;-</span> <span class="fu">sapply</span>(k_values, find_intersection)</span>
<span id="cb83-30"><a href="#cb83-30" tabindex="-1"></a></span>
<span id="cb83-31"><a href="#cb83-31" tabindex="-1"></a><span class="co"># 显示结果</span></span>
<span id="cb83-32"><a href="#cb83-32" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k_values)) {</span>
<span id="cb83-33"><a href="#cb83-33" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;k =&quot;</span>, k_values[i], <span class="st">&quot;, A(k) =&quot;</span>, A_k[i], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb83-34"><a href="#cb83-34" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## k = 100 , A(k) = 6.942722 
## k = 150 , A(k) = 7.56934 
## k = 200 , A(k) = 8.740321</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span></code></pre></div>
<p><strong>11.5</strong>解答，使用 <code>integrate()</code>
函数进行数值积分，<code>uniroot()</code> 函数求解方程：</p>
<p><strong>一个小问题：</strong>在使用<code>uniroot()</code>
函数求解方程时，在本题，我遇到了如下报错：“位于极点边的f()值之正负号不相反”,然而我通过观察<code>target_function</code>图像时，发现它其实是存在两边正负值相反的极值点的，但由于其与0的距离相差很近(比如可能是1e-12)，超出了<code>uniroot()</code>的判断范围，对于这个问题，我采取的做法是放大<code>target_function</code>,具体的放大倍数可由下面的绘制图像来确定。</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="co"># 定义目标函数</span></span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a>ck <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a>    <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> k <span class="sc">/</span> (k <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb86-5"><a href="#cb86-5" tabindex="-1"></a>  }</span>
<span id="cb86-6"><a href="#cb86-6" tabindex="-1"></a>left_integral <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb86-7"><a href="#cb86-7" tabindex="-1"></a>    ck_val <span class="ot">&lt;-</span> <span class="fu">ck</span>(a, k)</span>
<span id="cb86-8"><a href="#cb86-8" tabindex="-1"></a>      result <span class="ot">&lt;-</span> <span class="fu">integrate</span>(<span class="cf">function</span>(u) (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (k <span class="sc">-</span> <span class="dv">1</span>))<span class="sc">^</span>(<span class="sc">-</span>k <span class="sc">/</span> <span class="dv">2</span>), <span class="dv">0</span>, ck_val <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">$</span>value</span>
<span id="cb86-9"><a href="#cb86-9" tabindex="-1"></a>      coef <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">gamma</span>(k <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">/</span> (<span class="fu">sqrt</span>(pi <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="fu">gamma</span>((k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb86-10"><a href="#cb86-10" tabindex="-1"></a>      <span class="fu">return</span>(coef <span class="sc">*</span> result)</span>
<span id="cb86-11"><a href="#cb86-11" tabindex="-1"></a>    }</span>
<span id="cb86-12"><a href="#cb86-12" tabindex="-1"></a>  </span>
<span id="cb86-13"><a href="#cb86-13" tabindex="-1"></a>right_integral <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb86-14"><a href="#cb86-14" tabindex="-1"></a>    ck_val <span class="ot">&lt;-</span> <span class="fu">ck</span>(a, k)</span>
<span id="cb86-15"><a href="#cb86-15" tabindex="-1"></a>      result <span class="ot">&lt;-</span> <span class="fu">integrate</span>(<span class="cf">function</span>(u) (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> k)<span class="sc">^</span>(<span class="sc">-</span>(k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>), <span class="dv">0</span>, ck_val)<span class="sc">$</span>value</span>
<span id="cb86-16"><a href="#cb86-16" tabindex="-1"></a>      coef <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">gamma</span>((k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">/</span> (<span class="fu">sqrt</span>(pi <span class="sc">*</span> k) <span class="sc">*</span> <span class="fu">gamma</span>(k <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb86-17"><a href="#cb86-17" tabindex="-1"></a>      <span class="fu">return</span>(coef <span class="sc">*</span> result)</span>
<span id="cb86-18"><a href="#cb86-18" tabindex="-1"></a>    }</span>
<span id="cb86-19"><a href="#cb86-19" tabindex="-1"></a>target_function <span class="ot">&lt;-</span> <span class="cf">function</span>(a) {</span>
<span id="cb86-20"><a href="#cb86-20" tabindex="-1"></a>  (<span class="fu">left_integral</span>(a, k) <span class="sc">-</span> <span class="fu">right_integral</span>(a, k))<span class="sc">*</span><span class="fl">1e14</span></span>
<span id="cb86-21"><a href="#cb86-21" tabindex="-1"></a>}</span>
<span id="cb86-22"><a href="#cb86-22" tabindex="-1"></a></span>
<span id="cb86-23"><a href="#cb86-23" tabindex="-1"></a><span class="co"># 绘制目标函数的值在区间的变化情况</span></span>
<span id="cb86-24"><a href="#cb86-24" tabindex="-1"></a>a_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">6.7</span>,<span class="fl">6.9</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb86-25"><a href="#cb86-25" tabindex="-1"></a>target_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(a_values, target_function)</span>
<span id="cb86-26"><a href="#cb86-26" tabindex="-1"></a></span>
<span id="cb86-27"><a href="#cb86-27" tabindex="-1"></a><span class="fu">plot</span>(a_values, target_values, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb86-28"><a href="#cb86-28" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;a&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;target_function(a)&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Plot of target_function(a)&quot;</span>)</span>
<span id="cb86-29"><a href="#cb86-29" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)  <span class="co"># 添加 y = 0 的水平线</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAt1BMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmkLZmkNtmtttmtv+QOgCQOjqQZjqQkLaQtpCQttuQ29uQ2/+2ZgC2Zjq2ZpC2kGa225C227a229u22/+2/7a2/9u2///bkDrbtmbbtpDb27bb29vb2//b////AAD/tmb/25D/27b//7b//9v///8xqcMnAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALAklEQVR4nO2diXrjthWFaU/tys0yUyudNJGbNjXTJU6HzbQqbYnv/1zFwg2UiAMCXCDqnG9GtinwAvyJ5RK8IJOCsipZugCxi4CACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICAPABlidZXL0VxfEru9+bXx799OrPT8aeHJPlgS9Gvbvq2LbznmSK2ddjePLf+fH24NTMLAJQIy6e5v328PXf4udzh0ZaiVyfpW7Yc9gSAMvNbkdq0HAJImD7NPU3OHn6W1CeqJ0WvTtK3bA3c81QnQDrA/ACpbN+2opwVoF+/TZLf/HEvyyRUF8vcrA+rSvHrR9lMn5XBm798TG5fRNtJkrtnfVjy95sPJxaL2pZOdtjKAxQW/qr2VQn+/aXI9ftqz391i2ikznWpmsK8PiS7cQCpE1kCyqoaZR5OZ7MBKK+baZlMVUe55Uu5vzhwqbtPjoAaa/p72QYNQE1ZjNT6YFqF0QbHAPR5K35qQIK6+MxUx9Cq1u3N3SYmdvyt2lEf3v1L8R9ZzM3+mCocqaxR+uueJtYBdPdS5iSs/H7/ti2NVH2QWZY6tfhyUxiFETsZbWyUPqg8hLQuVItE+eNcH/T576ItbJTBXfPFQR5beR6zjkULoJ06IZtqe/b+56INyCxLnVrsvimMwnSzG2MUqzoiVfDGvrH5BNDxB21kU9euKr38XpS+zsMJUNk6Nsag1QA6UxaVuqw1rcJ0hwB/QDfvKz+oOg25PDPN4RibzzSx5O7Pn7ctQFX6tOmhMKCqkbYBbYpOTp0ingBqF2YUQE2BvWuQLtlh21+D6rFkMKDBNahdmCkA+fRBedUPtDpwsw8y68EpIP2ZJx1AZfL8qx8tfVAHULswkwDqGa56Nqtf1XdvT+0+qDOK3XwvXS1loOMXVoCEXWmhA0hY+aA8hrIt9RVRpda7tAszSifdBdR2MvKzflD7KPPSO+l20sUZP6isJGaZdfq6H+8AqvygTZPTiR/U6bGOrcKMMsyfANJu6ndqy0/Ky9BqNrcA6RRy4Lj7MTOan/zm6xd9Ct9+EADkOGBabNl6Fd7v+392R7Gi9KS/q/b8+aSI7dT6yqJVmO61R4TTHZ1TOK3ybvt9fTA3xAQoVZMY2t2bS6LCGJdegljwxepkqpyfM9fqtV909tsQZZ3TkYZPd0ynt28fSge0q+kAHbbGADDGhNl1iYCACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAaQNWdlZ0l9RWqBNSEmxyfLLGz1V3+YXG8Fy0N6PCH9hGbf7WUVXcdc6c47lVoSB90fKqxZDPGFyyrIYAO27p/yq+mkTWAypAlaw8Ea1ByMRoOKL3fZzJozzKKZdUQ19sHXYzXMBzQYftY5DKMz752SOPvTbNqQLvi9YtP6v8M+Y6nd+/EP/ExTMMByQ7m8M3zZQB6Z5eDBY8+KJPBt4/2JgYdxckBATTOmDwAFelGB3H3J8aO4pSAXI/dCZMPICiXYX6AuQEa1Hqc9pkEUL+jONy9GKDhbE73Pdl5ICC3a7FFapA/HNNCx8bQGuR2Nb+AoxgIp7HSYeTRxFzmg+Z3FEfhow0ZjCbpg+Y3NyKgomakfiegPnP+gEaZLYwdUC2fq/kxpnhWDEhezQNVXbSlnq0aEL6dcXxCtWzFgI5PDqu0YKIVAxJ+kMMdMZRoxYDqDoajmF/CRcwREFRMgNRC9MAFj2sGlJcPZggKXlgxoGqyJ+ym8ooBVY5i2E3lFQNiDUIJ2QehhBzFghIuYm41gOpZkP9JiQ3x/5wX0FTmoqlBh+0jL1YDEy5iLiZAMvRFio5iT8IKUEZA5xKmzXR8UAT0agE1NWimfF0VD6CZ83VVTIBScZkK1hjMH4IXEaBUXcYftpYbOwuE4MUDyGE+aIkAqngA1fNB/YAc1mqsGFA5E/T60N8JXXcNcpkPWiQEb2yLWhMN8xccgtcR/SAgRpgBTRRhds2OokOEGR1FoOse5h0izK7cUcQRZtddg1wm7ekoIvU5itMth7owQHObiwkQ74u5JQx85sT6AcmlvXPk66r4AFmq0HWv1ahku3F41Ws1Slkn7edeqxG6nNci/1HMHqI441qNgMXgDrp0P2hSOFKD44N2Ed16npxO4RVA5Qyodc3qn2+v5qBTDG9iGRzAG00JaB46xbTRHdMBmg1PYCd9/JOV1USAZqRTXCCgefFMC2iUfE3NTKe4MEDz47koQEvguSBAy+C5GEBL4bkQQMvhuQhAS+IJ8aS9JqU9bvssiicE0DxLEZatPsVwQPMuRVgcz7QXq8H5Lo8n6hnFCKpP4QfosE3u92nY6w5wvlHg8Qt/uXnO7vcugWYB+cZRfQrfSHsZ9TPpKBYLHt8QPAnI6geFBXFGU32KkBqUWm6MhQVxRoQnoA+yPbsjLAQvKj6+o5h9rUZIEGdMzUtqEj8ooAZFhmcqR9E7iDM6PiEheLZHbvut9omteUl5xUk/qs9diK94Lt8I8YRE2suRzP8pXWfyjZKPp6MoJcanfl/Rw1GMk4+noygla1Df8Xs4ipHyCeqDeuPsPIb5WPn4O4ryDUh9FWi4oxgtnzgcxRiH90r+fZBNwxzFiPGEjGJWDVntEzUfr0563NdGxM0n5FJjnBnFyPlMelcjt0yKVOZi5zMVoDRJHl+/3vd3WKW56Pn4AMJv6lXTsamqPfZhPn4+PoDwm3pVvXn9nQRkdxTj5+PVScM39ep5kON/i9lfAjm+/Pwg9Kbe+iq2d8poxYCc3tSb6eGrf1HUigE5val3vHyXls8wj9/Uq2WNtL8YeQByFb6sdTXqmG6RZCfJ3WMUrxwQju64SkBDYhSvEtBYMYrDynBRgMYUAY1klIDGSUdAMSbzTH59IiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICGgmQfKtLGRubl1O3O3ugjKs5/Xy1XWnZy1zXWnX308naOIDkTX3jGZ7qj1wUIPc5JMOcvJurbuX6mjOsyeAUFaDham0UQHoav30/RP6ut3o8Xdgwp6O2hRVfc4Y1HVSQ3e+drY0CSIfEtDfId0zpSBqPRcKGuRqQrznDmq4z4tPZ2iiA8ttftsb9IhWLbo8kcjZXNTFfc4a1ElCyc7Y2CqAsUS2qrq+6ItdnK9Bc2Zv6mjOslRUn2TlbGwfQjXk62rn7ADLMydoom6w3INOa6qRnB6Ryb6L39NJy7yZmmKs7C19zncKlSXL7yzfP8zYxnU/dG5bxZ96dtGFueLdqL5wq2Ref5u2kdVRwfTrKs+U9zBvmtDHxh6+5TuGkZh/mVVhaE9NQtWxvR9EwV/VB3uba1moHdl5HUV9fPFZOS11xM99LDcNcWoWc+JprW5PR4NqIozVerAIREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERBQ9IDSxPYWgukVOyAZA5b5BRmNo8gBqWfS2J7tOLkiBySVL9rGYgeUJcntP1iDeqVaF5tYv1T0bv9zLWdQ5IBk5Tlsw979GqbIAelg3XTBcT52QIuLgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICA/g8kIeOWYsqCFQAAAABJRU5ErkJggg==" /><!-- --></p>
<p>这里以’k=100’为例，此时我们通过观察图像，发现放大1e14是较好的，同时确定了k值是属于(6.7,6.9),于是在下面的<code>uniroot()</code>
函数中设置适当的区间和<code>target_function</code></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="co"># 加载所需的包</span></span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a></span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a><span class="co"># 定义方程函数</span></span>
<span id="cb87-5"><a href="#cb87-5" tabindex="-1"></a>solve_equation <span class="ot">&lt;-</span> <span class="cf">function</span>(k) {</span>
<span id="cb87-6"><a href="#cb87-6" tabindex="-1"></a>  <span class="co"># 定义 c_k 的函数</span></span>
<span id="cb87-7"><a href="#cb87-7" tabindex="-1"></a>  ck <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb87-8"><a href="#cb87-8" tabindex="-1"></a>    <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> k <span class="sc">/</span> (k <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb87-9"><a href="#cb87-9" tabindex="-1"></a>  }</span>
<span id="cb87-10"><a href="#cb87-10" tabindex="-1"></a>  </span>
<span id="cb87-11"><a href="#cb87-11" tabindex="-1"></a>  <span class="co"># 定义积分函数</span></span>
<span id="cb87-12"><a href="#cb87-12" tabindex="-1"></a>  left_integral <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb87-13"><a href="#cb87-13" tabindex="-1"></a>    ck_val <span class="ot">&lt;-</span> <span class="fu">ck</span>(a, k)</span>
<span id="cb87-14"><a href="#cb87-14" tabindex="-1"></a>      result <span class="ot">&lt;-</span> <span class="fu">integrate</span>(<span class="cf">function</span>(u) (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (k <span class="sc">-</span> <span class="dv">1</span>))<span class="sc">^</span>(<span class="sc">-</span>k <span class="sc">/</span> <span class="dv">2</span>), <span class="dv">0</span>, ck_val <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">$</span>value</span>
<span id="cb87-15"><a href="#cb87-15" tabindex="-1"></a>      coef <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">gamma</span>(k <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">/</span> (<span class="fu">sqrt</span>(pi <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="fu">gamma</span>((k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb87-16"><a href="#cb87-16" tabindex="-1"></a>      <span class="fu">return</span>(coef <span class="sc">*</span> result)</span>
<span id="cb87-17"><a href="#cb87-17" tabindex="-1"></a>    }</span>
<span id="cb87-18"><a href="#cb87-18" tabindex="-1"></a>  </span>
<span id="cb87-19"><a href="#cb87-19" tabindex="-1"></a>  right_integral <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb87-20"><a href="#cb87-20" tabindex="-1"></a>    ck_val <span class="ot">&lt;-</span> <span class="fu">ck</span>(a, k)</span>
<span id="cb87-21"><a href="#cb87-21" tabindex="-1"></a>      result <span class="ot">&lt;-</span> <span class="fu">integrate</span>(<span class="cf">function</span>(u) (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> k)<span class="sc">^</span>(<span class="sc">-</span>(k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>), <span class="dv">0</span>, ck_val)<span class="sc">$</span>value</span>
<span id="cb87-22"><a href="#cb87-22" tabindex="-1"></a>      coef <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">gamma</span>((k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">/</span> (<span class="fu">sqrt</span>(pi <span class="sc">*</span> k) <span class="sc">*</span> <span class="fu">gamma</span>(k <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb87-23"><a href="#cb87-23" tabindex="-1"></a>      <span class="fu">return</span>(coef <span class="sc">*</span> result)</span>
<span id="cb87-24"><a href="#cb87-24" tabindex="-1"></a>    }</span>
<span id="cb87-25"><a href="#cb87-25" tabindex="-1"></a>  </span>
<span id="cb87-26"><a href="#cb87-26" tabindex="-1"></a>  <span class="co"># 定义求解的目标函数</span></span>
<span id="cb87-27"><a href="#cb87-27" tabindex="-1"></a>  target_function <span class="ot">&lt;-</span> <span class="cf">function</span>(a) {</span>
<span id="cb87-28"><a href="#cb87-28" tabindex="-1"></a>    (<span class="fu">left_integral</span>(a, k) <span class="sc">-</span> <span class="fu">right_integral</span>(a, k))<span class="sc">*</span><span class="fl">1e14</span></span>
<span id="cb87-29"><a href="#cb87-29" tabindex="-1"></a>  }</span>
<span id="cb87-30"><a href="#cb87-30" tabindex="-1"></a>  </span>
<span id="cb87-31"><a href="#cb87-31" tabindex="-1"></a>  <span class="co"># 使用 uniroot() 求解方程，扩大求解区间</span></span>
<span id="cb87-32"><a href="#cb87-32" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(target_function, <span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">6.7</span>,<span class="fl">6.9</span>))</span>
<span id="cb87-33"><a href="#cb87-33" tabindex="-1"></a>  <span class="fu">return</span>(solution<span class="sc">$</span>root)</span>
<span id="cb87-34"><a href="#cb87-34" tabindex="-1"></a>}</span>
<span id="cb87-35"><a href="#cb87-35" tabindex="-1"></a></span>
<span id="cb87-36"><a href="#cb87-36" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb87-37"><a href="#cb87-37" tabindex="-1"></a>a_value <span class="ot">&lt;-</span> <span class="fu">solve_equation</span>(k)</span>
<span id="cb87-38"><a href="#cb87-38" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;当 k =&quot;</span>, k, <span class="st">&quot;时，求解出的 a 值为：&quot;</span>, a_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 当 k = 100 时，求解出的 a 值为： 6.796032</code></pre>
<p>采用适当的区间和放大倍数，我们可以得到，当 k = 100 时，求解出的 a
值为： 6.796032 ，当 k = 100 时，求解出的 a 值为： 7.522129 ,当 k = 200
时，求解出的 a 值为： 8.719138 。
对比11.4的结果我们发现，k值越大，11.5的结果和11.4的结果越接近。</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span></code></pre></div>
</div>
<div id="练习三-2" class="section level4">
<h4>练习三</h4>
<p>假设 <span class="math inline">\(T_1, \ldots, T_n\)</span>
是来自均值为 <span class="math inline">\(\lambda\)</span>
的指数分布的独立同分布样本。由于右截尾，大于 <span class="math inline">\(\tau\)</span> 的值未被观察到，因此观测值为： <span class="math display">\[
Y_i = T_i I(T_i \leq \tau) + \tau I(T_i &gt; \tau), \quad i = 1, \ldots,
n.
\]</span> 设 <span class="math inline">\(\tau = 1\)</span>，并给定观测值
<span class="math inline">\(Y_i\)</span> 如下：</p>
<p><span class="math display">\[
0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85
\]</span></p>
<p>使用E-M算法估计 <span class="math inline">\(\lambda\)</span>，并将结果与观测数据的最大似然估计进行比较（注意：<span class="math inline">\(Y_i\)</span> 服从混合分布）。</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="co"># 观测数据</span></span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb90-3"><a href="#cb90-3" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># 截尾点</span></span>
<span id="cb90-4"><a href="#cb90-4" tabindex="-1"></a></span>
<span id="cb90-5"><a href="#cb90-5" tabindex="-1"></a><span class="co"># 初始化</span></span>
<span id="cb90-6"><a href="#cb90-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(Y)</span>
<span id="cb90-7"><a href="#cb90-7" tabindex="-1"></a>lambda_est <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(Y)  <span class="co"># 初始估计值</span></span>
<span id="cb90-8"><a href="#cb90-8" tabindex="-1"></a></span>
<span id="cb90-9"><a href="#cb90-9" tabindex="-1"></a><span class="co"># E-M算法</span></span>
<span id="cb90-10"><a href="#cb90-10" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fl">1e-6</span>  <span class="co"># 收敛条件</span></span>
<span id="cb90-11"><a href="#cb90-11" tabindex="-1"></a>max_iter <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># 最大迭代次数</span></span>
<span id="cb90-12"><a href="#cb90-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb90-13"><a href="#cb90-13" tabindex="-1"></a>  <span class="co"># E步：计算未观测部分的期望</span></span>
<span id="cb90-14"><a href="#cb90-14" tabindex="-1"></a>  expected_T <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Y <span class="sc">&lt;</span> tau, Y, tau <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> lambda_est)</span>
<span id="cb90-15"><a href="#cb90-15" tabindex="-1"></a>  </span>
<span id="cb90-16"><a href="#cb90-16" tabindex="-1"></a>  <span class="co"># M步：更新 lambda 的估计值</span></span>
<span id="cb90-17"><a href="#cb90-17" tabindex="-1"></a>  new_lambda_est <span class="ot">&lt;-</span> n <span class="sc">/</span> <span class="fu">sum</span>(expected_T)</span>
<span id="cb90-18"><a href="#cb90-18" tabindex="-1"></a>  </span>
<span id="cb90-19"><a href="#cb90-19" tabindex="-1"></a>  <span class="co"># 检查收敛条件</span></span>
<span id="cb90-20"><a href="#cb90-20" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">abs</span>(new_lambda_est <span class="sc">-</span> lambda_est) <span class="sc">&lt;</span> epsilon) {</span>
<span id="cb90-21"><a href="#cb90-21" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb90-22"><a href="#cb90-22" tabindex="-1"></a>  }</span>
<span id="cb90-23"><a href="#cb90-23" tabindex="-1"></a>  lambda_est <span class="ot">&lt;-</span> new_lambda_est</span>
<span id="cb90-24"><a href="#cb90-24" tabindex="-1"></a>}</span>
<span id="cb90-25"><a href="#cb90-25" tabindex="-1"></a></span>
<span id="cb90-26"><a href="#cb90-26" tabindex="-1"></a><span class="co"># 输出E-M算法估计结果</span></span>
<span id="cb90-27"><a href="#cb90-27" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;E-M算法估计的lambda:&quot;</span>, lambda_est, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## E-M算法估计的lambda: 1.037038</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="co"># 直接的观测数据MLE估计</span></span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a>lambda_mle <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(Y)</span>
<span id="cb92-3"><a href="#cb92-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;观测数据的MLE估计lambda:&quot;</span>, lambda_mle, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 观测数据的MLE估计lambda: 1.481481</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span></code></pre></div>
<p>可以看到，E-M算法估计的lambda为1.037038，与真实值1较为接近，而直接采用MLE得到的结果是
1.481481 ，与真实值相差较远。</p>
</div>
</div>
<div id="homework-8" class="section level3">
<h3>Homework-8</h3>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span></code></pre></div>
<div id="练习一-3" class="section level4">
<h4>练习一</h4>
<p>使用单纯形算法求解以下问题,最小化 <span class="math inline">\(4x + 2y
+ 9z\)</span>，满足</p>
<p><span class="math display">\[
2x + y + z \leq 2  \\
x - y + 3z \leq 3  \\
x \geq 0, \quad y \geq 0, \quad z \geq 0.
\]</span></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="co"># 加载boot包</span></span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;boot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:pracma&#39;:
## 
##     logit</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="co"># 目标函数系数</span></span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">9</span>)</span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a></span>
<span id="cb99-4"><a href="#cb99-4" tabindex="-1"></a><span class="co"># 约束矩阵（注意负号，因为simplex默认使用 &lt;= 形式的约束）</span></span>
<span id="cb99-5"><a href="#cb99-5" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb99-6"><a href="#cb99-6" tabindex="-1"></a></span>
<span id="cb99-7"><a href="#cb99-7" tabindex="-1"></a><span class="co"># 约束条件的右侧值</span></span>
<span id="cb99-8"><a href="#cb99-8" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb99-9"><a href="#cb99-9" tabindex="-1"></a></span>
<span id="cb99-10"><a href="#cb99-10" tabindex="-1"></a><span class="co"># 求解最小化问题</span></span>
<span id="cb99-11"><a href="#cb99-11" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a =</span> a, <span class="at">A1 =</span> A1, <span class="at">b1 =</span> b1, <span class="at">maxi =</span> <span class="cn">FALSE</span>)</span>
<span id="cb99-12"><a href="#cb99-12" tabindex="-1"></a></span>
<span id="cb99-13"><a href="#cb99-13" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb99-14"><a href="#cb99-14" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>## 
## Linear Programming Results
## 
## Call : simplex(a = a, A1 = A1, b1 = b1, maxi = FALSE)
## 
## Minimization Problem with Objective Function Coefficients
## x1 x2 x3 
##  4  2  9 
## 
## 
## Optimal solution has the following values
## x1 x2 x3 
##  0  0  0 
## The optimal value of the objective  function is 0.</code></pre>
<p>可以看到最小值是0，在x=y=z=0时取到。</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span></code></pre></div>
</div>
<div id="练习二-2" class="section level4">
<h4>练习二</h4>
<p><strong>习题 3</strong><br />
使用 <code>for</code> 循环和 <code>lapply()</code>
来拟合线性模型，数据集为 <code>mtcars</code></p>
<p><strong>习题 4</strong><br />
对 <code>mtcars</code> 数据集的每个 bootstrap 样本，使用
<code>for</code> 循环和 <code>lapply()</code> 拟合模型 <span class="math inline">\(\text{mpg} \sim \text{disp}\)</span>。</p>
<p><strong>习题 5</strong><br />
对于前两题中的每个模型，使用给定函数提取 <span class="math inline">\(R^2\)</span> 值：</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="co"># 习题 3</span></span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a><span class="co"># 定义公式列表</span></span>
<span id="cb102-3"><a href="#cb102-3" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb102-4"><a href="#cb102-4" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb102-5"><a href="#cb102-5" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb102-6"><a href="#cb102-6" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb102-7"><a href="#cb102-7" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb102-8"><a href="#cb102-8" tabindex="-1"></a>)</span>
<span id="cb102-9"><a href="#cb102-9" tabindex="-1"></a></span>
<span id="cb102-10"><a href="#cb102-10" tabindex="-1"></a><span class="co"># 使用for循环拟合线性模型</span></span>
<span id="cb102-11"><a href="#cb102-11" tabindex="-1"></a>models_for <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb102-12"><a href="#cb102-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(formulas)) {</span>
<span id="cb102-13"><a href="#cb102-13" tabindex="-1"></a>  models_for[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(formulas[[i]], <span class="at">data =</span> mtcars)</span>
<span id="cb102-14"><a href="#cb102-14" tabindex="-1"></a>}</span>
<span id="cb102-15"><a href="#cb102-15" tabindex="-1"></a></span>
<span id="cb102-16"><a href="#cb102-16" tabindex="-1"></a><span class="co"># 使用lapply拟合线性模型</span></span>
<span id="cb102-17"><a href="#cb102-17" tabindex="-1"></a>models_lapply <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, <span class="cf">function</span>(f) <span class="fu">lm</span>(f, <span class="at">data =</span> mtcars))</span>
<span id="cb102-18"><a href="#cb102-18" tabindex="-1"></a></span>
<span id="cb102-19"><a href="#cb102-19" tabindex="-1"></a><span class="co"># 习题 4</span></span>
<span id="cb102-20"><a href="#cb102-20" tabindex="-1"></a><span class="co"># 生成bootstrap样本</span></span>
<span id="cb102-21"><a href="#cb102-21" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb102-22"><a href="#cb102-22" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb102-23"><a href="#cb102-23" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb102-24"><a href="#cb102-24" tabindex="-1"></a>})</span>
<span id="cb102-25"><a href="#cb102-25" tabindex="-1"></a></span>
<span id="cb102-26"><a href="#cb102-26" tabindex="-1"></a><span class="co"># 使用for循环拟合模型 mpg ~ disp</span></span>
<span id="cb102-27"><a href="#cb102-27" tabindex="-1"></a>models_boot_for <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb102-28"><a href="#cb102-28" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(bootstraps)) {</span>
<span id="cb102-29"><a href="#cb102-29" tabindex="-1"></a>  models_boot_for[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> bootstraps[[i]])</span>
<span id="cb102-30"><a href="#cb102-30" tabindex="-1"></a>}</span>
<span id="cb102-31"><a href="#cb102-31" tabindex="-1"></a></span>
<span id="cb102-32"><a href="#cb102-32" tabindex="-1"></a><span class="co"># 使用lapply拟合模型 mpg ~ disp</span></span>
<span id="cb102-33"><a href="#cb102-33" tabindex="-1"></a>models_boot_lapply <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps, <span class="cf">function</span>(data) <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> data))</span>
<span id="cb102-34"><a href="#cb102-34" tabindex="-1"></a></span>
<span id="cb102-35"><a href="#cb102-35" tabindex="-1"></a><span class="co"># 习题 5</span></span>
<span id="cb102-36"><a href="#cb102-36" tabindex="-1"></a><span class="co"># 定义提取 R^2 的函数</span></span>
<span id="cb102-37"><a href="#cb102-37" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb102-38"><a href="#cb102-38" tabindex="-1"></a></span>
<span id="cb102-39"><a href="#cb102-39" tabindex="-1"></a><span class="co"># 提取习题 3 中的模型的 R^2</span></span>
<span id="cb102-40"><a href="#cb102-40" tabindex="-1"></a>rsq_for <span class="ot">&lt;-</span> <span class="fu">sapply</span>(models_for, rsq)</span>
<span id="cb102-41"><a href="#cb102-41" tabindex="-1"></a>rsq_lapply <span class="ot">&lt;-</span> <span class="fu">sapply</span>(models_lapply, rsq)</span>
<span id="cb102-42"><a href="#cb102-42" tabindex="-1"></a></span>
<span id="cb102-43"><a href="#cb102-43" tabindex="-1"></a><span class="co"># 提取习题 4 中的 bootstrap 模型的 R^2</span></span>
<span id="cb102-44"><a href="#cb102-44" tabindex="-1"></a>rsq_boot_for <span class="ot">&lt;-</span> <span class="fu">sapply</span>(models_boot_for, rsq)</span>
<span id="cb102-45"><a href="#cb102-45" tabindex="-1"></a>rsq_boot_lapply <span class="ot">&lt;-</span> <span class="fu">sapply</span>(models_boot_lapply, rsq)</span>
<span id="cb102-46"><a href="#cb102-46" tabindex="-1"></a></span>
<span id="cb102-47"><a href="#cb102-47" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb102-48"><a href="#cb102-48" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb102-49"><a href="#cb102-49" tabindex="-1"></a>  <span class="at">rsq_for =</span> rsq_for,</span>
<span id="cb102-50"><a href="#cb102-50" tabindex="-1"></a>  <span class="at">rsq_lapply =</span> rsq_lapply,</span>
<span id="cb102-51"><a href="#cb102-51" tabindex="-1"></a>  <span class="at">rsq_boot_for =</span> rsq_boot_for,</span>
<span id="cb102-52"><a href="#cb102-52" tabindex="-1"></a>  <span class="at">rsq_boot_lapply =</span> rsq_boot_lapply</span>
<span id="cb102-53"><a href="#cb102-53" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## $rsq_for
## [1] 0.7183433 0.8596865 0.7809306 0.8838038
## 
## $rsq_lapply
## [1] 0.7183433 0.8596865 0.7809306 0.8838038
## 
## $rsq_boot_for
##  [1] 0.7266643 0.7502854 0.8019045 0.7121745 0.6683614 0.5597573 0.8168582
##  [8] 0.6973612 0.7694797 0.7820997
## 
## $rsq_boot_lapply
##  [1] 0.7266643 0.7502854 0.8019045 0.7121745 0.6683614 0.5597573 0.8168582
##  [8] 0.6973612 0.7694797 0.7820997</code></pre>
<p>可以看到，采用for循环和<code>lapply()</code>函数得到的模型一样，所求出的<span class="math inline">\(R^2\)</span>相同。</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span></code></pre></div>
</div>
<div id="练习三-3" class="section level4">
<h4>练习三</h4>
<p><strong>习题 3</strong><br />
以下代码模拟了在非正态数据上的t检验表现。使用 <code>sapply()</code>
和匿名函数从每个试验中提取 p 值。</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a>  <span class="dv">100</span>,</span>
<span id="cb105-3"><a href="#cb105-3" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb105-4"><a href="#cb105-4" tabindex="-1"></a>  <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb105-5"><a href="#cb105-5" tabindex="-1"></a>)</span></code></pre></div>
<p>额外挑战：通过直接使用 <code>[[</code> 来去除匿名函数。</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a><span class="co"># 生成100次t检验结果</span></span>
<span id="cb106-2"><a href="#cb106-2" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb106-3"><a href="#cb106-3" tabindex="-1"></a>  <span class="dv">100</span>,</span>
<span id="cb106-4"><a href="#cb106-4" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb106-5"><a href="#cb106-5" tabindex="-1"></a>  <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb106-6"><a href="#cb106-6" tabindex="-1"></a>)</span>
<span id="cb106-7"><a href="#cb106-7" tabindex="-1"></a></span>
<span id="cb106-8"><a href="#cb106-8" tabindex="-1"></a><span class="co"># 使用sapply和匿名函数提取每次检验的p值</span></span>
<span id="cb106-9"><a href="#cb106-9" tabindex="-1"></a>p_values_anonymous <span class="ot">&lt;-</span> <span class="fu">sapply</span>(trials, <span class="cf">function</span>(test) test<span class="sc">$</span>p.value)</span>
<span id="cb106-10"><a href="#cb106-10" tabindex="-1"></a></span>
<span id="cb106-11"><a href="#cb106-11" tabindex="-1"></a><span class="co"># 直接使用[[去除匿名函数，提取每次检验的p值</span></span>
<span id="cb106-12"><a href="#cb106-12" tabindex="-1"></a>p_values_direct <span class="ot">&lt;-</span> <span class="fu">sapply</span>(trials, <span class="st">`</span><span class="at">[[</span><span class="st">`</span>, <span class="st">&quot;p.value&quot;</span>)</span>
<span id="cb106-13"><a href="#cb106-13" tabindex="-1"></a></span>
<span id="cb106-14"><a href="#cb106-14" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb106-15"><a href="#cb106-15" tabindex="-1"></a>p_values_anonymous</span></code></pre></div>
<pre><code>##   [1] 0.522341893 0.269950178 0.989213963 0.935197395 0.177614005 0.402369700
##   [7] 0.352166367 0.727564141 0.699439511 0.835574035 0.547507216 0.368855965
##  [13] 0.226611166 0.588377109 0.649857157 0.831488369 0.402169935 0.356830470
##  [19] 0.439145619 0.421447822 0.458366467 0.715142580 0.552183977 0.607215092
##  [25] 0.896959768 0.884693159 0.567374815 0.012552824 0.546472896 0.333152975
##  [31] 0.630984206 0.750468501 0.490889402 0.339166586 0.890046098 0.423910239
##  [37] 0.214578484 0.215049406 0.003589926 0.212569153 0.489621460 0.301806520
##  [43] 0.189889588 0.012139979 0.002650012 0.425074808 0.253435781 0.658172767
##  [49] 0.120625057 0.119329406 0.855553895 0.588691647 0.138395859 0.598369182
##  [55] 0.058437616 0.746231656 0.624928149 0.956220027 0.994024155 0.536715102
##  [61] 0.962922560 0.673180432 0.906970662 0.208973584 0.446205748 0.336759335
##  [67] 0.537644497 0.230952316 0.664053358 0.527758753 0.017635444 0.816546255
##  [73] 0.668593611 0.564868107 0.933177428 0.001394095 0.918728987 0.522715056
##  [79] 0.087892481 0.974471076 0.609148081 0.296742746 0.780024123 0.189064919
##  [85] 0.207179143 0.481709487 0.753797748 0.926907030 0.876932648 0.614694140
##  [91] 0.203645588 0.692699816 0.763667615 0.883947889 0.236433722 0.227830089
##  [97] 0.661124082 0.875543846 0.615108063 0.914728510</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a>p_values_direct</span></code></pre></div>
<pre><code>##   [1] 0.522341893 0.269950178 0.989213963 0.935197395 0.177614005 0.402369700
##   [7] 0.352166367 0.727564141 0.699439511 0.835574035 0.547507216 0.368855965
##  [13] 0.226611166 0.588377109 0.649857157 0.831488369 0.402169935 0.356830470
##  [19] 0.439145619 0.421447822 0.458366467 0.715142580 0.552183977 0.607215092
##  [25] 0.896959768 0.884693159 0.567374815 0.012552824 0.546472896 0.333152975
##  [31] 0.630984206 0.750468501 0.490889402 0.339166586 0.890046098 0.423910239
##  [37] 0.214578484 0.215049406 0.003589926 0.212569153 0.489621460 0.301806520
##  [43] 0.189889588 0.012139979 0.002650012 0.425074808 0.253435781 0.658172767
##  [49] 0.120625057 0.119329406 0.855553895 0.588691647 0.138395859 0.598369182
##  [55] 0.058437616 0.746231656 0.624928149 0.956220027 0.994024155 0.536715102
##  [61] 0.962922560 0.673180432 0.906970662 0.208973584 0.446205748 0.336759335
##  [67] 0.537644497 0.230952316 0.664053358 0.527758753 0.017635444 0.816546255
##  [73] 0.668593611 0.564868107 0.933177428 0.001394095 0.918728987 0.522715056
##  [79] 0.087892481 0.974471076 0.609148081 0.296742746 0.780024123 0.189064919
##  [85] 0.207179143 0.481709487 0.753797748 0.926907030 0.876932648 0.614694140
##  [91] 0.203645588 0.692699816 0.763667615 0.883947889 0.236433722 0.227830089
##  [97] 0.661124082 0.875543846 0.615108063 0.914728510</code></pre>
<p>可以发现，二者结果相同。</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span></code></pre></div>
<p><strong>习题6</strong> 实现一个 <code>Map()</code> 和
<code>vapply()</code> 的组合，创建一个 <code>lapply()</code>
的变体。</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a><span class="co"># 定义一个自定义的并行迭代函数</span></span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a>my_lapply_variant <span class="ot">&lt;-</span> <span class="cf">function</span>(X, FUN, FUN.VALUE, <span class="at">simplify =</span> <span class="cn">FALSE</span>, ...) {</span>
<span id="cb111-3"><a href="#cb111-3" tabindex="-1"></a>  <span class="co"># 使用 Map() 并行应用函数 FUN 到列表 X 中的每个元素</span></span>
<span id="cb111-4"><a href="#cb111-4" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">Map</span>(<span class="cf">function</span>(x) <span class="fu">vapply</span>(x, FUN, FUN.VALUE, ...), X)</span>
<span id="cb111-5"><a href="#cb111-5" tabindex="-1"></a>  </span>
<span id="cb111-6"><a href="#cb111-6" tabindex="-1"></a>  <span class="co"># 如果 simplify 参数为 TRUE，则将结果简化为数组</span></span>
<span id="cb111-7"><a href="#cb111-7" tabindex="-1"></a>  <span class="cf">if</span> (simplify) {</span>
<span id="cb111-8"><a href="#cb111-8" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">simplify2array</span>(results))</span>
<span id="cb111-9"><a href="#cb111-9" tabindex="-1"></a>  }</span>
<span id="cb111-10"><a href="#cb111-10" tabindex="-1"></a>  </span>
<span id="cb111-11"><a href="#cb111-11" tabindex="-1"></a>  <span class="co"># 否则返回结果列表</span></span>
<span id="cb111-12"><a href="#cb111-12" tabindex="-1"></a>  results</span>
<span id="cb111-13"><a href="#cb111-13" tabindex="-1"></a>}</span>
<span id="cb111-14"><a href="#cb111-14" tabindex="-1"></a><span class="co"># 定义测试列表</span></span>
<span id="cb111-15"><a href="#cb111-15" tabindex="-1"></a>testlist <span class="ot">&lt;-</span> <span class="fu">list</span>(iris, mtcars, cars)</span>
<span id="cb111-16"><a href="#cb111-16" tabindex="-1"></a><span class="co"># 使用 my_lapply_variant 计算每列的均值</span></span>
<span id="cb111-17"><a href="#cb111-17" tabindex="-1"></a><span class="fu">lapply</span>(testlist, <span class="cf">function</span>(x) <span class="fu">vapply</span>(x, mean, <span class="fu">numeric</span>(<span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## Warning in mean.default(X[[i]], ...): argument is not numeric or logical:
## returning NA</code></pre>
<pre><code>## [[1]]
## Sepal.Length  Sepal.Width Petal.Length  Petal.Width      Species 
##     5.843333     3.057333     3.758000     1.199333           NA 
## 
## [[2]]
##        mpg        cyl       disp         hp       drat         wt       qsec 
##  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 
##         vs         am       gear       carb 
##   0.437500   0.406250   3.687500   2.812500 
## 
## [[3]]
## speed  dist 
## 15.40 42.98</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">my_lapply_variant</span>(testlist, mean, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## Warning in mean.default(X[[i]], ...): argument is not numeric or logical:
## returning NA</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## [[1]]
## Sepal.Length  Sepal.Width Petal.Length  Petal.Width      Species 
##     5.843333     3.057333     3.758000     1.199333           NA 
## 
## [[2]]
##        mpg        cyl       disp         hp       drat         wt       qsec 
##  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 
##         vs         am       gear       carb 
##   0.437500   0.406250   3.687500   2.812500 
## 
## [[3]]
## speed  dist 
## 15.40 42.98</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span></code></pre></div>
</div>
<div id="练习四" class="section level4">
<h4>练习四</h4>
<p><strong>习题4</strong></p>
<p>编写一个更快速版本的<code>chisq.test()</code>,根据提示，我选择从定义下手：
卡方检验（Chi-squared
test）的数学定义基于以下公式，通常用于检验观察值与期望值之间的差异。</p>
<p><strong>卡方统计量公式：</strong> 给定一个列联表，其中 <span class="math inline">\(O_{ij}\)</span> 表示观测频数，<span class="math inline">\(E_{ij}\)</span> 表示期望频数。卡方统计量 <span class="math inline">\(\chi^2\)</span> 的计算公式为：</p>
<p><span class="math display">\[
\chi^2 = \sum_{i=1}^{r} \sum_{j=1}^{c} \frac{(O_{ij} -
E_{ij})^2}{E_{ij}}
\]</span></p>
<p>其中： - <span class="math inline">\(r\)</span> 是列联表的行数。 -
<span class="math inline">\(c\)</span> 是列联表的列数。 - <span class="math inline">\(O_{ij}\)</span> 是第 <span class="math inline">\(i\)</span> 行第 <span class="math inline">\(j\)</span> 列的观测频数。 - <span class="math inline">\(E_{ij}\)</span> 是第 <span class="math inline">\(i\)</span> 行第 <span class="math inline">\(j\)</span> 列的期望频数。</p>
<p><strong>期望频数公式：</strong> 期望频数 <span class="math inline">\(E_{ij}\)</span>
通常根据列联表的行总和和列总和计算，公式为：</p>
<p><span class="math display">\[
E_{ij} = \frac{(R_i \times C_j)}{N}
\]</span></p>
<p>其中： - <span class="math inline">\(R_i\)</span> 是第 <span class="math inline">\(i\)</span> 行的总和。 - <span class="math inline">\(C_j\)</span> 是第 <span class="math inline">\(j\)</span> 列的总和。 - <span class="math inline">\(N\)</span>
是总样本量，即所有单元格的观测频数之和。</p>
<p><strong>自由度：</strong> 卡方检验的自由度 <span class="math inline">\(df\)</span> 计算公式为：</p>
<p><span class="math display">\[
df = (r - 1)(c - 1)
\]</span></p>
<p><strong>p 值：</strong> p
值是基于卡方统计量和自由度计算的累积概率，表示观察到的卡方统计量值或更极端结果出现的概率。p
值用于决定是否拒绝原假设。</p>
<p><span class="math display">\[
p\text{-value} = P(\chi^2 \geq \chi^2_{\text{observed}} | H_0)
\]</span></p>
<p>其中： - <span class="math inline">\(\chi^2_{\text{observed}}\)</span>
是计算得到的卡方统计量。 - <span class="math inline">\(H_0\)</span>
是原假设，通常假设观察到的数据与期望数据一致。</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a>fast_chisq_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb119-2"><a href="#cb119-2" tabindex="-1"></a>  <span class="co"># 检查输入是否为数值型向量且无缺失值</span></span>
<span id="cb119-3"><a href="#cb119-3" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(x) <span class="sc">||</span> <span class="sc">!</span><span class="fu">is.numeric</span>(y)) {</span>
<span id="cb119-4"><a href="#cb119-4" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;输入必须是数值型向量&quot;</span>)</span>
<span id="cb119-5"><a href="#cb119-5" tabindex="-1"></a>  }</span>
<span id="cb119-6"><a href="#cb119-6" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">anyNA</span>(x) <span class="sc">||</span> <span class="fu">anyNA</span>(y)) {</span>
<span id="cb119-7"><a href="#cb119-7" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;输入不能包含缺失值&quot;</span>)</span>
<span id="cb119-8"><a href="#cb119-8" tabindex="-1"></a>  }</span>
<span id="cb119-9"><a href="#cb119-9" tabindex="-1"></a>  </span>
<span id="cb119-10"><a href="#cb119-10" tabindex="-1"></a>  <span class="co"># 创建列联表</span></span>
<span id="cb119-11"><a href="#cb119-11" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x, y)</span>
<span id="cb119-12"><a href="#cb119-12" tabindex="-1"></a>  margin1 <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(m)  <span class="co"># 计算行总和</span></span>
<span id="cb119-13"><a href="#cb119-13" tabindex="-1"></a>  margin2 <span class="ot">&lt;-</span> <span class="fu">colSums</span>(m)  <span class="co"># 计算列总和</span></span>
<span id="cb119-14"><a href="#cb119-14" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">sum</span>(m)  <span class="co"># 总和</span></span>
<span id="cb119-15"><a href="#cb119-15" tabindex="-1"></a>  me <span class="ot">&lt;-</span> <span class="fu">tcrossprod</span>(margin1, margin2) <span class="sc">/</span> n  <span class="co"># 计算期望频数</span></span>
<span id="cb119-16"><a href="#cb119-16" tabindex="-1"></a></span>
<span id="cb119-17"><a href="#cb119-17" tabindex="-1"></a>  <span class="co"># 计算卡方统计量</span></span>
<span id="cb119-18"><a href="#cb119-18" tabindex="-1"></a>  x_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((m <span class="sc">-</span> me)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> me)</span>
<span id="cb119-19"><a href="#cb119-19" tabindex="-1"></a></span>
<span id="cb119-20"><a href="#cb119-20" tabindex="-1"></a>  <span class="co"># 计算自由度</span></span>
<span id="cb119-21"><a href="#cb119-21" tabindex="-1"></a>  dof <span class="ot">&lt;-</span> (<span class="fu">length</span>(margin1) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">length</span>(margin2) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb119-22"><a href="#cb119-22" tabindex="-1"></a></span>
<span id="cb119-23"><a href="#cb119-23" tabindex="-1"></a>  <span class="co"># 计算p值</span></span>
<span id="cb119-24"><a href="#cb119-24" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(x_stat, <span class="at">df =</span> dof, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb119-25"><a href="#cb119-25" tabindex="-1"></a></span>
<span id="cb119-26"><a href="#cb119-26" tabindex="-1"></a>  <span class="co"># 返回结果</span></span>
<span id="cb119-27"><a href="#cb119-27" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x_stat =</span> x_stat, <span class="at">df =</span> dof, <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> p))</span>
<span id="cb119-28"><a href="#cb119-28" tabindex="-1"></a>}</span>
<span id="cb119-29"><a href="#cb119-29" tabindex="-1"></a></span>
<span id="cb119-30"><a href="#cb119-30" tabindex="-1"></a><span class="co"># 使用示例</span></span>
<span id="cb119-31"><a href="#cb119-31" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">12</span><span class="sc">:</span><span class="dv">16</span></span>
<span id="cb119-32"><a href="#cb119-32" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">17</span>, <span class="dv">19</span>)</span>
<span id="cb119-33"><a href="#cb119-33" tabindex="-1"></a></span>
<span id="cb119-34"><a href="#cb119-34" tabindex="-1"></a><span class="co"># 使用我们改进后的 fast_chisq_test</span></span>
<span id="cb119-35"><a href="#cb119-35" tabindex="-1"></a>fast_chisq_result <span class="ot">&lt;-</span> <span class="fu">fast_chisq_test</span>(a, b)</span>
<span id="cb119-36"><a href="#cb119-36" tabindex="-1"></a><span class="fu">print</span>(fast_chisq_result)</span></code></pre></div>
<pre><code>## $x_stat
## [1] 0.2880326
## 
## $df
## [1] 4
## 
## $`p-value`
## [1] 0.9905736</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a><span class="co"># 使用原本的 fast_chisq_test</span></span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a>m_test <span class="ot">&lt;-</span> <span class="fu">cbind</span>(a, b)</span>
<span id="cb121-3"><a href="#cb121-3" tabindex="-1"></a>chisq_result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(m_test)</span>
<span id="cb121-4"><a href="#cb121-4" tabindex="-1"></a><span class="fu">print</span>(chisq_result)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  m_test
## X-squared = 0.28803, df = 4, p-value = 0.9906</code></pre>
<p>可以发现我们编写的<code>fast_chisq_test</code>与<code>chisq.test</code>得到的结果相同。</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span></code></pre></div>
<p><strong>习题5</strong></p>
<p>为两个没有缺失值的整数向量输入，制作一个更快速的 <code>table()</code>
版本，并使用它来加速卡方检验。</p>
<p>首先是编写一个更快速的 <code>table()</code> 版本：</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a>fast_table <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb124-2"><a href="#cb124-2" tabindex="-1"></a>  <span class="co"># 确保 x 和 y 是整数向量</span></span>
<span id="cb124-3"><a href="#cb124-3" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.integer</span>(x)) x <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(x)</span>
<span id="cb124-4"><a href="#cb124-4" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.integer</span>(y)) y <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(y)</span>
<span id="cb124-5"><a href="#cb124-5" tabindex="-1"></a>  </span>
<span id="cb124-6"><a href="#cb124-6" tabindex="-1"></a>  <span class="co"># 获取 x 和 y 的所有唯一值</span></span>
<span id="cb124-7"><a href="#cb124-7" tabindex="-1"></a>  levels_x <span class="ot">&lt;-</span> <span class="fu">unique</span>(x)</span>
<span id="cb124-8"><a href="#cb124-8" tabindex="-1"></a>  levels_y <span class="ot">&lt;-</span> <span class="fu">unique</span>(y)</span>
<span id="cb124-9"><a href="#cb124-9" tabindex="-1"></a>  </span>
<span id="cb124-10"><a href="#cb124-10" tabindex="-1"></a>  <span class="co"># 创建一个空的矩阵</span></span>
<span id="cb124-11"><a href="#cb124-11" tabindex="-1"></a>  result_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(levels_x), <span class="at">ncol =</span> <span class="fu">length</span>(levels_y))</span>
<span id="cb124-12"><a href="#cb124-12" tabindex="-1"></a>  </span>
<span id="cb124-13"><a href="#cb124-13" tabindex="-1"></a>  <span class="co"># 为每个值找到索引位置</span></span>
<span id="cb124-14"><a href="#cb124-14" tabindex="-1"></a>  x_index <span class="ot">&lt;-</span> <span class="fu">match</span>(x, levels_x)</span>
<span id="cb124-15"><a href="#cb124-15" tabindex="-1"></a>  y_index <span class="ot">&lt;-</span> <span class="fu">match</span>(y, levels_y)</span>
<span id="cb124-16"><a href="#cb124-16" tabindex="-1"></a>  </span>
<span id="cb124-17"><a href="#cb124-17" tabindex="-1"></a>  <span class="co"># 直接通过索引填充矩阵</span></span>
<span id="cb124-18"><a href="#cb124-18" tabindex="-1"></a>  result_matrix[<span class="fu">cbind</span>(x_index, y_index)] <span class="ot">&lt;-</span> result_matrix[<span class="fu">cbind</span>(x_index, y_index)] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb124-19"><a href="#cb124-19" tabindex="-1"></a>  </span>
<span id="cb124-20"><a href="#cb124-20" tabindex="-1"></a>  <span class="co"># 将矩阵命名</span></span>
<span id="cb124-21"><a href="#cb124-21" tabindex="-1"></a>  <span class="fu">dimnames</span>(result_matrix) <span class="ot">&lt;-</span> <span class="fu">list</span>(levels_x, levels_y)</span>
<span id="cb124-22"><a href="#cb124-22" tabindex="-1"></a>  </span>
<span id="cb124-23"><a href="#cb124-23" tabindex="-1"></a>  <span class="fu">return</span>(result_matrix)</span>
<span id="cb124-24"><a href="#cb124-24" tabindex="-1"></a>}</span>
<span id="cb124-25"><a href="#cb124-25" tabindex="-1"></a></span>
<span id="cb124-26"><a href="#cb124-26" tabindex="-1"></a><span class="co"># 使用示例</span></span>
<span id="cb124-27"><a href="#cb124-27" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">12</span><span class="sc">:</span><span class="dv">16</span></span>
<span id="cb124-28"><a href="#cb124-28" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">17</span>, <span class="dv">19</span>)</span>
<span id="cb124-29"><a href="#cb124-29" tabindex="-1"></a></span>
<span id="cb124-30"><a href="#cb124-30" tabindex="-1"></a><span class="co"># 调用快速版的 table()</span></span>
<span id="cb124-31"><a href="#cb124-31" tabindex="-1"></a>fast_table_result <span class="ot">&lt;-</span> <span class="fu">fast_table</span>(x, y)</span>
<span id="cb124-32"><a href="#cb124-32" tabindex="-1"></a><span class="fu">print</span>(fast_table_result)</span></code></pre></div>
<pre><code>##    11 13 15 17 19
## 12  1  0  0  0  0
## 13  0  1  0  0  0
## 14  0  0  1  0  0
## 15  0  0  0  1  0
## 16  0  0  0  0  1</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a><span class="fu">table</span>(x,y)</span></code></pre></div>
<pre><code>##     y
## x    11 13 15 17 19
##   12  1  0  0  0  0
##   13  0  1  0  0  0
##   14  0  0  1  0  0
##   15  0  0  0  1  0
##   16  0  0  0  0  1</code></pre>
<p>将加速后的table 函数用于自定义卡方检验：</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a><span class="co"># 定义加速版的 table 函数</span></span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a>fast_table <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb128-3"><a href="#cb128-3" tabindex="-1"></a>  <span class="co"># 确保 x 和 y 是整数向量</span></span>
<span id="cb128-4"><a href="#cb128-4" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.integer</span>(x)) x <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(x)</span>
<span id="cb128-5"><a href="#cb128-5" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.integer</span>(y)) y <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(y)</span>
<span id="cb128-6"><a href="#cb128-6" tabindex="-1"></a>  </span>
<span id="cb128-7"><a href="#cb128-7" tabindex="-1"></a>  <span class="co"># 获取 x 和 y 的所有唯一值</span></span>
<span id="cb128-8"><a href="#cb128-8" tabindex="-1"></a>  levels_x <span class="ot">&lt;-</span> <span class="fu">unique</span>(x)</span>
<span id="cb128-9"><a href="#cb128-9" tabindex="-1"></a>  levels_y <span class="ot">&lt;-</span> <span class="fu">unique</span>(y)</span>
<span id="cb128-10"><a href="#cb128-10" tabindex="-1"></a>  </span>
<span id="cb128-11"><a href="#cb128-11" tabindex="-1"></a>  <span class="co"># 初始化空矩阵</span></span>
<span id="cb128-12"><a href="#cb128-12" tabindex="-1"></a>  result_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(levels_x), <span class="at">ncol =</span> <span class="fu">length</span>(levels_y))</span>
<span id="cb128-13"><a href="#cb128-13" tabindex="-1"></a>  </span>
<span id="cb128-14"><a href="#cb128-14" tabindex="-1"></a>  <span class="co"># 创建一个元素的索引映射，方便查找</span></span>
<span id="cb128-15"><a href="#cb128-15" tabindex="-1"></a>  x_index <span class="ot">&lt;-</span> <span class="fu">match</span>(x, levels_x)</span>
<span id="cb128-16"><a href="#cb128-16" tabindex="-1"></a>  y_index <span class="ot">&lt;-</span> <span class="fu">match</span>(y, levels_y)</span>
<span id="cb128-17"><a href="#cb128-17" tabindex="-1"></a>  </span>
<span id="cb128-18"><a href="#cb128-18" tabindex="-1"></a>  <span class="co"># 填充频数矩阵</span></span>
<span id="cb128-19"><a href="#cb128-19" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb128-20"><a href="#cb128-20" tabindex="-1"></a>    result_matrix[x_index[i], y_index[i]] <span class="ot">&lt;-</span> result_matrix[x_index[i], y_index[i]] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb128-21"><a href="#cb128-21" tabindex="-1"></a>  }</span>
<span id="cb128-22"><a href="#cb128-22" tabindex="-1"></a>  </span>
<span id="cb128-23"><a href="#cb128-23" tabindex="-1"></a>  <span class="co"># 将矩阵命名</span></span>
<span id="cb128-24"><a href="#cb128-24" tabindex="-1"></a>  <span class="fu">dimnames</span>(result_matrix) <span class="ot">&lt;-</span> <span class="fu">list</span>(levels_x, levels_y)</span>
<span id="cb128-25"><a href="#cb128-25" tabindex="-1"></a>  </span>
<span id="cb128-26"><a href="#cb128-26" tabindex="-1"></a>  <span class="fu">return</span>(result_matrix)</span>
<span id="cb128-27"><a href="#cb128-27" tabindex="-1"></a>}</span>
<span id="cb128-28"><a href="#cb128-28" tabindex="-1"></a></span>
<span id="cb128-29"><a href="#cb128-29" tabindex="-1"></a><span class="co"># 自定义的卡方检验</span></span>
<span id="cb128-30"><a href="#cb128-30" tabindex="-1"></a>fast_chisq_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb128-31"><a href="#cb128-31" tabindex="-1"></a>  <span class="co"># 使用加速版的 table 创建列联表</span></span>
<span id="cb128-32"><a href="#cb128-32" tabindex="-1"></a>  tbl <span class="ot">&lt;-</span> <span class="fu">fast_table</span>(x, y)</span>
<span id="cb128-33"><a href="#cb128-33" tabindex="-1"></a>  </span>
<span id="cb128-34"><a href="#cb128-34" tabindex="-1"></a>  <span class="co"># 计算观测频数</span></span>
<span id="cb128-35"><a href="#cb128-35" tabindex="-1"></a>  O <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(tbl)</span>
<span id="cb128-36"><a href="#cb128-36" tabindex="-1"></a>  </span>
<span id="cb128-37"><a href="#cb128-37" tabindex="-1"></a>  <span class="co"># 计算期望频数</span></span>
<span id="cb128-38"><a href="#cb128-38" tabindex="-1"></a>  margin1 <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(tbl)</span>
<span id="cb128-39"><a href="#cb128-39" tabindex="-1"></a>  margin2 <span class="ot">&lt;-</span> <span class="fu">colSums</span>(tbl)</span>
<span id="cb128-40"><a href="#cb128-40" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">sum</span>(tbl)</span>
<span id="cb128-41"><a href="#cb128-41" tabindex="-1"></a>  E <span class="ot">&lt;-</span> <span class="fu">outer</span>(margin1, margin2, <span class="at">FUN =</span> <span class="st">&quot;*&quot;</span>) <span class="sc">/</span> n</span>
<span id="cb128-42"><a href="#cb128-42" tabindex="-1"></a>  </span>
<span id="cb128-43"><a href="#cb128-43" tabindex="-1"></a>  <span class="co"># 计算卡方统计量</span></span>
<span id="cb128-44"><a href="#cb128-44" tabindex="-1"></a>  x_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((O <span class="sc">-</span> E)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> E)</span>
<span id="cb128-45"><a href="#cb128-45" tabindex="-1"></a>  </span>
<span id="cb128-46"><a href="#cb128-46" tabindex="-1"></a>  <span class="co"># 计算自由度</span></span>
<span id="cb128-47"><a href="#cb128-47" tabindex="-1"></a>  dof <span class="ot">&lt;-</span> (<span class="fu">nrow</span>(tbl) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">ncol</span>(tbl) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb128-48"><a href="#cb128-48" tabindex="-1"></a>  </span>
<span id="cb128-49"><a href="#cb128-49" tabindex="-1"></a>  <span class="co"># 计算p值</span></span>
<span id="cb128-50"><a href="#cb128-50" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(x_stat, <span class="at">df =</span> dof, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb128-51"><a href="#cb128-51" tabindex="-1"></a>  </span>
<span id="cb128-52"><a href="#cb128-52" tabindex="-1"></a>  <span class="co"># 返回结果</span></span>
<span id="cb128-53"><a href="#cb128-53" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x_stat =</span> x_stat, <span class="at">df =</span> dof, <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> p))</span>
<span id="cb128-54"><a href="#cb128-54" tabindex="-1"></a>}</span>
<span id="cb128-55"><a href="#cb128-55" tabindex="-1"></a></span>
<span id="cb128-56"><a href="#cb128-56" tabindex="-1"></a><span class="co"># 使用示例</span></span>
<span id="cb128-57"><a href="#cb128-57" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">12</span><span class="sc">:</span><span class="dv">16</span></span>
<span id="cb128-58"><a href="#cb128-58" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">17</span>, <span class="dv">19</span>)</span>
<span id="cb128-59"><a href="#cb128-59" tabindex="-1"></a></span>
<span id="cb128-60"><a href="#cb128-60" tabindex="-1"></a><span class="co"># 使用加速版的卡方检验</span></span>
<span id="cb128-61"><a href="#cb128-61" tabindex="-1"></a>fast_chisq_result <span class="ot">&lt;-</span> <span class="fu">fast_chisq_test</span>(a, b)</span>
<span id="cb128-62"><a href="#cb128-62" tabindex="-1"></a><span class="fu">print</span>(fast_chisq_result)</span></code></pre></div>
<pre><code>## $x_stat
## [1] 20
## 
## $df
## [1] 16
## 
## $`p-value`
## [1] 0.2202206</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a>chisq_result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(a, b)</span></code></pre></div>
<pre><code>## Warning in chisq.test(a, b): Chi-squared approximation may be incorrect</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a><span class="fu">print</span>(chisq_result)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  a and b
## X-squared = 20, df = 16, p-value = 0.2202</code></pre>
<p>可以发现二者结果相同。但有一个值得注意的地方，<strong>习题4</strong>部分中，我定义的fast_chisq_test并不包含table函数部分。但在<strong>习题5</strong>中，为了使用<code>table()</code>函数，我们实际将输入的<code>m_test &lt;- cbind(a, b)</code>改为了直接输入<code>(a,b)</code>，这会使得<code>chisq.test</code>函数自动构建列联表
table(x,y)，然后计算卡方检验，从而使用上<code>table()</code>函数。</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span></code></pre></div>
</div>
</div>
<div id="homework-9" class="section level3">
<h3>Homework-9</h3>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>)  <span class="co"># 关闭所有警告(因为使用的R版本较低，调用一些R包时会显示警告)</span></span>
<span id="cb135-2"><a href="#cb135-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span></code></pre></div>
<div id="练习1" class="section level5">
<h5>练习1</h5>
<p><strong>题目：</strong> 考虑一个二元密度函数：</p>
<p><span class="math display">\[
f(x, y) \propto \binom{n}{x} y^{x + a - 1} (1 - y)^{n - x + b - 1},
\quad x = 0, 1, \dots, n, \quad 0 \leq y \leq 1.
\]</span></p>
<p>可以证明，对于固定的 <span class="math inline">\(a\)</span>、<span class="math inline">\(b\)</span>、<span class="math inline">\(n\)</span>，其条件分布分别为二项分布 <span class="math inline">\(\text{Binomial}(n, y)\)</span> 和贝塔分布 <span class="math inline">\(\text{Beta}(x + a, n - x +
b)\)</span>。使用吉布斯采样器生成以目标联合密度 <span class="math inline">\(f(x, y)\)</span> 为目标的链。</p>
<p><strong>注意事项：</strong>这里我编写了一个名为<code>gibbs_sampler</code>的cpp文件放在R包中</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb136-2"><a href="#cb136-2" tabindex="-1"></a><span class="fu">library</span>(SA24204158)</span>
<span id="cb136-3"><a href="#cb136-3" tabindex="-1"></a></span>
<span id="cb136-4"><a href="#cb136-4" tabindex="-1"></a><span class="co"># 设定参数</span></span>
<span id="cb136-5"><a href="#cb136-5" tabindex="-1"></a>n_iter <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 迭代次数</span></span>
<span id="cb136-6"><a href="#cb136-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>          <span class="co"># Binomial 的参数</span></span>
<span id="cb136-7"><a href="#cb136-7" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span>           <span class="co"># Beta 分布的第一个参数</span></span>
<span id="cb136-8"><a href="#cb136-8" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span>           <span class="co"># Beta 分布的第二个参数</span></span>
<span id="cb136-9"><a href="#cb136-9" tabindex="-1"></a></span>
<span id="cb136-10"><a href="#cb136-10" tabindex="-1"></a><span class="co"># 调用 Gibbs 采样器</span></span>
<span id="cb136-11"><a href="#cb136-11" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb136-12"><a href="#cb136-12" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(n_iter, n, a, b)</span>
<span id="cb136-13"><a href="#cb136-13" tabindex="-1"></a></span>
<span id="cb136-14"><a href="#cb136-14" tabindex="-1"></a><span class="co"># 转换为数据框，方便可视化</span></span>
<span id="cb136-15"><a href="#cb136-15" tabindex="-1"></a>samples_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(samples)</span>
<span id="cb136-16"><a href="#cb136-16" tabindex="-1"></a><span class="fu">colnames</span>(samples_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)</span>
<span id="cb136-17"><a href="#cb136-17" tabindex="-1"></a></span>
<span id="cb136-18"><a href="#cb136-18" tabindex="-1"></a><span class="co"># 可视化</span></span>
<span id="cb136-19"><a href="#cb136-19" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb136-20"><a href="#cb136-20" tabindex="-1"></a><span class="fu">ggplot</span>(samples_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb136-21"><a href="#cb136-21" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb136-22"><a href="#cb136-22" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Gibbs 采样结果&quot;</span>, <span class="at">x =</span> <span class="st">&quot;x&quot;</span>, <span class="at">y =</span> <span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="练习2" class="section level4">
<h4>练习2</h4>
<p><strong>题目：</strong>用<code>qqplot</code>对比分别用Rcpp和R代码生成的分布</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb137-2"><a href="#cb137-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb137-3"><a href="#cb137-3" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb137-4"><a href="#cb137-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb137-5"><a href="#cb137-5" tabindex="-1"></a>num_iterations <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb137-6"><a href="#cb137-6" tabindex="-1"></a></span>
<span id="cb137-7"><a href="#cb137-7" tabindex="-1"></a><span class="co"># 使用 Rcpp 的 Gibbs 采样器生成样本</span></span>
<span id="cb137-8"><a href="#cb137-8" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb137-9"><a href="#cb137-9" tabindex="-1"></a>cpp_samples <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(num_iterations, n, a, b)</span>
<span id="cb137-10"><a href="#cb137-10" tabindex="-1"></a></span>
<span id="cb137-11"><a href="#cb137-11" tabindex="-1"></a><span class="co"># 使用 R 实现的 Gibbs 采样器生成样本</span></span>
<span id="cb137-12"><a href="#cb137-12" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb137-13"><a href="#cb137-13" tabindex="-1"></a>samples_x_r <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_iterations)</span>
<span id="cb137-14"><a href="#cb137-14" tabindex="-1"></a>samples_y_r <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_iterations)</span>
<span id="cb137-15"><a href="#cb137-15" tabindex="-1"></a>samples_x_r[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb137-16"><a href="#cb137-16" tabindex="-1"></a>samples_y_r[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb137-17"><a href="#cb137-17" tabindex="-1"></a></span>
<span id="cb137-18"><a href="#cb137-18" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>num_iterations) {</span>
<span id="cb137-19"><a href="#cb137-19" tabindex="-1"></a>  samples_x_r[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, samples_y_r[i <span class="sc">-</span> <span class="dv">1</span>])</span>
<span id="cb137-20"><a href="#cb137-20" tabindex="-1"></a>  samples_y_r[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, samples_x_r[i] <span class="sc">+</span> a, n <span class="sc">-</span> samples_x_r[i] <span class="sc">+</span> b)</span>
<span id="cb137-21"><a href="#cb137-21" tabindex="-1"></a>}</span>
<span id="cb137-22"><a href="#cb137-22" tabindex="-1"></a></span>
<span id="cb137-23"><a href="#cb137-23" tabindex="-1"></a><span class="co"># 使用 qqplot 比较 x 和 y 的分布</span></span>
<span id="cb137-24"><a href="#cb137-24" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb137-25"><a href="#cb137-25" tabindex="-1"></a><span class="fu">qqplot</span>(cpp_samples[, <span class="dv">1</span>], samples_x_r, <span class="at">main =</span> <span class="st">&quot;Rcpp vs R (x)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Rcpp x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R x&quot;</span>)</span>
<span id="cb137-26"><a href="#cb137-26" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb137-27"><a href="#cb137-27" tabindex="-1"></a></span>
<span id="cb137-28"><a href="#cb137-28" tabindex="-1"></a><span class="fu">qqplot</span>(cpp_samples[, <span class="dv">2</span>], samples_y_r, <span class="at">main =</span> <span class="st">&quot;Rcpp vs R (y)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Rcpp y&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R y&quot;</span>)</span>
<span id="cb137-29"><a href="#cb137-29" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>从<code>qqplot</code>的对比图可以发现，使用Rcpp生成的样本与使用R代码生成的样本，分位数对应的非常好，二者服从相同分布。</p>
</div>
<div id="练习3" class="section level4">
<h4>练习3</h4>
<p><strong>题目：</strong>使用 <code>microbenchmark</code> 比较 R 实现和
Rcpp 实现的运行时间。</p>
<p>这里我们基于20次重复运算来对比结果。</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb138-2"><a href="#cb138-2" tabindex="-1"></a></span>
<span id="cb138-3"><a href="#cb138-3" tabindex="-1"></a><span class="co"># 定义 R 实现的 Gibbs 采样器为一个函数</span></span>
<span id="cb138-4"><a href="#cb138-4" tabindex="-1"></a>gibbs_r <span class="ot">&lt;-</span> <span class="cf">function</span>(num_iterations, n, a, b) {</span>
<span id="cb138-5"><a href="#cb138-5" tabindex="-1"></a>  samples_x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_iterations)</span>
<span id="cb138-6"><a href="#cb138-6" tabindex="-1"></a>  samples_y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_iterations)</span>
<span id="cb138-7"><a href="#cb138-7" tabindex="-1"></a>  samples_x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb138-8"><a href="#cb138-8" tabindex="-1"></a>  samples_y[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb138-9"><a href="#cb138-9" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>num_iterations) {</span>
<span id="cb138-10"><a href="#cb138-10" tabindex="-1"></a>    samples_x[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, samples_y[i <span class="sc">-</span> <span class="dv">1</span>])</span>
<span id="cb138-11"><a href="#cb138-11" tabindex="-1"></a>    samples_y[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, samples_x[i] <span class="sc">+</span> a, n <span class="sc">-</span> samples_x[i] <span class="sc">+</span> b)</span>
<span id="cb138-12"><a href="#cb138-12" tabindex="-1"></a>  }</span>
<span id="cb138-13"><a href="#cb138-13" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">x =</span> samples_x, <span class="at">y =</span> samples_y)</span>
<span id="cb138-14"><a href="#cb138-14" tabindex="-1"></a>}</span>
<span id="cb138-15"><a href="#cb138-15" tabindex="-1"></a></span>
<span id="cb138-16"><a href="#cb138-16" tabindex="-1"></a><span class="co"># 比较时间</span></span>
<span id="cb138-17"><a href="#cb138-17" tabindex="-1"></a>benchmark_result <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(</span>
<span id="cb138-18"><a href="#cb138-18" tabindex="-1"></a>  <span class="at">Rcpp =</span> <span class="fu">gibbs_sampler</span>(num_iterations, n, a, b),</span>
<span id="cb138-19"><a href="#cb138-19" tabindex="-1"></a>  <span class="at">R =</span> <span class="fu">gibbs_r</span>(num_iterations, n, a, b),</span>
<span id="cb138-20"><a href="#cb138-20" tabindex="-1"></a>  <span class="at">times =</span> <span class="dv">20</span></span>
<span id="cb138-21"><a href="#cb138-21" tabindex="-1"></a>)</span>
<span id="cb138-22"><a href="#cb138-22" tabindex="-1"></a></span>
<span id="cb138-23"><a href="#cb138-23" tabindex="-1"></a><span class="fu">print</span>(benchmark_result)</span></code></pre></div>
<pre><code>## Unit: milliseconds
##  expr     min      lq      mean   median       uq     max neval
##  Rcpp  1.3230  1.3381  1.361665  1.36530  1.37935  1.3993    20
##     R 18.3955 18.6906 21.291835 21.20105 23.64450 25.3504    20</code></pre>
<p>从<code>microbenchmark</code>的结果可以看出，Rcpp的运算效率比直接使用R高，对比均值发现Rcpp运算效率比R高大概20倍，这体现了C++的优势。</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co">#清除变量</span></span></code></pre></div>
</div>
</div>
<div id="总结-1" class="section level3">
<h3>总结</h3>
<p>这个学期学习了统计计算这门课程，在课上收获很多，最重要的一点是学会了编写自己的R包，在此感谢张洪老师和王齐羽助教的细心解答！</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
